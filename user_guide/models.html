
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Models &#8212; encodermap 3.0.1+10.g67ae638.dirty documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c1026b93" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=ea0ca436"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/models';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Layers" href="layers.html" />
    <link rel="prev" title="Parameter Classes" href="parameter_classes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="3.0.1+10.g67ae638.dirty" />
    <meta name="docbuild:last-update" content="2025-05-15T22:43:00"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_cube_300.png" class="logo__image only-light" alt="encodermap 3.0.1+10.g67ae638.dirty documentation - Home"/>
    <img src="../_static/logo_cube_300.png" class="logo__image only-dark pst-js-only" alt="encodermap 3.0.1+10.g67ae638.dirty documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks/index.html">
    Notebook Gallery
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks/index.html">
    Notebook Gallery
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Trajectory Classes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="singletraj.html">SingleTraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajensemble.html">TrajEnsemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="featurization.html">Featurization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Neural Network Classes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="autoencoder_classes.html">Autoencoder Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_classes.html">Parameter Classes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Models, Layers, Losses</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="loss_functions.html">Loss functions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Models</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-encodermap.models.models">
<span id="models"></span><span id="user-guide-models"></span><h1>Models<a class="headerlink" href="#module-encodermap.models.models" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADCFunctionalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>A subclass of tf.keras.Model, that implements the logic for the
AngleDihedralCartesianEncoderMap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference internal" href="../api/index.html#encodermap.ADCParameters" title="encodermap.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>outputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>encoder</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>decoder</strong> (<em>tf.keras.Model</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.compile" title="Link to this definition">#</a></dt>
<dd><p>Configures the model for training.</p>
<p>Example:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-3),</p>
<blockquote>
<div><p>loss=tf.keras.losses.BinaryCrossentropy(),
metrics=[tf.keras.metrics.BinaryAccuracy(),</p>
<blockquote>
<div><p>tf.keras.metrics.FalseNegatives()])</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – String (name of optimizer) or optimizer instance. See
<cite>tf.keras.optimizers</cite>.</p></li>
<li><p><strong>loss</strong> – Loss function. May be a string (name of loss function), or
a <cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>. A loss
function is any callable with the signature <cite>loss = fn(y_true,
y_pred)</cite>, where <cite>y_true</cite> are the ground truth values, and
<cite>y_pred</cite> are the model’s predictions.
<cite>y_true</cite> should have shape
<cite>(batch_size, d0, .. dN)</cite> (except in the case of
sparse loss functions such as
sparse categorical crossentropy which expects integer arrays of
shape <cite>(batch_size, d0, .. dN-1)</cite>).
<cite>y_pred</cite> should have shape <cite>(batch_size, d0, .. dN)</cite>.
The loss function should return a float tensor.
If a custom <cite>Loss</cite> instance is
used and reduction is set to <cite>None</cite>, return value has shape
<cite>(batch_size, d0, .. dN-1)</cite> i.e. per-sample or per-timestep loss
values; otherwise, it is a scalar. If the model has multiple
outputs, you can use a different loss on each output by passing a
dictionary or a list of losses. The loss value that will be
minimized by the model will then be the sum of all individual
losses, unless <cite>loss_weights</cite> is specified.</p></li>
<li><p><strong>metrics</strong> – List of metrics to be evaluated by the model during
training and testing. Each of this can be a string (name of a
built-in function), function or a <cite>tf.keras.metrics.Metric</cite>
instance. See <cite>tf.keras.metrics</cite>. Typically you will use
<cite>metrics=[‘accuracy’]</cite>.
A function is any callable with the signature <cite>result = fn(y_true,
y_pred)</cite>. To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’:’accuracy’, ‘output_b’:[‘accuracy’, ‘mse’]}</cite>.
You can also pass a list to specify a metric or a list of metrics
for each output, such as
<cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite>
or <cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>. When you pass the
strings ‘accuracy’ or ‘acc’, we convert this to one of
<cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the shapes
of the targets and of the model output. We do a similar
conversion for the strings ‘crossentropy’ and ‘ce’ as well.
The metrics passed here are evaluated without sample weighting; if
you would like sample weighting to apply, you can specify your
metrics via the <cite>weighted_metrics</cite> argument instead.</p></li>
<li><p><strong>loss_weights</strong> – Optional list or dictionary specifying scalar
coefficients (Python floats) to weight the loss contributions of
different model outputs. The loss value that will be minimized by
the model will then be the <em>weighted sum</em> of all individual
losses, weighted by the <cite>loss_weights</cite> coefficients.  If a list,
it is expected to have a 1:1 mapping to the model’s outputs. If a
dict, it is expected to map output names (strings) to scalar
coefficients.</p></li>
<li><p><strong>weighted_metrics</strong> – List of metrics to be evaluated and weighted by
<cite>sample_weight</cite> or <cite>class_weight</cite> during training and testing.</p></li>
<li><p><strong>run_eagerly</strong> – <p>Bool. If <cite>True</cite>, this <cite>Model</cite>’s logic will not be
wrapped in a <cite>tf.function</cite>. Recommended to leave this as <cite>None</cite>
unless your <cite>Model</cite> cannot be run inside a <cite>tf.function</cite>.
<cite>run_eagerly=True</cite> is not supported when using
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>. Defaults to</p>
<blockquote>
<div><p><cite>False</cite>.</p>
</div></blockquote>
</p></li>
<li><p><strong>steps_per_execution</strong> – Int or <cite>‘auto’</cite>. The number of batches to
run during each <cite>tf.function</cite> call. If set to “auto”, keras will
automatically tune <cite>steps_per_execution</cite> during runtime. Running
multiple batches inside a single <cite>tf.function</cite> call can greatly
improve performance on TPUs, when used with distributed strategies
such as <cite>ParameterServerStrategy</cite>, or with small models with a
large Python overhead. At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is
passed, the execution will be truncated to the size of the epoch.
Note that if <cite>steps_per_execution</cite> is set to <cite>N</cite>,
<cite>Callback.on_batch_begin</cite> and <cite>Callback.on_batch_end</cite> methods will
only be called every <cite>N</cite> batches (i.e. before/after each
<cite>tf.function</cite> execution). Defaults to <cite>1</cite>.</p></li>
<li><p><strong>jit_compile</strong> – If <cite>True</cite>, compile the model training step with XLA.
[XLA](<a class="reference external" href="https://www.tensorflow.org/xla">https://www.tensorflow.org/xla</a>) is an optimizing compiler
for machine learning.
<cite>jit_compile</cite> is not enabled for by default.
Note that <cite>jit_compile=True</cite>
may not necessarily work for all models.
For more information on supported operations please refer to the
[XLA documentation](<a class="reference external" href="https://www.tensorflow.org/xla">https://www.tensorflow.org/xla</a>).
Also refer to
[known XLA issues](<a class="reference external" href="https://www.tensorflow.org/xla/known_issues">https://www.tensorflow.org/xla/known_issues</a>)
for more details.</p></li>
<li><p><strong>pss_evaluation_shards</strong> – Integer or ‘auto’. Used for
<cite>tf.distribute.ParameterServerStrategy</cite> training only. This arg
sets the number of shards to split the dataset into, to enable an
exact visitation guarantee for evaluation, meaning the model will
be applied to each dataset element exactly once, even if workers
fail. The dataset must be sharded to ensure separate workers do
not process the same data. The number of shards should be at least
the number of workers for good performance. A value of ‘auto’
turns on exact evaluation and uses a heuristic for the number of
shards based on the number of workers. 0, meaning no
visitation guarantee is provided. NOTE: Custom implementations of
<cite>Model.test_step</cite> will be ignored when doing exact evaluation.
Defaults to <cite>0</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Arguments supported for backwards compatibility only.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.decoder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decoder</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Model</span></em><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.decoder" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.encoder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">encoder</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Model</span></em><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.encoder" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_objects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.from_config" title="Link to this definition">#</a></dt>
<dd><p>Reconstructs this keras serializable from a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – A dictionary.</p></li>
<li><p><strong>custom_objects</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) – Not needed here, but see
<a class="reference external" href="https://keras.io/guides/serialization_and_saving/">https://keras.io/guides/serialization_and_saving/</a> for yourself.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the ADCFunctionalModel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ADCFunctionalModelType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.get_config" title="Link to this definition">#</a></dt>
<dd><p>Serializes this keras serializable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict with the serializable objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.get_loss">
<span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel.get_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.get_loss" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModel.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModel.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModel.train_step" title="Link to this definition">#</a></dt>
<dd><p>Can receive three types of data.</p>
<ul class="simple">
<li><dl class="simple">
<dt>use_backbone_angles = False, use_sidechains = False:</dt><dd><p>Will receive a four-tuple in the order: angles, dihedrals, cartesians,
distances. The angles will be used to construct mean angles.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>use_backbone_angles = True, use_sidechains = False:</dt><dd><p>Will receive the same four-tuple as above, but the angles will be
fed through the autoencoder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>use_backbone_angles = True, use_sidechains = True:</dt><dd><p>Will receive a five-tuple in the order: angles, dihedrals, cartesians,
distances, side dihedrals. The angles, central dihedrals and side
dihedrals will be fed through the autoencoder.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>, </em><em>Tensor</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModelSidechainReconstruction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADCFunctionalModelSidechainReconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModelSidechainReconstruction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#encodermap.models.models.ADCSparseFunctionalModel" title="encodermap.models.models.ADCSparseFunctionalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ADCSparseFunctionalModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference internal" href="../api/index.html#encodermap.ADCParameters" title="encodermap.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>outputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>encoder</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>decoder</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModelSidechainReconstruction.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModelSidechainReconstruction.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.from_config" title="Link to this definition">#</a></dt>
<dd><p>Reconstructs this keras serializable from a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><em>Any</em><em>, </em><em>Any</em><em>]</em>) – A dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the BackMapLayer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BackMapLayerType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModelSidechainReconstruction.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_config" title="Link to this definition">#</a></dt>
<dd><p>Serializes this keras serializable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict with the serializable objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_loss">
<span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCFunctionalModelSidechainReconstruction.get_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_loss" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>, </em><em>...</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.ADCSparseFunctionalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADCSparseFunctionalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCSparseFunctionalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCSparseFunctionalModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#encodermap.models.models.ADCFunctionalModel" title="encodermap.models.models.ADCFunctionalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ADCFunctionalModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference internal" href="../api/index.html#encodermap.ADCParameters" title="encodermap.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>outputs</strong> (<em>Iterable</em><em>[</em><em>tf.Tensor</em><em>]</em>)</p></li>
<li><p><strong>encoder</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>decoder</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>get_dense_model_central_angles</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>get_dense_model_central_dihedrals</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>get_dense_model_cartesians</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>get_dense_model_distances</strong> (<em>tf.keras.Model</em>)</p></li>
<li><p><strong>get_dense_model_side_dihedrals</strong> (<em>Union</em><em>[</em><em>tf.keras.Model</em><em>, </em><em>None</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCSparseFunctionalModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_objects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCSparseFunctionalModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCSparseFunctionalModel.from_config" title="Link to this definition">#</a></dt>
<dd><p>Reconstructs this keras serializable from a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – A dictionary.</p></li>
<li><p><strong>custom_objects</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) – Not needed here, but see
<a class="reference external" href="https://keras.io/guides/serialization_and_saving/">https://keras.io/guides/serialization_and_saving/</a> for yourself.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the ADCSparseFunctionalModel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ADCSparseFunctionalModelType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCSparseFunctionalModel.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCSparseFunctionalModel.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCSparseFunctionalModel.get_config" title="Link to this definition">#</a></dt>
<dd><p>Serializes this keras serializable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict with the serializable objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.ADCSparseFunctionalModel.get_loss">
<span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#ADCSparseFunctionalModel.get_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.ADCSparseFunctionalModel.get_loss" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.MyBiasInitializer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MyBiasInitializer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bias</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#MyBiasInitializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.MyBiasInitializer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Initializer</span></code></p>
<p>Custom Bias initializer to make bias deterministic.</p>
<p>Gets a numpy array called bias. When called, it checks whether the requested
shape matches the shape of the numpy array and then returns the array.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Imports</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">encodermap.models.models</span> <span class="kn">import</span> <span class="n">MyBiasInitializer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a model with the bias initializer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
<span class="gp">... </span>            <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer1&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">MyBiasInitializer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])),</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
<span class="gp">... </span>            <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer2&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">MyBiasInitializer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])),</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer3&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[1.  0.5]</span>
<span class="go">[0.1 0.2 0.3]</span>
<span class="go">[0. 0. 0. 0.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This example fails with an AssertionError, because the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bias shape of the second layer is wrong:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
<span class="gp">... </span>            <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer1&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">MyBiasInitializer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])),</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
<span class="gp">... </span>            <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer2&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">MyBiasInitializer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])),</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;layer3&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">AssertionError</span>: <span class="n">Can&#39;t initialize Bias. Requested shape: (3,) shape of pre-set bias: (2,)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bias</strong> (<em>np.ndarray</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.MyKernelInitializer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MyKernelInitializer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#MyKernelInitializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.MyKernelInitializer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Initializer</span></code></p>
<p>Custom Kernel initializer to make weights deterministic.</p>
<p>Gets a numpy array called weights. When called, it checks whether the requested
shape matches the shape of the numpy array and then returns the array.
For example, see the documentation of <cite>MyBiasInitializer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>np.ndarray</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequentialModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>parameters</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../api/index.html#encodermap.Parameters" title="encodermap.Parameters"><em>Parameters</em></a><em>]</em>)</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>get_dense_model</strong> (<em>Optional</em><em>[</em><em>tf.keras.Model</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.build" title="Link to this definition">#</a></dt>
<dd><p>Builds the model based on input shapes received.</p>
<p>This is to be used for subclassed models, which do not know at
instantiation time what their inputs look like.</p>
<p>This method only exists for users who want to call <cite>model.build()</cite> in a
standalone way (as a substitute for calling the model on real data to
build it). It will never be called by the framework (and thus it will
never throw unexpected errors in an unrelated workflow).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Single tuple, <cite>TensorShape</cite> instance, or list/dict of
shapes, where shapes are tuples, integers, or <cite>TensorShape</cite>
instances.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ol class="arabic simple">
<li><p>In case of invalid user-provided data (not of type tuple,
       list, <cite>TensorShape</cite>, or dict).
    2. If the model requires call arguments that are agnostic
       to the input shapes (positional or keyword arg in call
       signature).
    3. If not all layers were properly built.
    4. If float type inputs are not supported within the layers.</p></li>
</ol>
</p></li>
<li><p><strong>In each</strong><strong> of </strong><strong>these cases</strong><strong>, </strong><strong>the user should build their model by calling</strong> – </p></li>
<li><p><strong>it on real tensor data.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.call" title="Link to this definition">#</a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or dict/list/tuple of input tensors.</p></li>
<li><p><strong>training</strong> – Boolean or boolean scalar tensor, indicating whether to
run the <cite>Network</cite> in training mode or inference mode.</p></li>
<li><p><strong>mask</strong> – A mask or list of masks. A mask can be either a boolean tensor
or None (no mask). For more details, check the guide
[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.compile" title="Link to this definition">#</a></dt>
<dd><p>Configures the model for training.</p>
<p>Example:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-3),</p>
<blockquote>
<div><p>loss=tf.keras.losses.BinaryCrossentropy(),
metrics=[tf.keras.metrics.BinaryAccuracy(),</p>
<blockquote>
<div><p>tf.keras.metrics.FalseNegatives()])</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – String (name of optimizer) or optimizer instance. See
<cite>tf.keras.optimizers</cite>.</p></li>
<li><p><strong>loss</strong> – Loss function. May be a string (name of loss function), or
a <cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>. A loss
function is any callable with the signature <cite>loss = fn(y_true,
y_pred)</cite>, where <cite>y_true</cite> are the ground truth values, and
<cite>y_pred</cite> are the model’s predictions.
<cite>y_true</cite> should have shape
<cite>(batch_size, d0, .. dN)</cite> (except in the case of
sparse loss functions such as
sparse categorical crossentropy which expects integer arrays of
shape <cite>(batch_size, d0, .. dN-1)</cite>).
<cite>y_pred</cite> should have shape <cite>(batch_size, d0, .. dN)</cite>.
The loss function should return a float tensor.
If a custom <cite>Loss</cite> instance is
used and reduction is set to <cite>None</cite>, return value has shape
<cite>(batch_size, d0, .. dN-1)</cite> i.e. per-sample or per-timestep loss
values; otherwise, it is a scalar. If the model has multiple
outputs, you can use a different loss on each output by passing a
dictionary or a list of losses. The loss value that will be
minimized by the model will then be the sum of all individual
losses, unless <cite>loss_weights</cite> is specified.</p></li>
<li><p><strong>metrics</strong> – List of metrics to be evaluated by the model during
training and testing. Each of this can be a string (name of a
built-in function), function or a <cite>tf.keras.metrics.Metric</cite>
instance. See <cite>tf.keras.metrics</cite>. Typically you will use
<cite>metrics=[‘accuracy’]</cite>.
A function is any callable with the signature <cite>result = fn(y_true,
y_pred)</cite>. To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’:’accuracy’, ‘output_b’:[‘accuracy’, ‘mse’]}</cite>.
You can also pass a list to specify a metric or a list of metrics
for each output, such as
<cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite>
or <cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>. When you pass the
strings ‘accuracy’ or ‘acc’, we convert this to one of
<cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the shapes
of the targets and of the model output. We do a similar
conversion for the strings ‘crossentropy’ and ‘ce’ as well.
The metrics passed here are evaluated without sample weighting; if
you would like sample weighting to apply, you can specify your
metrics via the <cite>weighted_metrics</cite> argument instead.</p></li>
<li><p><strong>loss_weights</strong> – Optional list or dictionary specifying scalar
coefficients (Python floats) to weight the loss contributions of
different model outputs. The loss value that will be minimized by
the model will then be the <em>weighted sum</em> of all individual
losses, weighted by the <cite>loss_weights</cite> coefficients.  If a list,
it is expected to have a 1:1 mapping to the model’s outputs. If a
dict, it is expected to map output names (strings) to scalar
coefficients.</p></li>
<li><p><strong>weighted_metrics</strong> – List of metrics to be evaluated and weighted by
<cite>sample_weight</cite> or <cite>class_weight</cite> during training and testing.</p></li>
<li><p><strong>run_eagerly</strong> – <p>Bool. If <cite>True</cite>, this <cite>Model</cite>’s logic will not be
wrapped in a <cite>tf.function</cite>. Recommended to leave this as <cite>None</cite>
unless your <cite>Model</cite> cannot be run inside a <cite>tf.function</cite>.
<cite>run_eagerly=True</cite> is not supported when using
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>. Defaults to</p>
<blockquote>
<div><p><cite>False</cite>.</p>
</div></blockquote>
</p></li>
<li><p><strong>steps_per_execution</strong> – Int or <cite>‘auto’</cite>. The number of batches to
run during each <cite>tf.function</cite> call. If set to “auto”, keras will
automatically tune <cite>steps_per_execution</cite> during runtime. Running
multiple batches inside a single <cite>tf.function</cite> call can greatly
improve performance on TPUs, when used with distributed strategies
such as <cite>ParameterServerStrategy</cite>, or with small models with a
large Python overhead. At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is
passed, the execution will be truncated to the size of the epoch.
Note that if <cite>steps_per_execution</cite> is set to <cite>N</cite>,
<cite>Callback.on_batch_begin</cite> and <cite>Callback.on_batch_end</cite> methods will
only be called every <cite>N</cite> batches (i.e. before/after each
<cite>tf.function</cite> execution). Defaults to <cite>1</cite>.</p></li>
<li><p><strong>jit_compile</strong> – If <cite>True</cite>, compile the model training step with XLA.
[XLA](<a class="reference external" href="https://www.tensorflow.org/xla">https://www.tensorflow.org/xla</a>) is an optimizing compiler
for machine learning.
<cite>jit_compile</cite> is not enabled for by default.
Note that <cite>jit_compile=True</cite>
may not necessarily work for all models.
For more information on supported operations please refer to the
[XLA documentation](<a class="reference external" href="https://www.tensorflow.org/xla">https://www.tensorflow.org/xla</a>).
Also refer to
[known XLA issues](<a class="reference external" href="https://www.tensorflow.org/xla/known_issues">https://www.tensorflow.org/xla/known_issues</a>)
for more details.</p></li>
<li><p><strong>pss_evaluation_shards</strong> – Integer or ‘auto’. Used for
<cite>tf.distribute.ParameterServerStrategy</cite> training only. This arg
sets the number of shards to split the dataset into, to enable an
exact visitation guarantee for evaluation, meaning the model will
be applied to each dataset element exactly once, even if workers
fail. The dataset must be sharded to ensure separate workers do
not process the same data. The number of shards should be at least
the number of workers for good performance. A value of ‘auto’
turns on exact evaluation and uses a heuristic for the number of
shards based on the number of workers. 0, meaning no
visitation guarantee is provided. NOTE: Custom implementations of
<cite>Model.test_step</cite> will be ignored when doing exact evaluation.
Defaults to <cite>0</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Arguments supported for backwards compatibility only.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.decoder">
<span class="sig-name descname"><span class="pre">decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.decoder" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.encoder">
<span class="sig-name descname"><span class="pre">encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.encoder" title="Link to this definition">#</a></dt>
<dd><p>In the sequential model, the encoder is a method (as oppes to a model).</p>
<p>This method handles the input, when the periodicity of the input data
is greater than float(‘inf’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>tf.Tensor</em>) – The input.</p></li>
<li><p><strong>training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether we are training and compute gradients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the encoder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[np.ndarray, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_objects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.from_config" title="Link to this definition">#</a></dt>
<dd><p>Reconstructs this keras serializable from a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – A dictionary.</p></li>
<li><p><strong>custom_objects</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) – Not needed here, but see
<a class="reference external" href="https://keras.io/guides/serialization_and_saving/">https://keras.io/guides/serialization_and_saving/</a> for yourself.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the SequentialModel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>SequentialModelType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.get_config" title="Link to this definition">#</a></dt>
<dd><p>Serializes this keras serializable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict with the serializable objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.models.SequentialModel.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#SequentialModel.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.SequentialModel.train_step" title="Link to this definition">#</a></dt>
<dd><p>Overwrites the normal train_step. What is different?</p>
<p>Not much. Even the provided data is expected to be a tuple of (data, classes) (x, y) in classification tasks.
The data is unpacked, and y is discarded, because the Autoencoder Model is a regression task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – The (x, y) data of this train step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._concatenate_inputs">
<span class="sig-name descname"><span class="pre">_concatenate_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_unit_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_dihedrals_unit_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_dihedrals_unit_circle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_cartesians_pairwise_defined_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_concatenate_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._concatenate_inputs" title="Link to this definition">#</a></dt>
<dd><p>Concatenates input Tensors for the AngleDihedralCartesianEncoderMap.</p>
<p>As the AngleDihedralCartesianEncoderMap model can use either central_dihedrals,
central_angles and central_dihedrals, central_angles and central_dihedrals and
side_dihedrals for its Encoder input, these input sources need to be
concatenated (after they have been projected onto a unit circle). This function
concatenates these inputs in the correct order and ensures a correct shape
of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>encodermap.parameters.ADCParameters</em>) – A parameter instance.</p></li>
<li><p><strong>angles_unit_circle</strong> (<em>Union</em><em>[</em><em>tf.Tensor</em><em>, </em><em>None</em><em>]</em>) – Can be None, in case only
the central_dihedrals are used for training. Otherwise, needs to
be the central angles.</p></li>
<li><p><strong>central_dihedrals_unit_circle</strong> (<em>tf.Tensor</em>) – The unit circle projected
central dihedrals.</p></li>
<li><p><strong>side_dihedrals_unit_circle</strong> (<em>Tensor</em><em> | </em><em>None</em>) – Can be None, if case the side dihedrals are
not used for training. Otherwise, needs to be the side dihedrals.</p></li>
<li><p><strong>input_cartesians_pairwise_defined_shape</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em>) – The pairwise
distances of the input cartesians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>list[int]: A list of the shape[1] of the input tensors. If only</dt><dd><p>dihedrals are used for training, this list has only one entry.
In the other cases, this list can be used to split the output
of the decoder again into the constituents of central_angles,
central_dihedrals, side_dihedrals.</p>
</dd>
</dl>
</li>
<li><p>tf.Tensor: The concatenated inputs.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._concatenate_inputs_reconstruct_sidechains">
<span class="sig-name descname"><span class="pre">_concatenate_inputs_reconstruct_sidechains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_angles_unit_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_dihedrals_unit_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_angles_unit_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_dihedrals_unit_circle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_concatenate_inputs_reconstruct_sidechains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._concatenate_inputs_reconstruct_sidechains" title="Link to this definition">#</a></dt>
<dd><p>Concatenates input Tensors for the AngleDihedralCartesianEncoderMap with
sidechain reconstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>central_angles_unit_circle</strong> (<em>Tensor</em>)</p></li>
<li><p><strong>central_dihedrals_unit_circle</strong> (<em>Tensor</em>)</p></li>
<li><p><strong>side_angles_unit_circle</strong> (<em>Tensor</em>)</p></li>
<li><p><strong>side_dihedrals_unit_circle</strong> (<em>Tensor</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>], <em>Tensor</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._create_inputs_non_periodic_maybe_sparse">
<span class="sig-name descname"><span class="pre">_create_inputs_non_periodic_maybe_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_create_inputs_non_periodic_maybe_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._create_inputs_non_periodic_maybe_sparse" title="Link to this definition">#</a></dt>
<dd><p>Creates an input Tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>) – The shape can be either a
tuple with one int (in case of the central distances) or a tuple
of two ints (in case of central cartesians), in which case, the
2nd is checked to be 3 (for the xyz coordinates).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of this input tensor. Will be preceded with ‘<a href="#id17"><span class="problematic" id="id18">input_</span></a>’.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether a sparse-&gt;dense model should be returned. Defaults to False.</p></li>
<li><p><strong>reshape</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – Whether the input will be in flattened cartesians
and thus reshaped to (shape // reshape, reshape). Thus, only the
reshape 3 is currently used in EncoderMap. If None is specified, the
output will not be reshaped. Defaults to None.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>tf.Tensor: The placeholder tensor for the input. If sparse is True,</dt><dd><p>this Tensor will first be fed through a Dense layer to use sparse
matrix multiplication to make it dense again.</p>
</dd>
</dl>
</li>
<li><p>Union[tf.Tensor, None]: The Dense output of the Tensor, if sparse is True.</p></li>
<li><dl class="simple">
<dt>Union[tf.keras.Model, None]: The model to get from sparse to dense.</dt><dd><p>If sparse is False, None will be returned here.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._create_inputs_periodic_maybe_sparse">
<span class="sig-name descname"><span class="pre">_create_inputs_periodic_maybe_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_create_inputs_periodic_maybe_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._create_inputs_periodic_maybe_sparse" title="Link to this definition">#</a></dt>
<dd><p>Creates an input Tensor and also projects it onto a unit circle (returns
the sin, cos, sin, cos, …) of the values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The shape can be either a
tuple with one int (in case of the central distances) or a tuple
of two ints (in case of central cartesians), in which case, the
2nd is checked to be 3 (for the xyz coordinates).</p></li>
<li><p><strong>p</strong> (<em>encodermap.parameters.ADCParameters</em>) – An instance of ADCParameters, which contains info
about the periodicity of the input space.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of this input tensor. Will be preceded with ‘<a href="#id19"><span class="problematic" id="id20">input_</span></a>’.
The to unit_circle input will be called ‘input_{name}_to_unit_circle’.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether a sparse-&gt;dense model should be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>tf.Tensor: The placeholder tensor for the input. If sparse is True,</dt><dd><p>this Tensor will first be fed through a Dense layer to use sparse
matrix multiplication to make it dense again.</p>
</dd>
</dl>
</li>
<li><p>tf.Tensor: The PeriodicInput of the same tensor.</p></li>
<li><dl class="simple">
<dt>Union[tf.keras.Model, None]: The model to get from sparse to dense.</dt><dd><p>If sparse is False, a None will be returned here.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._get_adc_decoder">
<span class="sig-name descname"><span class="pre">_get_adc_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_angles_placeholder=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer='VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_regularizer=&lt;keras.src.regularizers.L2</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer='RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_placeholder=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_proteins=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_get_adc_decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._get_adc_decoder" title="Link to this definition">#</a></dt>
<dd><p>Special function to run a decoder and unpack the outputs.</p>
<p>This function calls <cite>_get_decoder_model</cite> to get a standard decoder and then
splits the output according to the provided <cite>splits</cite> and the <cite>p</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>encodermap.parameters.ADCParameters</em>) – The parameters.</p></li>
<li><p><strong>splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – A list of ints giving the splits of the decoder
outputs. It is expected that the splits follow the logic of
angles-dihedrals-sidedihedrals. If only dihedrals are used for
training, <cite>splits</cite> is expected to be a list of len 1.</p></li>
<li><p><strong>input_angles_placeholder</strong> (<em>Optional</em><em>[</em><em>tf.Tensor</em><em>]</em>) – When only using dihedrals
for training, this placeholder should be provided to create a
set of mean angles. Can also be None, in case len(splits) &gt;= 2.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>kernel_initializer</em>) – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>n_proteins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>, <em>Tensor</em>, None | <em>Tensor</em>, None | <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_regularizer</strong> (<em>tf.keras.regularizers.Regularizer</em>) – The regularizer
for the kernel (i.e. the layer weights). Standard in EncoderMap is
to use the l2 regularizer with a regularization constant of 0.001.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>bias_initializer</em>) – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>)</p></li>
<li><p><strong>input_angles_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>n_proteins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>, <em>Tensor</em>, None | <em>Tensor</em>, None | <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to print a summary. If p.tensorboard is True
a file will be generated. at the main_path.</p></li>
<li><p><strong>n_proteins</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – If not None, number of proteins that
constitute the multimer group that is trained.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>)</p></li>
<li><p><strong>input_angles_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>tf.keras.models.Model: The decoder model.</p></li>
<li><p>tf.Tensor: The angles (either mean, or learned angles).</p></li>
<li><p>tf.Tensor: The dihedrals.</p></li>
<li><dl class="simple">
<dt>Union[None, tf.Tensor]: The sidechain dihedrals. If p.use_sidechains</dt><dd><p>is false, None will be returned.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Union[None, tf.Tensor]: The homogeneous transformation matrices</dt><dd><p>for multimer training. If p.multimer_training is None, None
will be returned.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._get_decoder_model">
<span class="sig-name descname"><span class="pre">_get_decoder_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer='VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_regularizer=&lt;keras.src.regularizers.L2</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer='RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_placeholder=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_get_decoder_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._get_decoder_model" title="Link to this definition">#</a></dt>
<dd><p>Create a decoder to the requested specs.</p>
<p>Contrary to the <cite>_get_encoder_model</cite> function, this function doesn’t require
an input placeholder. The input placeholder is created in the function body.
Thus, a combined autoencoder model can be built by stacking the encoder and
decoder like so: <cite>output = decoder(encoder(input))</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>encodermap.parameters.ADCParameters</em>) – The parameters.</p></li>
<li><p><strong>out_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The output shape of the decoder. Make sure to match it
with the input shape of the encoder.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>kernel_initializer</em>) – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>, <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_regularizer</strong> (<em>tf.keras.regularizers.Regularizer</em>) – The regularizer
for the kernel (i.e. the layer weights). Standard in EncoderMap is
to use the l2 regularizer with a regularization constant of 0.001.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>bias_initializer</em>) – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>out_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>, <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to print a summary. If p.tensorboard is True
a file will be generated. at the main_path.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>out_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>input_placeholder</strong> (<em>Tensor</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>tf.keras.models.Model: The decoder model.</p></li>
<li><p>tf.Tensor: The output tensor with shape <cite>out_shape</cite>.</p></li>
<li><p>tf.Tensor: The input placeholder tensor with shape <cite>p.n_neurons</cite>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._get_deterministic_random_normal">
<span class="sig-name descname"><span class="pre">_get_deterministic_random_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_get_deterministic_random_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._get_deterministic_random_normal" title="Link to this definition">#</a></dt>
<dd><p>Returns a deterministic random_normal_initializer wit tensorflow1.</p>
<blockquote>
<div><p>For the tf2 implementation, look into <cite>MyKernelInitializer</cite>.
Moving from tf1 to tf2, the seeding method has changed, so that the same</p>
</div></blockquote>
<p>seed can’t be used to get the same random data in tf1 and tf2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>stddev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>RandomNormal</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._get_deterministic_variance_scaling">
<span class="sig-name descname"><span class="pre">_get_deterministic_variance_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_get_deterministic_variance_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._get_deterministic_variance_scaling" title="Link to this definition">#</a></dt>
<dd><p>Returns a deterministic variance_scaling_initializer wit tensorflow1.</p>
<p>For the tf2 implementation, look into <cite>MyBiasInitializer</cite>.
Moving from tf1 to tf2, the seeding method has changed, so that the same
seed can’t be used to get the same random data in tf1 and tf2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>VarianceScaling</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._get_encoder_model">
<span class="sig-name descname"><span class="pre">_get_encoder_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer='VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_regularizer=&lt;keras.src.regularizers.L2</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer='RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_get_encoder_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._get_encoder_model" title="Link to this definition">#</a></dt>
<dd><p>Create an encoder model and feed the inp through it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<em>tf.Tensor</em>) – The input tensor of the encoder.</p></li>
<li><p><strong>p</strong> (<em>encodermap.parameters.ADCParameters</em>) – The parameters.</p></li>
<li><p><strong>input_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>tf.Tensor</em><em>]</em>) – This list contains the input placeholders
for the encoder. Make sure that these input tensors point to the
<cite>inp</cite> tensor in some way.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>kernel_initializer</em>) – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_regularizer</strong> (<em>tf.keras.regularizers.Regularizer</em>) – The regularizer
for the kernel (i.e. the layer weights). Standard in EncoderMap is
to use the l2 regularizer with a regularization constant of 0.001.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>bias_initializer</em>) – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>inp</strong> (<em>Tensor</em>)</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.Parameters" title="encodermap.parameters.parameters.Parameters"><em>Parameters</em></a><em> | </em><a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.Parameters" title="encodermap.parameters.parameters.Parameters"><em>Parameters</em></a>)</p></li>
<li><p><strong>input_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<em>Model</em>, <em>Tensor</em>]</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to print a summary. If p.tensorboard is True
a file will be generated. at the main_path.</p></li>
<li><p><strong>inp</strong> (<em>Tensor</em>)</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.Parameters" title="encodermap.parameters.parameters.Parameters"><em>Parameters</em></a><em> | </em><a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.Parameters" title="encodermap.parameters.parameters.Parameters"><em>Parameters</em></a>)</p></li>
<li><p><strong>input_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>)</p></li>
<li><p><strong>kernel_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'VarianceScaling'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
<li><p><strong>kernel_regularizer</strong> (<em>Regularizer</em>)</p></li>
<li><p><strong>bias_initializer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'ones'</em><em>, </em><em>'RandomNormal'</em><em>, </em><em>'deterministic'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>tf.keras.models.Model: The encoder model.</p></li>
<li><p>tf.Tensor: The output of the model.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._unpack_and_assert_input_shapes">
<span class="sig-name descname"><span class="pre">_unpack_and_assert_input_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sidechain_only_sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_unpack_and_assert_input_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._unpack_and_assert_input_shapes" title="Link to this definition">#</a></dt>
<dd><p>This function unpacks and asserts the input_shapes for the regular protein case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shapes</strong> (<em>Union</em><em>[</em><em>tf.data.Dataset</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>) – The input shapes, that will be used in the construction of the model.</p></li>
<li><p><strong>parameters</strong> (<em>Optional</em><em>[</em><em>encodermap.parameters.ADCParameters</em><em>]</em>) – An instance of
<cite>encodermap.parameters.ADCParameters</cite>,
which holds further parameters in network construction. If None
is provided, a new instance with default parameters will be
created. Defaults to None.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether sparse inputs are expected. Defaults to False.</p></li>
<li><p><strong>input_sidechain_only_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether only the sidechain dihedrals
are sparse. In that case, the input shape of the cartesians is
different, because the cartesians are flattened to a rank 2 tensor
before running them through a dense layer and then stacking them again
to shape (n_frames, n_atoms, 3).</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>input_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>int: The input shape for the training angles.</p></li>
<li><p>int: The input shape for the training dihedrals.</p></li>
<li><p>int: The input shape for the cartesians.</p></li>
<li><p>int: The input shape for the distances.</p></li>
<li><dl class="simple">
<dt>Union[int, None]: The input shape for the training sidechain dihedrals.</dt><dd><p>Can be None, if they are not used for training.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._unpack_and_assert_input_shapes_multimers">
<span class="sig-name descname"><span class="pre">_unpack_and_assert_input_shapes_multimers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_unpack_and_assert_input_shapes_multimers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._unpack_and_assert_input_shapes_multimers" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shapes</strong> (<em>DatasetV2</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models._unpack_and_assert_input_shapes_w_sidechains">
<span class="sig-name descname"><span class="pre">_unpack_and_assert_input_shapes_w_sidechains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sidechain_only_sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#_unpack_and_assert_input_shapes_w_sidechains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models._unpack_and_assert_input_shapes_w_sidechains" title="Link to this definition">#</a></dt>
<dd><p>This function unpacks and asserts the input_shapes for the regular protein case.</p>
<p>In contrast to <cite>_unpack_data_and_assert_input_shapes</cite>, a full sidechain
reconstruction will be executed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shapes</strong> (<em>Union</em><em>[</em><em>tf.data.Dataset</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>) – The input shapes, that will be used in the construction of the model.</p></li>
<li><p><strong>parameters</strong> (<em>Optional</em><em>[</em><em>encodermap.parametersADCParameters</em><em>]</em>) – An instance
of <cite>encodermap.parameters.ADCParameters</cite>,
which holds further parameters in network construction. If None
is provided, a new instance with default parameters will be
created. Defaults to None.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether sparse inputs are expected. Defaults to False.</p></li>
<li><p><strong>input_sidechain_only_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether only the sidechain dihedrals
are sparse. In that case, the input shape of the cartesians is
different, because the cartesians are flattened to a rank 2 tensor
before running them through a dense layer and then stacking them again
to shape (n_frames, n_atoms, 3).</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><em>ADCParameters</em></a>)</p></li>
<li><p><strong>input_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>int: The input shape for the training angles.</p></li>
<li><p>int: The input shape for the training dihedrals.</p></li>
<li><p>int: The input shape for the cartesians.</p></li>
<li><p>int: The input shape for the distances.</p></li>
<li><dl class="simple">
<dt>Union[int, None]: The input shape for the training sidechain dihedrals.</dt><dd><p>Can be None, if they are not used for training.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models.gen_functional_model">
<span class="sig-name descname"><span class="pre">gen_functional_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DatasetV2</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><span class="pre">ADCParameters</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sidechain_only_sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'VarianceScaling'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'RandomNormal'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_experimental_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ADCFunctionalModelTesting</span></span></span><a class="reference internal" href="../_modules/encodermap/models/models.html#gen_functional_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.gen_functional_model" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gen_functional_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DatasetV2</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><span class="pre">ADCParameters</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sidechain_only_sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'VarianceScaling'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'RandomNormal'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_experimental_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#encodermap.models.models.ADCFunctionalModel" title="encodermap.models.models.ADCFunctionalModel"><span class="pre">ADCFunctionalModel</span></a></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gen_functional_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DatasetV2</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parameter_classes.html#encodermap.parameters.parameters.ADCParameters" title="encodermap.parameters.parameters.ADCParameters"><span class="pre">ADCParameters</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sidechain_only_sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'VarianceScaling'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'VarianceScaling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'ones'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'RandomNormal'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'deterministic'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomNormal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_summary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_experimental_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#encodermap.models.models.ADCSparseFunctionalModel" title="encodermap.models.models.ADCSparseFunctionalModel"><span class="pre">ADCSparseFunctionalModel</span></a></span></span></dt>
<dd><p>New implementation of the functional model API for AngleCartesianDihedralEncoderMap</p>
<p>The functional API is much more flexible than the sequential API, in that
models with multiple inputs and outputs can be defined. Custom layers and
submodels can be intermixed. In EncoderMap’s case, the functional API is used to
build the AngleDihedralCartesianAutoencoder, which takes input data in form
of a tf.data.Dataset with:</p>
<blockquote>
<div><ul class="simple">
<li><p>backbone_angles (angles between C, CA, N - atoms in the backbone).</p></li>
<li><dl class="simple">
<dt>backbone_torsions (dihedral angles in the backbone,</dt><dd><p>commonly known as omega, phi, psi).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cartesian_coordinates (coordinates of the C, CA, N backbone</dt><dd><p>atoms. This data has ndim 3, the other have ndim 2).</p>
</dd>
</dl>
</li>
<li><p>backbone_distances (distances between the C, CA, N backbone atoms).</p></li>
<li><dl class="simple">
<dt>sidechain_torsions (dihedral angles in the sidechain,</dt><dd><p>commonly known as chi1, chi2, chi3, chi4, chi5).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Packing and unpacking that data in the correct order is important.
Make sure to double-check whether you are using angles or dihedrals.
A simple print of the shape can be enough.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shapes</strong> (<em>Union</em><em>[</em><em>tf.data.Dataset</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>) – The input shapes, that will be used in the construction of the model.</p></li>
<li><p><strong>parameters</strong> (<em>Optional</em><em>[</em><em>encodermap.parameters.ADCParameters</em><em>]</em>) – An instance
of <cite>encodermap.parameters.ADCParameters</cite>,
which holds further parameters in network construction. If None
is provided, a new instance with default parameters will be
created. Defaults to None.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether sparse inputs are expected. Defaults to False.</p></li>
<li><p><strong>sidechain_only_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – A special case, when the proteins have
the same number of residues, but different numbers of sidechain
dihedrals. In that case only the sidechain dihedrals are considered
to be sparse. Defaults to False.</p></li>
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>kernel_initializer</em>) – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “VarianceScaling”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “VarianceScaling” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
VarianceScaling()</cite>. Defaults to “VarianceScaling”. If “deterministic”
is provided, a seed will be used with VarianceScaling. If a dict with
weight matrices is supplied, the keys should follow this naming con-
vention: [“dense/kernel”, “dense_1/kernel”, “dense_2/kernel”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>dict</strong><strong>[</strong><strong>str</strong> (<em>bias_initializer</em>) – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
<li><p><strong>np.ndarray</strong><strong>]</strong> – Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize
the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">Literal[“ones”, “RandomNormal”, “deterministic”]]): How to initialize</span></dt><dd><p>the weights. If “ones” is provided, the weights will be initialized
with <cite>tf.keras.initializers.Constant(1)</cite>. If “RandomNormal” is
provided, the weights will be initialized with <cite>tf.keras.initializers.
RandomNormal(0.1, 0.05)</cite>. Defaults to “RandomNormal”. If “deterministic”
is provided, a seed will be used with RandomNormal. If a dict with
bias matrices is supplied, the keys should follow this naming con-
vention: [“dense/bias”, “dense_1/bias”, “dense_2/bias”, etc.]
This is tensorflow’s naming convention for unnamed dense layers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>write_summary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to print a summary. If p.tensorboard is True
a file will be generated. at the main_path.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.keras.models.Model</p>
</dd>
</dl>
<p>Here’s a scheme of the generated network:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌───────────────────────────────────────────────────────────────────────────────────────┐
│A linear protein with N standard residues has N*3 backbone atoms (..C-N-CA-C-N..)      │
│it has N*3 - 1 distances between these atoms                                           │
│it has N*3 - 2 angles between three atoms                                              │
│it has N*3 - 3 dihedrals between 4 atoms                                               │
│it has S sidechain dihedrals based on the sequence                                     │
└───────┬─────────────────┬─────────────────┬─────────────────┬─────────────────┬───────┘
        │                 │                 │                 │                 │
        │                 │                 │                 │                 │
        │                 │                 │                 │                 │
┌───────┴───────┐ ┌───────┴───────┐ ┌───────┴───────┐ ┌───────┴───────┐ ┌───────┴───────┐
│cartesians     │ │distances      │ │angles         │ │dihedrals      │ │side dihedrals │
│(batch, N*3, 3)│ │(batch, N*3-1) │ │(batch, N*3-2) │ │(batch, N*3-3) │ │(batch, S)     ├───────┐
└───────┬───────┘ └───────┬───────┘ └───────┬───────┘ └───────┬───────┘ └────────┬──────┘       │Every type
        │                 │                 │                 │                  │              │of angular
        │                 │       ┌─────────┼─────────────────┼──────────────────┤              │input has
        │                 │       │         │                 │                  │              │its own
┌───────┴───────┐         │       │ ┌───────┴───────┐ ┌───────┴───────┐ ┌────────┴──────┐       │cost contri
│pair cartesians│         │ ┌─────┼─┤unitcircle ang │ │unitcircle dih │ │unitcircle sdih│       │bution
│(batch, batch) │         │ │if no│ │(b, (N*3-2)*2) │ │(b, (N*3-3)*2) │ │(b, S*2)       │       │which
└───────┬───────┘         │ │angles └───────┬───────┘ └───────┬───────┘ └────────┬──────┘       │compares
        │compare the pair │ │are  │         │                 │                  │              │input
        │wise distances of│ │fed  │       if│use_backbone_angles               if│use_sidechains│and
        │the input cartesi│ │through        │                 │                  │              │output
        │ans with the gene│ │the  ┼ ┌───────┴─────────────────┴──────────────────┴──────┐       │-&gt;
        │rated cartesians │ │network│concatenate the angle-inputs. Based on parameters. │       │angle_cost
        │-&gt; cartesian loss│ │use  │ │(batch, sum(angle_shapes)                          │       │dihedral_cost
        │                 │ │mean │ └─────────────────────────┬─────────────────────────┘       │side_dihedral
        │                 │ │angles                           │                                 │_cost
        │                 │ │     │                           │                                 │
        │                 │ │     │                           │                                 │
        │                 │ │     │             ┌─────────────┴──────────────┐                  │
        │                 │ │     │             │Encoder layers              │                  │
        │                 │ │     │             │(batch, n_neurons)          │                  │
        │                 │ │     │             └─────────────┬──────────────┘                  │
        │                 │ │     │                           │                                 │
        │                 │ │     │                           │                                 │
        │                 │ │     │add a sigmoid-weighted     │            add a loss function  │
        │      compare the│ │     │loss function that┌────────┴────────┐   to center the points │
        │      ┌──────────┼─┼─────┴──────────────────┤Bottleneck,Latent├────────────────────    │
        │      │generated │ │      compares the pair-│ (batch, 2)      │   around the origin    │
        │      │cartesians│ │      wise distances of └────────┬────────┘   -&gt; center loss       │
        │      │with the  │ │      input and latent           │                                 │
        │      │pairwise  │ │      samples                    │                                 │
        │      │distances │ │      -&gt; distance loss           │                                 │
        │      │of the    │ │                   ┌─────────────┴──────────────┐                  │
        │      │bottleneck│ │                   │Decoder layers              │                  │
        │      │use a 2nd │ │                   │(batch, n_neurons)          │                  │
        │      │sigmoid   │ │                   └─────────────┬──────────────┘                  │
        │      │function  │ │                                 │                                 │
        │      │for this  │ │                                 │                                 │
        │      │-&gt;        │ │                                 │                                 │
        │      │cartesian │ │       ┌─────────────────────────┴─────────────────────────┐       │
        │      │distance  │ │       │split the output of the decoder to get angles back │       │
        │      │loss      │ │       │(batch, sum(angle_shapes)                          │       │
        │      │          │ │       └───────┬─────────────────┬─────────────────┬───────┘       │
        │      │          │ │               │                 │                 │               │
        │      │          │ │               │                 │                 │               │
        │      │          │ │               │                 │                 │               │
        │      │          │ │       ┌───────┴───────┐ ┌───────┴───────┐ ┌───────┴───────┐       │
        │      │          │ │       │unitcircle ang │ │unitcircle dih │ │unitcircle sdih│       │
        │      │          │ │       │(b, (N*3-2)*2) │ │(b, (N*3-3)*2) │ │(b, S*2)       │       │
        │      │          │ │       └───────┬───────┘ └───────┬───────┘ └────────┬──────┘       │
        │      │          │ │               │                 │                  │              │
        │      │          │ │             if│use_backbone_angles               if│use_sidechains│
        │      │          │ │               │                 │                  │              │
        │      │          │ │       ┌───────┴───────┐ ┌───────┴───────┐ ┌────────┴──────┐       │
        │      │          │ └───────┤(mean) angles  │ │dihedrals      │ │side dihedrals │       │
        │      │          │         │(batch,3N*3-2) │ │(batch,3N*3-3) │ │(batch, S)     ├───────┘
        │      │          │         └───────┬───────┘ └───────┬───────┘ └───────────────┘
        │      │          │                 │                 │
        │      │          │                 │                 │
        │      │          │                 │                 │
        │      │  ┌───────┴─────────────────┴─────────────────┴──────┐
        │      │  │create new cartesians with chain-in-plane and     │
        │      │  │rotation matrices (batch, 3*N, 3)                 │
        │      │  └───────┬──────────────────────────────────────────┘
        │      │          │
        │      │          │
        │      │          │
        │      │  ┌───────┴───────┐
        │      └──┤gen pair cartes│
        │         │(batch,batch)  │
        └─────────┴───────────────┘
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models.gen_sequential_model">
<span class="sig-name descname"><span class="pre">gen_sequential_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/models/models.html#gen_sequential_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.gen_sequential_model" title="Link to this definition">#</a></dt>
<dd><p>Returns a tf.keras model with the specified input shape and the
parameters in the Parameters class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The input shape of the returned model. In most cases
that is data.shape[1] of your data.</p></li>
<li><p><strong>parameters</strong> (<em>Optional</em><em>[</em><em>AnyParameters</em><em>]</em>) – The parameters to use on the
returned model. If None is provided the default parameters in
encodermap.Parameters.defaults is used. You can look at the defaults
with print(em.Parameters.defaults_description()). Defaults to None.</p></li>
<li><p><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether sparse inputs are expected. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A subclass of tf.keras.Model build with specified parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>em.SequentialModel</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="parameter_classes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Parameter Classes</p>
      </div>
    </a>
    <a class="right-next"
       href="layers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Layers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel"><code class="docutils literal notranslate"><span class="pre">ADCFunctionalModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.compile"><code class="docutils literal notranslate"><span class="pre">compile</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.decoder"><code class="docutils literal notranslate"><span class="pre">decoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.encoder"><code class="docutils literal notranslate"><span class="pre">encoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.from_config"><code class="docutils literal notranslate"><span class="pre">from_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.get_config"><code class="docutils literal notranslate"><span class="pre">get_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.get_loss"><code class="docutils literal notranslate"><span class="pre">get_loss</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModel.train_step"><code class="docutils literal notranslate"><span class="pre">train_step</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction"><code class="docutils literal notranslate"><span class="pre">ADCFunctionalModelSidechainReconstruction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.from_config"><code class="docutils literal notranslate"><span class="pre">from_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_config"><code class="docutils literal notranslate"><span class="pre">get_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCFunctionalModelSidechainReconstruction.get_loss"><code class="docutils literal notranslate"><span class="pre">get_loss</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCSparseFunctionalModel"><code class="docutils literal notranslate"><span class="pre">ADCSparseFunctionalModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCSparseFunctionalModel.from_config"><code class="docutils literal notranslate"><span class="pre">from_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCSparseFunctionalModel.get_config"><code class="docutils literal notranslate"><span class="pre">get_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.ADCSparseFunctionalModel.get_loss"><code class="docutils literal notranslate"><span class="pre">get_loss</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.MyBiasInitializer"><code class="docutils literal notranslate"><span class="pre">MyBiasInitializer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.MyKernelInitializer"><code class="docutils literal notranslate"><span class="pre">MyKernelInitializer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel"><code class="docutils literal notranslate"><span class="pre">SequentialModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.build"><code class="docutils literal notranslate"><span class="pre">build</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.call"><code class="docutils literal notranslate"><span class="pre">call</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.compile"><code class="docutils literal notranslate"><span class="pre">compile</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.decoder"><code class="docutils literal notranslate"><span class="pre">decoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.encoder"><code class="docutils literal notranslate"><span class="pre">encoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.from_config"><code class="docutils literal notranslate"><span class="pre">from_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.get_config"><code class="docutils literal notranslate"><span class="pre">get_config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.SequentialModel.train_step"><code class="docutils literal notranslate"><span class="pre">train_step</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._concatenate_inputs"><code class="docutils literal notranslate"><span class="pre">_concatenate_inputs</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._concatenate_inputs_reconstruct_sidechains"><code class="docutils literal notranslate"><span class="pre">_concatenate_inputs_reconstruct_sidechains</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._create_inputs_non_periodic_maybe_sparse"><code class="docutils literal notranslate"><span class="pre">_create_inputs_non_periodic_maybe_sparse</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._create_inputs_periodic_maybe_sparse"><code class="docutils literal notranslate"><span class="pre">_create_inputs_periodic_maybe_sparse</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._get_adc_decoder"><code class="docutils literal notranslate"><span class="pre">_get_adc_decoder</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._get_decoder_model"><code class="docutils literal notranslate"><span class="pre">_get_decoder_model</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._get_deterministic_random_normal"><code class="docutils literal notranslate"><span class="pre">_get_deterministic_random_normal</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._get_deterministic_variance_scaling"><code class="docutils literal notranslate"><span class="pre">_get_deterministic_variance_scaling</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._get_encoder_model"><code class="docutils literal notranslate"><span class="pre">_get_encoder_model</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._unpack_and_assert_input_shapes"><code class="docutils literal notranslate"><span class="pre">_unpack_and_assert_input_shapes</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._unpack_and_assert_input_shapes_multimers"><code class="docutils literal notranslate"><span class="pre">_unpack_and_assert_input_shapes_multimers</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models._unpack_and_assert_input_shapes_w_sidechains"><code class="docutils literal notranslate"><span class="pre">_unpack_and_assert_input_shapes_w_sidechains</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.gen_functional_model"><code class="docutils literal notranslate"><span class="pre">gen_functional_model</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.models.models.gen_sequential_model"><code class="docutils literal notranslate"><span class="pre">gen_sequential_model</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_guide/models.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Kevin Sawade, Tobias Lemke, University of Konstanz.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on 2025-05-15T22:43:00.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">Docs for EncoderMap 3.0.1+10.g67ae638.dirty</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>