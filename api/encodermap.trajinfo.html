
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>encodermap.trajinfo package &#8212; encodermap 3.0.1+10.g67ae638.dirty documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c1026b93" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=ea0ca436"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/encodermap.trajinfo';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing" href="../contributing/index.html" />
    <link rel="prev" title="encodermap.plot package" href="encodermap.plot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="3.0.1+10.g67ae638.dirty" />
    <meta name="docbuild:last-update" content="2025-05-15T22:43:00"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_cube_300.png" class="logo__image only-light" alt="encodermap 3.0.1+10.g67ae638.dirty documentation - Home"/>
    <img src="../_static/logo_cube_300.png" class="logo__image only-dark pst-js-only" alt="encodermap 3.0.1+10.g67ae638.dirty documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks/index.html">
    Notebook Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks/index.html">
    Notebook Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="encodermap.autoencoder.html">encodermap.autoencoder package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.callbacks.html">encodermap.callbacks package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.encodermap_tf1.html">encodermap.encodermap_tf1 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.loading.html">encodermap.loading package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.loss_functions.html">encodermap.loss_functions package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.misc.html">encodermap.misc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.models.html">encodermap.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.moldata.html">encodermap.moldata package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.parameters.html">encodermap.parameters package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.plot.html">encodermap.plot package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">encodermap.trajinfo package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">encodermap.trajinfo package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="encodermap-trajinfo-package">
<h1>encodermap.trajinfo package<a class="headerlink" href="#encodermap-trajinfo-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-encodermap.trajinfo.info_all">
<span id="encodermap-trajinfo-info-all-module"></span><h2>encodermap.trajinfo.info_all module<a class="headerlink" href="#module-encodermap.trajinfo.info_all" title="Link to this heading">#</a></h2>
<p>Classes to work with ensembles of trajectories.</p>
<p>The statistics of a protein can be better described by an ensemble of proteins,
rather than a single long trajectory. Treating a protein in such a way opens great
possibilities and changes the way one can treat molecular dynamics data.
Trajectory ensembles allow:</p>
<blockquote>
<div><ul class="simple">
<li><p>Faster convergence via adaptive sampling.</p></li>
<li><p>Better grasp of equilibrium and off-equilibrium dynamics.</p></li>
</ul>
</div></blockquote>
<p>This subpackage contains two classes which are containers of trajectory data.
The SingleTraj trajectory contains information about a single trajectory.
The TrajEnsemble class contains information about multiple trajectories. This adds
a new dimension to MD data. The time and atom dimension are already established.
Two frames can be appended along the time axis to get a trajectory with multiple
frames. If they are appended along the atom axis, the new frame contains the
atoms of these two. The trajectory works in a similar fashion. Adding two trajectories
along the trajectory axis returns a trajectory ensemble, represented as a <cite>TrajEnsemble</cite>
class in this package.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="http://statisticalbiophysicsblog.org/?p=92">http://statisticalbiophysicsblog.org/?p=92</a></p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TrajEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no_load'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_nums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A fancy list of single trajectories. Topologies can be different across trajs.</p>
<p>Check out <a class="reference external" href="http://statisticalbiophysicsblog.org/?p=92">http://statisticalbiophysicsblog.org/?p=92</a> for why trajectory ensembles are awesome.</p>
<p>This class is a fancy list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj`</span></code>.
Trajectories can have different topologies and will be grouped by
the <code class="docutils literal notranslate"><span class="pre">common_str</span></code> argument. Each trajectory has its own unique <code class="docutils literal notranslate"><span class="pre">traj_num</span></code>,
which identifies it in the ensemble - even when the ensemble is sliced or
subsampled.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Addition of two <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a> also creates an ensemble.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span>  
<span class="go">&lt;encodermap.TrajEnsemble object. Current backend is no_load. Containing 2 trajectories. Common str is [&#39;1YUG&#39;, &#39;1YUF&#39;]. Not containing any CVs...&gt;</span>
</pre></div>
</div>
<p>Indexing a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> returns a <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a>
based on its 0-based index. Think of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsmeble</span></code> as a list of
<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a>. But trajectories can also
have <code class="docutils literal notranslate"><span class="pre">traj_nums</span></code>, which do not have to adhere to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">...]</span></code>. This
is similar to how a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.0.dev0+2106.gb2b2d04e41)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> offers indexing via <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>
and <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> (<a class="reference external" href="https://pandas.pydata.org/docs/user_guide/indexing.html#different-choices-for-indexing">https://pandas.pydata.org/docs/user_guide/indexing.html#different-choices-for-indexing</a>).
For indexing trajs based on their <code class="docutils literal notranslate"><span class="pre">traj_num</span></code>, you can use the <code class="docutils literal notranslate"><span class="pre">.tsel[]</span></code>
accessor of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsmeble</span></code></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Addition of two <cite>SingleTraj</cite> also creates an ensemble.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="o">.</span><span class="n">traj_nums</span>
<span class="go">[0, 1]</span>
</pre></div>
</div>
<p>Change the <code class="docutils literal notranslate"><span class="pre">traj_num</span></code> of <code class="docutils literal notranslate"><span class="pre">traj2</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">traj_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="o">.</span><span class="n">traj_nums</span>
<span class="go">[0, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  
<span class="go">&lt;encodermap.SingleTraj object. Currently not in memory. Basename is &#39;1YUF&#39;. Not containing any CVs. Common string is &#39;1YUF&#39;. Object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="o">.</span><span class="n">tsel</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  
<span class="go">&lt;encodermap.SingleTraj object. Currently not in memory. Basename is &#39;1YUF&#39;. Not containing any CVs. Common string is &#39;1YUF&#39;. Object at ...&gt;</span>
</pre></div>
</div>
<p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> supports fancy indexing. You can slice to your liking
(<code class="docutils literal notranslate"><span class="pre">trajs[::5]</span></code> returns a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> object that only consideres
every fifth frame). Besides indexing by slices and integers, you can pass a
2-dimensional <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>. <code class="docutils literal notranslate"><span class="pre">np.array([[0,</span> <span class="pre">5],</span> <span class="pre">[1,</span> <span class="pre">10],</span> <span class="pre">[5,</span> <span class="pre">20]])</span></code>
will return a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> object with frame 5 of trajectory 0, frame
10 of trajectory 1 and frame 20 of trajectory 5.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">trajs</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span>  
<span class="go">&lt;encodermap.TrajEnsemble object. Current backend is no_load. Containing 4 frames and 2 trajectories. Common str is...&gt;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> class also is an iterator to iterate over trajectores.
Besides plain iteration, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsmeble</span></code> also offers alternate iterators.
The <code class="docutils literal notranslate"><span class="pre">itertrajs()</span></code> iterator returns a two-tuple of <code class="docutils literal notranslate"><span class="pre">traj_num</span></code> and <code class="docutils literal notranslate"><span class="pre">traj</span></code>.
The <code class="docutils literal notranslate"><span class="pre">iterframes()</span></code> iterator returns a three-tuple of <code class="docutils literal notranslate"><span class="pre">traj_num</span></code>,
<code class="docutils literal notranslate"><span class="pre">frame_num</span></code>, and <code class="docutils literal notranslate"><span class="pre">traj</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">traj_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">traj_num</span><span class="p">,</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">trajs</span><span class="o">.</span><span class="n">itertrajs</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">traj_num</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="go">0 15</span>
<span class="go">4 16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">traj_num</span><span class="p">,</span> <span class="n">frame_num</span> <span class="p">,</span><span class="n">traj</span> <span class="ow">in</span> <span class="n">trajs</span><span class="o">.</span><span class="n">subsample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">iterframes</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">traj_num</span><span class="p">,</span> <span class="n">frame_num</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="go">0 0 1</span>
<span class="go">0 10 1</span>
<span class="go">4 0 1</span>
<span class="go">4 10 1</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> has multiple alternative constructors. The
<a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble.with_overwrite_trajnums" title="encodermap.trajinfo.info_all.TrajEnsemble.with_overwrite_trajnums"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_overwrite_trajnums</span></code></a> constructor fixes inhomogeneous sequences of
<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a> and <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">,</span> <span class="n">traj_num</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">,</span> <span class="n">traj_num</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="p">([</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">])</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">Exception</span>: <span class="n">The `traj_num` attributes of the provided 2 `SingleTraj`s is not unique, the `traj_num` 0 occurs 2 times. This can happen, if you use `SingleTraj`s, that are already part of a `TrajEnsemble`. To create copies of the `SingleTraj`s and overwrite their `traj_num`s, use the `with_overwrite_trajnums()` constructor.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="o">.</span><span class="n">with_overwrite_trajnums</span><span class="p">(</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span>  
<span class="go">&lt;encodermap.TrajEnsemble...&gt;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#encodermap.trajinfo.info_all.TrajEnsemble.from_dataset" title="encodermap.trajinfo.info_all.TrajEnsemble.from_dataset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dataset</span></code></a> constructor can be used to load an ensemble from
an <code class="docutils literal notranslate"><span class="pre">.h5</span></code> file</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUG&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s2">&quot;1YUF&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="p">([</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">td</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">trajs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">td</span> <span class="o">+</span> <span class="s2">&quot;/trajs.h5&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">new</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span><span class="n">td</span> <span class="o">+</span> <span class="s2">&quot;/trajs.h5&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>  
<span class="go">encodermap.TrajEnsemble object. Current backend is no_load. Containing 2 trajectories. Common str is...Not containing any CVs.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<em>Union</em><em>[</em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>Path</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>md.Trajectory</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>tops</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>Path</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>backend</strong> (<em>Literal</em><em>[</em><em>'mdtraj'</em><em>, </em><em>'no_load'</em><em>]</em>)</p></li>
<li><p><strong>common_str</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>basename_fn</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>traj_nums</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>custom_top</strong> (<em>Optional</em><em>[</em><em>CustomAAsDict</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.CVs">
<span class="sig-name descname"><span class="pre">CVs</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.CVs" title="Link to this definition">#</a></dt>
<dd><p>The collective variables of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code>
classes. Only CVs with matching names in all <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> classes
are returned. The data is stacked along a hypothetical time axis
along the trajs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble._CVs">
<span class="sig-name descname"><span class="pre">_CVs</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble._CVs" title="Link to this definition">#</a></dt>
<dd><p>The same data as in CVs but with labels.
Additionally, the xarray is not stacked along the time axis.
It contains an extra dimension for trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)">xarray.Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.n_trajs">
<span class="sig-name descname"><span class="pre">n_trajs</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_trajs" title="Link to this definition">#</a></dt>
<dd><p>Number of individual trajectories in this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.n_frames">
<span class="sig-name descname"><span class="pre">n_frames</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_frames" title="Link to this definition">#</a></dt>
<dd><p>Number of frames, sum over all trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.locations">
<span class="sig-name descname"><span class="pre">locations</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.locations" title="Link to this definition">#</a></dt>
<dd><p>A list with the locations of the trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.top">
<span class="sig-name descname"><span class="pre">top</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.top" title="Link to this definition">#</a></dt>
<dd><p>A list with the reference pdb for each trajecotry.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[mdtraj.Topology]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.basenames">
<span class="sig-name descname"><span class="pre">basenames</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.basenames" title="Link to this definition">#</a></dt>
<dd><p>A list with the names of the trajecotries.
The leading path and the file extension is omitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.name_arr">
<span class="sig-name descname"><span class="pre">name_arr</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.name_arr" title="Link to this definition">#</a></dt>
<dd><p>An array with <code class="docutils literal notranslate"><span class="pre">len(name_arr)</span> <span class="pre">==</span> <span class="pre">n_frames</span></code>.
This array keeps track of each frame in this object by identifying each
frame with a filename. This can be useful, when frames are mixed inside
a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CVs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Returns dict of CVs in SingleTraj classes. Only CVs with the same names
in all SingleTraj classes are loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.CVs_in_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CVs_in_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.CVs_in_file" title="Link to this definition">#</a></dt>
<dd><p>Is true, if CVs can be loaded from file. Can be used to build a
data generator from.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_CVs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><span class="pre">Dataset</span></a></em><a class="headerlink" href="#id1" title="Link to this definition">#</a></dt>
<dd><p>Returns x-array Dataset of matching CVs. stacked
along the trajectory-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)">xarray.Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id2" title="Link to this definition">#</a></dt>
<dd><p>List of the basenames in the Info single classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.batch_iterator">
<span class="sig-name descname"><span class="pre">batch_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.batch_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.batch_iterator" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">batch_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">batch_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">batch_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Lazy batched iterator of CV data.</p>
<p>This iterator extracts batches of CV data from the ensemble. If the
ensemble is a large HDF5 datset, this provides the ability to use all
data without loading it all into memory.</p>
<p class="rubric">Examples</p>
<p>Import EncoderMap and load some example trajectories.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUG.pdb&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUF.pdb&#39;</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>This iterator will yield new samples forever. The batch is a tuple
of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">trajs</span><span class="o">.</span><span class="n">batch_iterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">([</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">])</span>
<span class="gp">... </span>    <span class="k">break</span>
<span class="go">[(2, 148), (2, 147), (2, 150, 3), (2, 149), (2, 82)]</span>
</pre></div>
</div>
<p>Use it with Pythons builtin <code class="docutils literal notranslate"><span class="pre">next()</span></code> function. The <code class="docutils literal notranslate"><span class="pre">deterministic</span></code>
flag returns deterministic batches. The <code class="docutils literal notranslate"><span class="pre">yield_index</span></code> flag also
provides the index of the extracted batch. In this example, both batches
are extracted from the 1YUG trajectory (<code class="docutils literal notranslate"><span class="pre">traj_num==0</span></code>).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iterator</span> <span class="o">=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">batch_iterator</span><span class="p">(</span><span class="n">deterministic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">yield_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span>
<span class="go">[[0 5]</span>
<span class="go"> [0 8]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span>
<span class="go">[[ 0  3]</span>
<span class="go"> [ 0 10]]</span>
</pre></div>
</div>
<blockquote>
<div><p>If a single string is requested for <code class="docutils literal notranslate"><span class="pre">CV_names</span></code>, the batch, will
be a sinlge <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, rather than a tuple thereof.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iterator</span> <span class="o">=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">batch_iterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">CV_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;central_dihedrals&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 147)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  The size of the batch.</p></li>
<li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether inside a single batch a sample can occur
more than once. Set to False (default) to only allow unique
samples in a batch.</p></li>
<li><p><strong>CV_names</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The names of the CVs to be used in the
iterator. If a list/tuple with a single string is provided, the
batch will be a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, rather than a tuple
thereof.</p></li>
<li><p><strong>deterministic</strong> (<em>bbol</em>)  Whether the samples should be deterministic.</p></li>
<li><p><strong>yield_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to also yield the index of the extracted
samples.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  A start ineteger, which can be used together with
<code class="docutils literal notranslate"><span class="pre">deterministic=True</span></code> to get different deterministic datasets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Different iterators based on chosen arguments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator[Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.cluster">
<span class="sig-name descname"><span class="pre">cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cluster_membership'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memberships</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.cluster" title="Link to this definition">#</a></dt>
<dd><p>Clusters this <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> based on the provided
<code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code>.</p>
<p>With clustering we mean to extract a subset given a certain membership.
Take two trajectories with 3 frames each as an ensemble. Lets say we
calculate the end-to-end distance of the trajectories and use it as
a collective variable of the system. The values are
<code class="docutils literal notranslate"><span class="pre">[0.8,</span> <span class="pre">1.3,</span> <span class="pre">1.2,</span> <span class="pre">1.9,</span> <span class="pre">0.2,</span> <span class="pre">1.3]</span></code>. Based on these values, we define a
boolean CV (using 0 as False and 1 as True) which says whether the
end-to-end distance is smaller or grather than 1.0. We give this CV the
name <code class="docutils literal notranslate"><span class="pre">'end_to_end_binary'</span></code> and the values are <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">1]</span></code>.
We can use this CV to cluster the <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> via:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cluster</span> <span class="pre">=</span> <span class="pre">trajs.cluster(cluster_id=0,</span> <span class="pre">col='end_to_end_binary')</span></code>:</dt><dd><p>This gives a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> with 2 frames.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cluster</span> <span class="pre">=</span> <span class="pre">trajs.cluster(cluster_id=0,</span> <span class="pre">col='end_to_end_binary')</span></code>:</dt><dd><p>This gives a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> with 4 frames.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Sometimes, you want to save this a cluster in a format that can be rendered
by graphical programs (<code class="docutils literal notranslate"><span class="pre">.xtc,</span> <span class="pre">.pdb</span></code>), you can use either the <a class="reference internal" href="#encodermap.trajinfo.info_all.TrajEnsemble.join" title="encodermap.trajinfo.info_all.TrajEnsemble.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">join</span></code></a> or
<a class="reference internal" href="#encodermap.trajinfo.info_all.TrajEnsemble.stack" title="encodermap.trajinfo.info_all.TrajEnsemble.stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stack</span></code></a> method of the resulting :obj:<a href="#id3"><span class="problematic" id="id4">``</span></a>TrajEnsemble` to get a
<cite>mdtraj.Trajectory</cite>, which is either stacked along the atom axis or
joined along the time axis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the resulting <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> has inhomogeneous topologies, the
<a class="reference internal" href="#encodermap.trajinfo.info_all.TrajEnsemble.join" title="encodermap.trajinfo.info_all.TrajEnsemble.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">join</span></code></a> method will return a dict[md.Topology, md.Trajectory]
instead. This dict can be used to save multiple (<code class="docutils literal notranslate"><span class="pre">.xtc,</span> <span class="pre">.pdb</span></code>) files
and visualize your cluster in external programs.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">col</span></code> parameter takes any CV name, that is per-frame and integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  The cluster id to use. Needs to be an integer,
that is present in the <code class="docutils literal notranslate"><span class="pre">col</span></code> parameter.</p></li>
<li><p><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)  Which column of the collective variables to use.
Needs to be a key, that can be found in <code class="docutils literal notranslate"><span class="pre">trajs.CVs.keys()</span></code>.</p></li>
<li><p><strong>memberships</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>)  If a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> is
provided here, the memberships from this array will be used.
In this case, the <code class="docutils literal notranslate"><span class="pre">col</span></code> argument will be unused.</p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  How many points the resulting cluster should contain.
Subsamples the points in <code class="docutils literal notranslate"><span class="pre">col</span> <span class="pre">==</span> <span class="pre">cluster_id</span></code> evenly and without
repeat. If set to -1, all points will be used.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  When the <code class="docutils literal notranslate"><span class="pre">memberships</span></code> argument is used, but the
<a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> already has a CV under the name specified by
<code class="docutils literal notranslate"><span class="pre">col</span></code>, you can set this to True to overwrite this column. Can
be helpful, when you iteratively conduct multiple clusterings.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><em>TrajEnsemble</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Import EncoderMap and NumPy.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Load an example project.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">load_project</span><span class="p">(</span><span class="s2">&quot;pASP_pGLU&quot;</span><span class="p">,</span> <span class="n">load_autoencoder</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an array full of <code class="docutils literal notranslate"><span class="pre">-1</span></code>s. These are the outliers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_membership</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">trajs</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>Select the first 5 frames of every traj to be in cluster 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_membership</span><span class="p">[</span><span class="n">trajs</span><span class="o">.</span><span class="n">id</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Select all frames between 50 and 55 to be cluster 1.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_membership</span><span class="p">[(</span><span class="mi">50</span> <span class="o">&lt;=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">id</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">trajs</span><span class="o">.</span><span class="n">id</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">55</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cluster_membership</span><span class="p">)</span>
<span class="go">array([-1.,  0.,  1.])</span>
</pre></div>
</div>
<p>Load this array as a CV called <code class="docutils literal notranslate"><span class="pre">'clu_mem'</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="o">.</span><span class="n">load_CVs</span><span class="p">(</span><span class="n">cluster_membership</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;clu_mem&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Extract all of cluster 0 with <code class="docutils literal notranslate"><span class="pre">n_points=-1</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clu0</span> <span class="o">=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;clu_mem&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clu0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">35</span>
</pre></div>
</div>
<p>Extract an evenly spaced subset of cluster 1 with 10 total points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clu1</span> <span class="o">=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;clu_mem&quot;</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clu1</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Cclusters with inhomogeneous topologies can be stacked along the atom axis.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">n_atoms</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">trajs</span><span class="p">]</span>
<span class="go">[69, 83, 103, 91, 80, 63, 73]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked</span> <span class="o">=</span> <span class="n">clu1</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">795</span>
</pre></div>
</div>
<p>But joining the trajectories returns a <code class="docutils literal notranslate"><span class="pre">dict[top,</span> <span class="pre">traj]</span></code> if the
topologies are inhomogeneous.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">joined</span> <span class="o">=</span> <span class="n">clu1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">joined</span><span class="p">)</span>
<span class="go">&lt;class &#39;dict&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.copy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.dash_summary">
<span class="sig-name descname"><span class="pre">dash_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.dash_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.dash_summary" title="Link to this definition">#</a></dt>
<dd><p>A <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.0.dev0+2106.gb2b2d04e41)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> that summarizes this ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataFrame.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.del_CVs">
<span class="sig-name descname"><span class="pre">del_CVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.del_CVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.del_CVs" title="Link to this definition">#</a></dt>
<dd><p>Deletes all CVs in all trajs. Does not affect the files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>CVs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.del_featurizer">
<span class="sig-name descname"><span class="pre">del_featurizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.del_featurizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.del_featurizer" title="Link to this definition">#</a></dt>
<dd><p>Deletes the current instance of <code class="docutils literal notranslate"><span class="pre">self.featurizer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.featurizer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">featurizer</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.featurizer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.frames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.frames" title="Link to this definition">#</a></dt>
<dd><p>Frames of individual trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.from_dataset">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.from_dataset" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>basename_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><em>TrajEnsemble</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.from_textfile">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_textfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.from_textfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.from_textfile" title="Link to this definition">#</a></dt>
<dd><p>Creates a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> object from a textfile.</p>
<dl class="simple">
<dt>The textfile needs to be space-separated with two or three columns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Column 1:</dt><dd><p>The trajectory file.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Column 2:</dt><dd><p>The corresponding topology file (If you are using <code class="docutils literal notranslate"><span class="pre">.h5</span></code> trajs,
column 1 and 2 will be identical, but column 2 needs to be there
nonetheless).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Column 3:</dt><dd><p>The common string of the trajectory. This column can be left
out, which will result in an <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> without common
strings.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>]</em>)  File to be read.</p></li>
<li><p><strong>basename_fn</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>)  A function
to apply to the <code class="docutils literal notranslate"><span class="pre">traj_file</span></code> string to return the basename of
the trajectory. If None is provided, the filename without
extension will be used.  When all files are named the same and
the folder theyre in defines the name of the trajectory, you
can supply <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">split('/')[-2]</span></code> as this argument.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble">TrajEnsemble</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.get_single_frame">
<span class="sig-name descname"><span class="pre">get_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.get_single_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.get_single_frame" title="Link to this definition">#</a></dt>
<dd><p>Returns a single frame from all loaded trajectories.</p>
<p>Consider a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> class with two trajectories. One has 10
frames, the other 5 (<code class="docutils literal notranslate"><span class="pre">trajs.n_frames</span></code> is 15). Calling
<code class="docutils literal notranslate"><span class="pre">trajs.get_single_frame(12)</span></code> is equal to calling <code class="docutils literal notranslate"><span class="pre">trajs[1][1]</span></code>.
Calling <code class="docutils literal notranslate"><span class="pre">trajs.get_single_frame(16)</span></code> will error, and
<code class="docutils literal notranslate"><span class="pre">trajs.get_single_frame(1)</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">trajs[0][1]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  The frame to return.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj">encodermap.trajinfo.info_single.SingleTraj</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.id" title="Link to this definition">#</a></dt>
<dd><p>Duplication of self.index_arr</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.index_arr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_arr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.index_arr" title="Link to this definition">#</a></dt>
<dd><p>Returns np.ndarray with ndim = 2. Clearly assigning every
loaded frame an identifier of traj_num (self.index_arr[:,0]) and
frame_num (self.index_arr[:,1]). Can be used to create an unspecified
subset of frames and can be useful when used with clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.iterframes">
<span class="sig-name descname"><span class="pre">iterframes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.iterframes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.iterframes" title="Link to this definition">#</a></dt>
<dd><p>Generator over the frames in this instance.</p>
<dl class="field-list">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>tuple</em> </p>
<dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>int: The traj_num</p></li>
<li><p>int: The frame_num</p></li>
<li><p>encodermap.SingleTraj: An SingleTraj object.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><em>Iterator</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj">SingleTraj</a>]]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Import EncoderMap and load an example <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUG.pdb&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUF.pdb&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trajs</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="go">31</span>
</pre></div>
</div>
<p>Subsample every tenth frame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">trajs</span><span class="o">.</span><span class="n">subsample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Call the <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble.iterframes" title="encodermap.trajinfo.info_all.TrajEnsemble.iterframes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iterframes</span></code></a> method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">traj_num</span><span class="p">,</span> <span class="n">frame_num</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">trajs</span><span class="o">.</span><span class="n">iterframes</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">traj_num</span><span class="p">,</span> <span class="n">frame_num</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="go">0 0 1</span>
<span class="go">0 10 1</span>
<span class="go">1 0 1</span>
<span class="go">1 10 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.itertrajs">
<span class="sig-name descname"><span class="pre">itertrajs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.itertrajs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.itertrajs" title="Link to this definition">#</a></dt>
<dd><p>Generator over the SingleTraj classes.</p>
<dl class="field-list">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>tuple</em> </p>
<dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>int: A loop-counter integer. Is identical with traj.traj_num.</p></li>
<li><p>encodermap.SingleTraj: An SingleTraj object.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><em>Iterator</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj">SingleTraj</a>]]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">TrajEnsemble</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUG.pdb&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;https://files.rcsb.org/view/1YUF.pdb&#39;</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">trajs</span><span class="o">.</span><span class="n">itertrajs</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">basename</span><span class="p">)</span>
<span class="go">1YUG</span>
<span class="go">1YUF</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">align_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_align_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'top'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.join" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>align_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>superpose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>ref_align_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>base_traj</strong> (<em>Trajectory</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>progbar</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>dict_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'top'</em><em>, </em><em>'cs'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<em>Topology</em> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <em>Trajectory</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.load_CVs">
<span class="sig-name descname"><span class="pre">load_CVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_aas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alignment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.load_CVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_CVs" title="Link to this definition">#</a></dt>
<dd><p>Loads CVs in various ways. The easiest way is to provide a single
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> and a name for that array.</p>
<p>Besides np.ndarray, files (<code class="docutils literal notranslate"><span class="pre">.txt</span> <span class="pre">and</span> <span class="pre">.npy</span></code>) can be loaded. Features
or Featurizers can be provided. A <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> can be provided.
A str can be provided which either is the name of one of EncoderMaps
features (<cite>encodermap.features</cite>) or the string can be all,
which loads all features required for EncoderMaps
<code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.autoencoder.autoencoder`AngleDihedralCartesianEncoderMap</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>TrajEnsembleFeatureType</em><em>]</em>)  The CV to
load. When a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> is provided, it needs to have
a shape matching <code class="docutils literal notranslate"><span class="pre">n_frames</span></code> and the data will be distributed
to the trajs, When a list of files is provided, <code class="docutils literal notranslate"><span class="pre">len(data)</span></code>
(the files) needs to match <code class="docutils literal notranslate"><span class="pre">n_trajs</span></code>. The first file will be
loaded by the first traj (based on the trajs <code class="docutils literal notranslate"><span class="pre">traj_num</span></code>) and
so on. If a list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> is provided, the first
array will be assigned to the first traj (based on the trajs
<code class="docutils literal notranslate"><span class="pre">traj_num</span></code>). If None is provided, the argument <code class="docutils literal notranslate"><span class="pre">directory</span></code>
will be used to construct a str using this expression
<code class="docutils literal notranslate"><span class="pre">fname</span> <span class="pre">=</span> <span class="pre">directory</span> <span class="pre">+</span> <span class="pre">traj.basename</span> <span class="pre">+</span> <span class="pre">'_'</span> <span class="pre">+</span> <span class="pre">attr_name</span></code>. If
there are <code class="docutils literal notranslate"><span class="pre">.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">.npy</span></code> files matching that string in
the <code class="docutils literal notranslate"><span class="pre">directory</span></code>, the CVs will be loaded from these files to
the corresponding trajs. Defaults to None.</p></li>
<li><p><strong>attr_name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The name under which the CV should
be found in the class. Choose whatever you like. <code class="docutils literal notranslate"><span class="pre">'highd'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'lowd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'dists'</span></code>, etc. The CV can then be accessed via
dot-notation: <code class="docutils literal notranslate"><span class="pre">trajs.attr_name</span></code>. Defaults to None, in which
case, the argument <code class="docutils literal notranslate"><span class="pre">data</span></code> should point to existing files.
The <code class="docutils literal notranslate"><span class="pre">attr_name</span></code> will be extracted from these files.</p></li>
<li><p><strong>cols</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)  <p>A list of integers indexing the columns
of the data to be loaded. This is useful if a file contains
columns which are not features (i.e. an indexer or the error of
the features. eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span>   <span class="n">f1</span>    <span class="n">f2</span>    <span class="n">f1_err</span>    <span class="n">f2_err</span>
<span class="mi">0</span>    <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">0.1</span>       <span class="mf">0.1</span>
<span class="mi">1</span>    <span class="mf">2.5</span>   <span class="mf">1.2</span>   <span class="mf">0.11</span>      <span class="mf">0.52</span>
</pre></div>
</div>
<p>In that case, you would want to supply <code class="docutils literal notranslate"><span class="pre">cols=[1,</span> <span class="pre">2]</span></code> to the
<code class="docutils literal notranslate"><span class="pre">cols</span></code> argument. If None is provided all columns are loaded.
Defaults to None.</p>
</p></li>
<li><p><strong>deg</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)  Whether to return angular CVs using degrees.
If None or False, CVs will be in radian. Defaults to None.</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to use the minimum image convention to
calculate distances/angles/dihedrals. This is generally recommended,
when you dont clean up your trajectories and the proteins break
over the periodic boundary conditions. However, when the protein is
large, the distance between one site and another might be shorter
through the periodic boundary. This can lead to wrong results
in your distance calculations.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  A list containing the labels for the dimensions of
the data. If you provide a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape
<code class="docutils literal notranslate"><span class="pre">(n_trajs,</span> <span class="pre">n_frames,</span> <span class="pre">n_feat)</span></code>, this list needs to be of
<code class="docutils literal notranslate"><span class="pre">len(n_feat)</span></code>. An exception will be raised otherwise. If None is
privided, the labels will be automatically generated. Defaults to None.</p></li>
<li><p><strong>directory</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  If this argument is provided, the
directory will be searched for <code class="docutils literal notranslate"><span class="pre">.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">.npy</span></code> files which
have the same names as the trajectories have basenames. The
CVs will then be loaded from these files.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether the trajs in this class belong to an ensemble.
This implies that they contain either the same topology or are
very similar (think wt, and mutant). Setting this option True will
try to match the CVs of the trajs onto the same dataset.
If a VAL residue has been replaced by LYS in the mutant,
the number of sidechain dihedrals will increase. The CVs of the
trajs with VAL will thus contain some NaN values. Defaults to False.</p></li>
<li><p><strong>override</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to override CVs with the same name as <code class="docutils literal notranslate"><span class="pre">attr_name</span></code>.</p></li>
<li><p><strong>custom_aas</strong> (<em>Optional</em><em>[</em><em>CustomAAsDict</em><em>]</em>)  You can provide non-standard
residue definitions in this argument. See
<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="encodermap.trajinfo.trajinfo_utils.CustomTopology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.trajinfo_utils.CustomTopology</span></code></a> for
information how to use the custom_aas argument. If set to None
(default), only standard residue names are assumed.</p></li>
<li><p><strong>alignment</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  If your proteins have similar but different
sequences, you can provide a CLUSTAL W alignment as this argument
and the featurization will align the features accordingly.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a>  When wrong Type has been provided for data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.load_custom_topology">
<span class="sig-name descname"><span class="pre">load_custom_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.load_custom_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_custom_topology" title="Link to this definition">#</a></dt>
<dd><p>Loads a custom_topology from a <cite>CustomTopology</cite> class or a dict.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><cite>CustomTopology</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>custom_top</strong> (<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="encodermap.trajinfo.trajinfo_utils.CustomTopology"><em>CustomTopology</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>None</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'bonds'</em><em>, </em><em>'optional_bonds'</em><em>, </em><em>'delete_bonds'</em><em>, </em><em>'optional_delete_bonds'</em><em>, </em><em>'PHI'</em><em>, </em><em>'PSI'</em><em>, </em><em>'OMEGA'</em><em>, </em><em>'not_PHI'</em><em>, </em><em>'not_PSI'</em><em>, </em><em>'not_OMEGA'</em><em>, </em><em>'CHI1'</em><em>, </em><em>'CHI2'</em><em>, </em><em>'CHI3'</em><em>, </em><em>'CHI4'</em><em>, </em><em>'CHI5'</em><em>]</em><em>, </em><em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>list</em><em>[</em><em>tuple</em><em>[</em><em>str</em><em> | </em><em>int</em><em>, </em><em>str</em><em> | </em><em>int</em><em>]</em><em>]</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>)  Optional[Union[CustomTopology, CustomAAsDict]]: An instance of the
<cite>CustomTopology</cite> class or a dictionary that can be made into such.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.load_trajs">
<span class="sig-name descname"><span class="pre">load_trajs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.load_trajs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_trajs" title="Link to this definition">#</a></dt>
<dd><p>Loads all trajs in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">locations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id5" title="Link to this definition">#</a></dt>
<dd><p>Duplication of self.traj_files but using the trajs own traj_file attribute.
Ensures that traj files are always returned independent of the current load state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id6">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id6" title="Link to this definition">#</a></dt>
<dd><p>Sum of the loaded frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.n_residues">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_residues</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_residues" title="Link to this definition">#</a></dt>
<dd><p>List of number of residues of the SingleTraj classes</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id7">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_trajs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id7" title="Link to this definition">#</a></dt>
<dd><p>Number of trajectories in this ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id8">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name_arr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#id8" title="Link to this definition">#</a></dt>
<dd><p>Trajectory names with the same length as self.n_frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.parse_clustal_w_alignment">
<span class="sig-name descname"><span class="pre">parse_clustal_w_alignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aln</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.parse_clustal_w_alignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.parse_clustal_w_alignment" title="Link to this definition">#</a></dt>
<dd><p>Parse an alignment in ClustalW format and add the info to the trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>aln</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)  The alignment in ClustalW format.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.save" title="Link to this definition">#</a></dt>
<dd><p>Saves this TrajEnsemble into a single <code class="docutils literal notranslate"><span class="pre">.h5</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>]</em>)  Where to save the file.</p></li>
<li><p><strong>CVs</strong> (<em>Union</em><em>[</em><em>Literal</em><em>[</em><em>&quot;all&quot;</em><em>]</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Literal</em><em>[</em><em>False</em><em>]</em><em>]</em>)  Which CVs
to alos store in the file. If set to <code class="docutils literal notranslate"><span class="pre">'all'</span></code>, all CVs will
be saved. Otherwise, a list[str] can be provided to only save
specific CVs. Can also be set to False, no CVs are stored in the
file.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  If the file exists, it is overwritten.</p></li>
<li><p><strong>only_top</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Only writes the trajectories topologies into the file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a>  If file already exists and overwrite is not True.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.save_CVs">
<span class="sig-name descname"><span class="pre">save_CVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.save_CVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.save_CVs" title="Link to this definition">#</a></dt>
<dd><p>Saves the CVs to a NETCDF file using xarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.sidechain_info">
<span class="sig-name descname"><span class="pre">sidechain_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.sidechain_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.sidechain_info" title="Link to this definition">#</a></dt>
<dd><p>Indices used for the AngleDihedralCartesianEncoderMap class to
allow training with multiple different sidechains.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The indices. The key -1 is used for
the hypothetical convex hull of all feature spaces (the output of
the tensorflow model). The other keys match the common_str of the
trajs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Sequence[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a>  When the common_strings and topologies are not
    aligned. An exception is raised. Aligned means that all trajs
    with the same common_str should possess the same topology.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.split_into_frames">
<span class="sig-name descname"><span class="pre">split_into_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.split_into_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.split_into_frames" title="Link to this definition">#</a></dt>
<dd><p>Splits self into separate frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to do the split inplace or not.
Defaults to False and thus, returns a new <cite>TrajEnsemble</cite> class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">align_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_align_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.stack" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>align_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>superpose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>ref_align_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>base_traj</strong> (<em>Trajectory</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>progbar</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.subsample">
<span class="sig-name descname"><span class="pre">subsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.subsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.subsample" title="Link to this definition">#</a></dt>
<dd><p>Returns a subset of this <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> given the provided stride
or total.</p>
<p>This is a faster alternative than using the <code class="docutils literal notranslate"><span class="pre">trajs[trajs.index_arr[::1000]]</span></code>
when HDF5 trajs are used, because the slicing information is saved in the
respective <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a></p>
<blockquote>
<div><p>and loading of single frames is faster in HDF5 formatted trajs.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stride</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>)  Return a frame ever stride frames.</p></li>
<li><p><strong>total</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>)  Return a total of evenly sampled frames.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A trajectory ensemble.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble">TrajEnsemble</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The result from <code class="docutils literal notranslate"><span class="pre">subsample(1000)`</span> <span class="pre">`is</span> <span class="pre">different</span> <span class="pre">from</span>
<span class="pre">``trajs[trajs.index_arr[::1000]]</span></code>. With subsample every trajectory
is sub-sampled independently. Consider a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> with two
<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a> trajectories with
18 frames each. <code class="docutils literal notranslate"><span class="pre">subsampled</span> <span class="pre">=</span> <span class="pre">trajs.subsample(5)</span></code> would return a
<a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> with two trajs with 3 frames each
(<code class="docutils literal notranslate"><span class="pre">subsampled.n_frames</span> <span class="pre">==</span> <span class="pre">6</span></code>). Whereas,
<code class="docutils literal notranslate"><span class="pre">subsampled</span> <span class="pre">=</span> <span class="pre">trajs[trajs.index_arr[::5]]</span></code> would return a
<a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> with 7 SingleTrajs with 1 frame each
(<code class="docutils literal notranslate"><span class="pre">subsampled.n_frames</span> <span class="pre">==</span> <span class="pre">7</span></code>). Because the time and frame numbers
are saved all the time, this should not be too much of a problem.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.tf_dataset">
<span class="sig-name descname"><span class="pre">tf_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sidechains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reconstruct_sidechains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.tf_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.tf_dataset" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>sidechains</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>reconstruct_sidechains</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>CV_names</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>deterministic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>prefetch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tf.data.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.to_alignment_query">
<span class="sig-name descname"><span class="pre">to_alignment_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.to_alignment_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.to_alignment_query" title="Link to this definition">#</a></dt>
<dd><p>A string, that cen be put into sequence alignment software.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.to_dataframe">
<span class="sig-name descname"><span class="pre">to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CV</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.to_dataframe" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>CV</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id9">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Topology</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id9" title="Link to this definition">#</a></dt>
<dd><p>Returns a minimal set of mdtraj.Topologies.</p>
<p>If all trajectories share the same topology a list
with len 1 will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.top_files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.top_files" title="Link to this definition">#</a></dt>
<dd><p>Returns minimal set of topology files.</p>
<p>If yoy want a list of top files with the same
length as self.trajs use self._top_files and
self._traj_files.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.traj_files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traj_files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_files" title="Link to this definition">#</a></dt>
<dd><p>A list of the traj_files of the individual SingleTraj classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.traj_joined">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traj_joined</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Trajectory</span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_joined" title="Link to this definition">#</a></dt>
<dd><p>Returns a mdtraj Trajectory with every frame of
this class appended along the time axis.</p>
<p>Can also work if different topologies (with the same number of atoms) are loaded.
In that case, the first frame in self will be used as topology parent and the remaining frames
xyz coordinates are used to position the parents atoms accordingly.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">load_project</span><span class="p">(</span><span class="s2">&quot;pASP_pGLU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample</span> <span class="o">=</span> <span class="n">trajs</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span> <span class="o">+</span> <span class="n">trajs</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample</span><span class="o">.</span><span class="n">split_into_frames</span><span class="p">()</span><span class="o">.</span><span class="n">traj_joined</span>  
<span class="go">&lt;mdtraj.Trajectory with 40 frames, 69 atoms, 6 residues, and unitcells at ...&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mdtraj.Trajectory</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.traj_nums">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traj_nums</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_nums" title="Link to this definition">#</a></dt>
<dd><p>Number of info single classes in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_common_str">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trajs_by_common_str</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><span class="pre">TrajEnsemble</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_common_str" title="Link to this definition">#</a></dt>
<dd><p>Returns the trajs in <cite>self</cite> ordered by top.</p>
<p>If all trajectories share the same common_str, a dict with
one key will be returned. As the common_str can be None, None can also
occur as a key in this dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble">TrajEnsemble</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_top">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trajs_by_top</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Topology</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><span class="pre">TrajEnsemble</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_top" title="Link to this definition">#</a></dt>
<dd><p>Returns the trajs in <cite>self</cite> ordered by top.</p>
<p>If all trajectories share the same topology, a dict with
one key will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[md.Topology, <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble">TrajEnsemble</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_traj_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trajs_by_traj_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><span class="pre">SingleTraj</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_traj_num" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.tsel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tsel</span></span><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.tsel" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.unload">
<span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.unload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.unload" title="Link to this definition">#</a></dt>
<dd><p>Unloads all trajs in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.with_overwrite_trajnums">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_overwrite_trajnums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">trajs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_all.html#TrajEnsemble.with_overwrite_trajnums"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.with_overwrite_trajnums" title="Link to this definition">#</a></dt>
<dd><p>Creates a <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> by copying the provided
<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_single.SingleTraj</span></code></a> instances and
changing their <code class="docutils literal notranslate"><span class="pre">traj_num</span></code> attribute to adhere to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">...]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em>]</em>)  The sequence of trajs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble">TrajEnsemble</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_all.TrajEnsemble.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_all.TrajEnsemble.xyz" title="Link to this definition">#</a></dt>
<dd><p>xyz coordinates of all atoms stacked along the traj-time axis.</p>
<p>Only works if all trajs share the same topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-encodermap.trajinfo.info_single">
<span id="encodermap-trajinfo-info-single-module"></span><h2>encodermap.trajinfo.info_single module<a class="headerlink" href="#module-encodermap.trajinfo.info_single" title="Link to this heading">#</a></h2>
<p>Classes to work with ensembles of trajectories.</p>
<p>The statistics of a protein can be better described by an ensemble of proteins,
rather than a single long trajectory. Treating a protein in such a way opens great
possibilities and changes the way one can treat molecular dynamics data.
Trajectory ensembles allow:</p>
<blockquote>
<div><ul class="simple">
<li><p>Faster convergence via adaptive sampling.</p></li>
<li><p>Better anomaly detection of unique structural states.</p></li>
</ul>
</div></blockquote>
<p>This subpackage contains two classes which are containers of trajectory data.
The SingleTraj trajectory contains information about a single trajectory.
The TrajEnsemble class contains information about multiple trajectories. This adds
a new dimension to MD data. The time and atom dimension are already established.
Two frames can be appended along the time axis to get a trajectory with multiple
frames. If they are appended along the atom axis, the new frame contains the
atoms of these two. The trajectory works in a similar fashion. Adding two trajectories
along the trajectory axis returns a trajectory ensemble, represented as a TrajEnsemble
class in this package.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="http://statisticalbiophysicsblog.org/?p=92">http://statisticalbiophysicsblog.org/?p=92</a></p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SingleTraj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no_load'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class contains the info about a single trajectory.</p>
<p>This class contains many of the attributes and methods of
<a class="reference external" href="https://www.mdtraj.org/1.9.8.dev0/api/generated/mdtraj.Trajectory.html">mdtraj.Trajectory</a>.
It is meant to be used as a standalone single trajetcory or in an ensemble
defined in the <a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.info_all.TrajEnsemble</span></code></a> class.
Other than the standard
<a class="reference external" href="https://www.mdtraj.org/1.9.8.dev0/api/generated/mdtraj.Trajectory.html">mdtraj.Trajectory</a>
this class loads the MD data only when needed. The location of the file(s)
and other attributes like indices (int, list[int], numpy.ndarray, slice)
are stored until the traj is accessed via the
<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj.traj" title="encodermap.trajinfo.info_single.SingleTraj.traj"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SingleTraj.traj</span></code></a> attribute. The returned traj is a
<a class="reference external" href="https://www.mdtraj.org/1.9.8.dev0/api/generated/mdtraj.Trajectory.html">mdtraj.Trajectory</a>
with the correct number of frames in the correct sequence.</p>
<p>Besides MD data,  this class keeps track of your collective variables. Oftentimes
the raw xyz data of a trajectory is not needed for understanding the conformation
and suitable CVs are selected to represent a protein via internal coordinates
(torsions, pairwise distances, etc.). This class keeps tack of your CVs.
Whether you call them <code class="docutils literal notranslate"><span class="pre">'highd'</span></code> or <code class="docutils literal notranslate"><span class="pre">'torsions'</span></code>, this class keeps
track of everything and returns the values when you need them.</p>
<p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a> supports fancy indexing, so you can extract one or more frames
from a Trajectory as a separate trajectory. For example, to form a
trajectory with every other frame, you can slice with <code class="docutils literal notranslate"><span class="pre">traj[::2]</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SingleTraj uses the nanometer, degree &amp; picosecond unit system.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>, </em><em>md.Trajectory</em><em>]</em>)</p></li>
<li><p><strong>top</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>common_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>backend</strong> (<em>Literal</em><em>[</em><em>'no_load'</em><em>, </em><em>'mdtraj'</em><em>]</em>)</p></li>
<li><p><strong>index</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.13)"><em>slice</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>traj_num</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>)</p></li>
<li><p><strong>basename_fn</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>custom_top</strong> (<em>Optional</em><em>[</em><em>CustomAAsDict</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.backend">
<span class="sig-name descname"><span class="pre">backend</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.backend" title="Link to this definition">#</a></dt>
<dd><p>Current state of loading. If <code class="docutils literal notranslate"><span class="pre">backend</span> <span class="pre">==</span> <span class="pre">'no_load'</span></code> xyz
data will be loaded from disk, if accessed. If <code class="docutils literal notranslate"><span class="pre">backend</span> <span class="pre">==</span> <span class="pre">'mdtraj'</span></code>,
the data is already in RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.common_str">
<span class="sig-name descname"><span class="pre">common_str</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.common_str" title="Link to this definition">#</a></dt>
<dd><p>Substring of <a class="reference internal" href="../user_guide/singletraj.html#id5" title="encodermap.trajinfo.info_single.SingleTraj.traj_file"><code class="xref py py-attr docutils literal notranslate"><span class="pre">traj_file</span></code></a> and <a class="reference internal" href="../user_guide/singletraj.html#id0" title="encodermap.trajinfo.info_single.SingleTraj.top_file"><code class="xref py py-attr docutils literal notranslate"><span class="pre">top_file</span></code></a>.
Used to group multiple trajectory and topology files.
If <code class="docutils literal notranslate"><span class="pre">traj</span> <span class="pre">files=['protein1_traj1.xtc',</span> <span class="pre">'protein1_traj2.xtc']</span></code>
have the same topolgy stored in a file called <code class="docutils literal notranslate"><span class="pre">'protein1.pdb'</span></code>, you
can load them with <code class="docutils literal notranslate"><span class="pre">common_str='protein1'</span></code> together with more <code class="docutils literal notranslate"><span class="pre">.xtc</span></code>
and <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files and these two <code class="docutils literal notranslate"><span class="pre">.xtc</span></code> files will use the correct
<code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.index">
<span class="sig-name descname"><span class="pre">index</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.index" title="Link to this definition">#</a></dt>
<dd><p>A sequence of
fancy slices of the trajectory. When file is loaded from disk, the
fancy indexes will be applied one after the other.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence[Union[None, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.13)">slice</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.traj_num">
<span class="sig-name descname"><span class="pre">traj_num</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.traj_num" title="Link to this definition">#</a></dt>
<dd><p>Integer to identify a SingleTraj class in a TrajEnsemble class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.traj_file">
<span class="sig-name descname"><span class="pre">traj_file</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.traj_file" title="Link to this definition">#</a></dt>
<dd><p>Trajectory file used to create this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.top_file">
<span class="sig-name descname"><span class="pre">top_file</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.top_file" title="Link to this definition">#</a></dt>
<dd><p>Topology file used to create this class. If a .h5 trajectory
was used traj_file and top_file are identical. If a
<code class="docutils literal notranslate"><span class="pre">mdtraj.Trajectory</span></code> was used to create SingleTraj, these strings are empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Load a pdb file with 14 frames from rcsb.org</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span>  
<span class="go">&lt;encodermap.SingleTraj object...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">14</span>
</pre></div>
</div>
<p>Providing common_str sets this attribute.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">,</span> <span class="n">common_str</span><span class="o">=</span><span class="s2">&quot;1GHC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">common_str</span>
<span class="go">&#39;1GHC&#39;</span>
</pre></div>
</div>
<p>Indexing using integers returns a SingleTraj with only one frame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Indexing can also use lists of integers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Further indexing this <code class="docutils literal notranslate"><span class="pre">subset</span></code> uses the current trajectory as is. Although
frame 0, 1, and 5 have been extracted from <code class="docutils literal notranslate"><span class="pre">traj</span></code>, we get frame 5 from
<code class="docutils literal notranslate"><span class="pre">subset</span></code> by indexing with 2.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">id</span>
<span class="go">array([5])</span>
</pre></div>
</div>
<p>Indexing using the original frame indices from the file is done using the
<code class="docutils literal notranslate"><span class="pre">fsel[]</span></code> accessor.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">fsel</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">id</span>
<span class="go">array([5])</span>
</pre></div>
</div>
<p>Advanced slicing</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">frame</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">]</span>
<span class="go">[13, 11, 9]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">traj_num</span></code> argument is mainly used in <code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.TrajEnsemble</span></code>,
but can be provided manually.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">,</span> <span class="n">traj_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">traj_num</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">basename_fn</span></code> should be a callable, that takes a string
and returns a string.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_basename_fn</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">stem</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s2">&quot;custom_&quot;</span> <span class="o">+</span> <span class="n">stem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">,</span> <span class="n">basename_fn</span><span class="o">=</span><span class="n">my_basename_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">basename</span>
<span class="go">&#39;custom_1GHC&#39;</span>
</pre></div>
</div>
<p>Build a trajectory ensemble from multiple <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1YUG.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1YUF.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajs</span> <span class="o">=</span> <span class="n">traj1</span> <span class="o">+</span> <span class="n">traj2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trajs</span><span class="o">.</span><span class="n">n_trajs</span><span class="p">,</span> <span class="n">trajs</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="p">[</span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">trajs</span><span class="p">])</span>
<span class="go">2 31 [15, 16]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.CVs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CVs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.CVs" title="Link to this definition">#</a></dt>
<dd><p>Returns a simple dict from the more complicated self._CVs xarray Dataset.</p>
<p>If self._CVs is empty and self.traj_file is a HDF5 (.h5) file, the contents
of the HDF5 will be checked, whether CVs have been stored there.
If not and empty dict will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.CVs_in_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CVs_in_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.CVs_in_file" title="Link to this definition">#</a></dt>
<dd><p>Is True, if <cite>traj_file</cite> has exyension .h5 and contains CVs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj._frames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_frames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj._frames" title="Link to this definition">#</a></dt>
<dd><p>Applies self.index over self._orig_frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj._mdtraj_attr">
<span class="sig-name descname"><span class="pre">_mdtraj_attr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['n_frames',</span> <span class="pre">'n_atoms',</span> <span class="pre">'n_chains',</span> <span class="pre">'n_residues',</span> <span class="pre">'openmm_boxes',</span> <span class="pre">'openmm_positions',</span> <span class="pre">'time',</span> <span class="pre">'timestep',</span> <span class="pre">'xyz',</span> <span class="pre">'unitcell_vectors',</span> <span class="pre">'unitcell_lengths',</span> <span class="pre">'unitcell_angles',</span> <span class="pre">'_check_valid_unitcell',</span> <span class="pre">'_distance_unit',</span> <span class="pre">'_have_unitcell',</span> <span class="pre">'_rmsd_traces',</span> <span class="pre">'_savers',</span> <span class="pre">'_string_summary_basic',</span> <span class="pre">'_time',</span> <span class="pre">'_time_default_to_arange',</span> <span class="pre">'_topology',</span> <span class="pre">'_unitcell_angles',</span> <span class="pre">'_unitcell_lengths',</span> <span class="pre">'_xyz']</span></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj._mdtraj_attr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj._n_frames_base_h5_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_n_frames_base_h5_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj._n_frames_base_h5_file" title="Link to this definition">#</a></dt>
<dd><p>Can be used to get n_frames without loading an HDF5 into memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj._original_frame_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_original_frame_indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj._original_frame_indices" title="Link to this definition">#</a></dt>
<dd><p>If trajectory has not been loaded, it is loaded and the
frames of the trajectory file on disk are put into a <cite>np.arange()</cite>. If
the trajectory is sliced in weird ways, this array tracks the original frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj._traj">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_traj</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj._traj" title="Link to this definition">#</a></dt>
<dd><p>Needs to be here to complete setter.
Not returning anything, because setter is also not returning anything.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.atom_slice">
<span class="sig-name descname"><span class="pre">atom_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.atom_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.atom_slice" title="Link to this definition">#</a></dt>
<dd><p>Deletes atoms from this <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>]</em>)  The indices of the
atoms to keep.</p></li>
<li><p><strong>invert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  If False, it is assumed, that the atoms in <code class="docutils literal notranslate"><span class="pre">atom_indices</span></code>
are the ones to be kept. If True, the atoms in <code class="docutils literal notranslate"><span class="pre">atom_indices</span></code>
are the ones to be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.basename">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basename</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.basename" title="Link to this definition">#</a></dt>
<dd><p>Basename is the filename without path and without extension. If <cite>basename_fn</cite> is not None, it will be
applied to <cite>traj_file</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.copy" title="Link to this definition">#</a></dt>
<dd><p>Returns a copy of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.dash_summary">
<span class="sig-name descname"><span class="pre">dash_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.dash_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.dash_summary" title="Link to this definition">#</a></dt>
<dd><p>Returns a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.0.dev0+2106.gb2b2d04e41)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with useful information about this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dataframe.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.del_CVs">
<span class="sig-name descname"><span class="pre">del_CVs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.del_CVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.del_CVs" title="Link to this definition">#</a></dt>
<dd><p>Resets the <code class="docutils literal notranslate"><span class="pre">_CVs</span></code> attribute to an empty <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.extension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.extension" title="Link to this definition">#</a></dt>
<dd><p>Extension is the file extension of the trajectory file (self.traj_file).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.featurizer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">featurizer</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.featurizer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.from_pdb_id">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pdb_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.from_pdb_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.from_pdb_id" title="Link to this definition">#</a></dt>
<dd><p>Alternate constructor for the TrajEnsemble class.</p>
<p>Builds an SingleTraj class from a pdb-id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)  The 4-letter pdb id.</p></li>
<li><p><strong>traj_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An SingleTraj class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj">SingleTraj</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.fsel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fsel</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.fsel" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.get_single_frame">
<span class="sig-name descname"><span class="pre">get_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.get_single_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.get_single_frame" title="Link to this definition">#</a></dt>
<dd><p>Returns a single frame from the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>np.int</em><em>]</em>)  Index of the frame.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Import EncoderMap and load <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">14</span>
</pre></div>
</div>
<p>Load the same traj and give it a <code class="docutils literal notranslate"><span class="pre">traj_num</span></code> for recognition in a
set of multiple trajectories.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">,</span> <span class="n">traj_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_single_frame</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">id</span>
<span class="go">array([[5, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.id" title="Link to this definition">#</a></dt>
<dd><p>id is an array of unique identifiers which identify the frames in
this SingleTraj object when multiple Trajectories are considered.</p>
<p>If the traj was initialized from an TrajEnsemble class, the traj gets a unique
identifier (traj_num) which will also be put into the id array, so that id
can have two shapes ((n_frames, ), (n_frames, 2)) This corresponds to
self.id.ndim = 1 and self.id.ndim = 2. In the latter case self.id[:,1] are the
frames and self.id[:,0] is an array full of traj_num.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_chi1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_chi1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi1" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_chi2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_chi2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi2" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_chi3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_chi3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi3" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_chi4">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_chi4</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi4" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_chi5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_chi5</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi5" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_omega">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_omega</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_omega" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_phi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_phi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_phi" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.indices_psi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices_psi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.indices_psi" title="Link to this definition">#</a></dt>
<dd><p>A numpy array with shape (n_dihedrals, 4) indexing the
atoms that take part in this dihedral angle. This index is 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.iterframes">
<span class="sig-name descname"><span class="pre">iterframes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_traj_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><span class="pre">SingleTraj</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.iterframes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.iterframes" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">iterframes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_traj_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><span class="pre">SingleTraj</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Iterator over the frames in this class.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>with_traj_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to return a three-tuple of traj_num,
frame_num, frame (True) or just traj_num, frame (False).</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple</em> </p>
<dl class="simple">
<dt>A tuple containing the following:</dt><dd><ul class="simple">
<li><p>int: The traj_num.</p></li>
<li><p>int: The frame_num.</p></li>
<li><p>encodermap.SingleTraj: An SingleTraj object.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Import EncoderMap and create <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a> instance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;https://files.rcsb.org/view/1YUG.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">15</span>
</pre></div>
</div>
<p>Slicing the trajectory every 5th frame</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">iterframes()</span></code> iterator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame_num</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframes</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">frame_num</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="go">0 1</span>
<span class="go">5 1</span>
<span class="go">10 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.join" title="Link to this definition">#</a></dt>
<dd><p>Join two trajectories together along the time/frame axis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">mdtraj.Trajectory</span></code> and thus loses CVs, filenames, etc.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em> | </em><em>Trajectory</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.load_CV">
<span class="sig-name descname"><span class="pre">load_CV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.load_CV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.load_CV" title="Link to this definition">#</a></dt>
<dd><p>Load CVs into traj. Many options are possible. Provide xarray,
numpy array, em.loading.feature, em.featurizer, and even string!</p>
<p>This method loads CVs into the SingleTraj instance. Many ways of doing so
are available:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>: The easiest way. Provide a np array and a name for</dt><dd><p>the array, and the data will be saved as an instance variable,
accesible via <cite>SingleTraj.name</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>: You can load a multidimensional xarray as</dt><dd><p>data into the class. Please refer to xarrays own documentation
if you want to create one yourself.</p>
</dd>
</dl>
</li>
<li><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>: You can add another dataset to the existing _CVs.</p></li>
<li><dl class="simple">
<dt><a class="reference internal" href="../user_guide/featurization.html#encodermap.loading.features.Feature" title="encodermap.loading.features.Feature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.loading.features.Feature</span></code></a>: If you provide one of the</dt><dd><p>features from <code class="docutils literal notranslate"><span class="pre">encodermap.loading.features</span></code> the resulting
features will be loaded and also be placed under the set name.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="../user_guide/featurization.html#encodermap.loading.featurizer.Featurizer" title="encodermap.loading.featurizer.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.loading.featurizer.Featurizer</span></code></a>: If you provide a</dt><dd><p>full featurizer, the data will be generated and be accessible
as an attribute.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>str: If a string is provided, the data will be loaded from a</dt><dd><p><code class="docutils literal notranslate"><span class="pre">.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">.npy</span></code>, or NetCDF / HDF5 <code class="docutils literal notranslate"><span class="pre">.nc</span></code> file.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Union</strong><strong>[</strong><strong>str</strong> (<em>data</em>)  em.loading.features.Feature, em.loading.featurizer.Featurizer]):
The CV to load. Either as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>,
<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>, EncoderMap feature,
or EncoderMap Featurizer.</p></li>
<li><p><strong>numpy.ndarray</strong>  em.loading.features.Feature, em.loading.featurizer.Featurizer]):
The CV to load. Either as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>,
<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>, EncoderMap feature,
or EncoderMap Featurizer.</p></li>
<li><p><strong>xr.DataArray</strong>  em.loading.features.Feature, em.loading.featurizer.Featurizer]):
The CV to load. Either as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>,
<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>, EncoderMap feature,
or EncoderMap Featurizer.</p></li>
<li><p><strong>data</strong> (<em>SingleTrajFeatureType</em>)</p></li>
<li><p><strong>attr_name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>cols</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>deg</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>labels</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>override</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">em.loading.features.Feature, em.loading.featurizer.Featurizer]):</span></dt><dd><p>The CV to load. Either as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>,
<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>, EncoderMap feature,
or EncoderMap Featurizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The name under which the CV
should be found in the class. Is needed, if a raw numpy array
is passed, otherwise the name will be generated from the filename
(if <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">==</span> <span class="pre">str</span></code>), the DataArray.name (if <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">==</span> <span class="pre">xarray.DataArray</span></code>),
or the feature name.</p></li>
<li><p><strong>cols</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>]</em>)  A list specifying the columns
to use it for the high-dimensional data. If your highD data contains
(x,y,z,)-errors or has an enumeration column at <code class="docutils literal notranslate"><span class="pre">col=0</span></code>
this can be used to remove this unwanted data.</p></li>
<li><p><strong>deg</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)  Whether the provided data is in radians (False)
or degree (True). It can also be None for non-angular data.</p></li>
<li><p><strong>labels</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)  If you want to label
the data you provided, pass a list of str. If set to None,
the features in this dimension will be labeled as
<code class="docutils literal notranslate"><span class="pre">[f&quot;{attr_name.upper()}</span> <span class="pre">FEATURE</span> <span class="pre">{i}&quot;</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(self.n_frames)]</span></code>.
If a str is provided, the features will be labeled as
<code class="docutils literal notranslate"><span class="pre">[f&quot;{attr_name.upper()}</span> <span class="pre">{label.upper()}</span> <span class="pre">{i}&quot;</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(self.n_frames)]</span></code>.
If a list of str is provided, it needs to have the same length
as the traj has frames. Defaults to None.</p></li>
<li><p><strong>override</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to overwrite existing CVs. The method will also
print a message which CVs have been overwritten.</p></li>
<li><p><strong>data</strong> (<em>SingleTrajFeatureType</em>)</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Import EncoderMap and load an example Trajectory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the central dihedrals using <a href="#id12"><span class="problematic" id="id13">``</span></a>data=central_dihedrals` as shortcut.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s2">&quot;central_dihedrals&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">central_dihedrals</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(14, 222)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="p">[</span><span class="s1">&#39;central_dihedrals&#39;</span><span class="p">][</span><span class="s1">&#39;CENTRAL_DIHEDRALS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[&#39;CENTERDIH PSI   RESID  MET:   1 CHAIN 0&#39;</span>
<span class="go"> &#39;CENTERDIH OMEGA RESID  MET:   1 CHAIN 0&#39;]</span>
</pre></div>
</div>
<p>Slicing the <a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleTraj</span></code></a> keeps all CVs in order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="n">em</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;tests/data/1am7_corrected.xtc&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="n">em</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;tests/data/1am7_protein.pdb&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">traj1</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;z_coordinate&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traj1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">z_coordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frame</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">break</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a>  When the file given by <cite>data</cite> does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a>  When the provided filename does not have .txt, .npy or .nc extension.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a>  When <cite>data</cite> does not match the specified input types.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a>  When a numpy array has been passed as <cite>data</cite> and no <cite>attr_name</cite> has been provided.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a>  When the provided <cite>attr_name</cite> is str, but cannot be a python identifier.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> (<em>SingleTrajFeatureType</em>)</p></li>
<li><p><strong>attr_name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>cols</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>deg</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>labels</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>override</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.load_custom_topology">
<span class="sig-name descname"><span class="pre">load_custom_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.load_custom_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.load_custom_topology" title="Link to this definition">#</a></dt>
<dd><p>Loads a custom_topology from a <cite>CustomTopology</cite> class or a dict.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="encodermap.trajinfo.trajinfo_utils.CustomTopology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.trajinfo_utils.CustomTopology</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>custom_top</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="encodermap.trajinfo.trajinfo_utils.CustomTopology"><em>CustomTopology</em></a><em>, </em><em>CustomAAsDict</em><em>]</em><em>]</em>)  Optional[Union[CustomTopology, CustomAAsDict]]: An
instance of <a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="encodermap.trajinfo.trajinfo_utils.CustomTopology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encodermap.trajinfo.trajinfo_utils.CustomTopology</span></code></a>
or a dictionary that can be made into such.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.load_traj">
<span class="sig-name descname"><span class="pre">load_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mdtraj'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.load_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.load_traj" title="Link to this definition">#</a></dt>
<dd><p>Loads the trajectory, with a new specified backend.</p>
<p>After this is called the instance variable self.trajectory
will contain a mdtraj Trajectory object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>)  <dl class="simple">
<dt>Can either be:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'mdtraj'</span></code> to load the trajectory using mdtraj.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'no_load'</span></code> to not load the traj (unload).</p></li>
</ul>
</dd>
</dl>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">'mdtraj'</span></code>.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.n_atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.n_atoms" title="Link to this definition">#</a></dt>
<dd><p>Number of atoms in traj.</p>
<p>Loads the traj into memory if not in HDF5 file format. Be aware.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.n_chains">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_chains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.n_chains" title="Link to this definition">#</a></dt>
<dd><p>Number of chains in traj.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.n_frames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_frames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.n_frames" title="Link to this definition">#</a></dt>
<dd><p>Number of frames in traj.</p>
<p>Loads the traj into memory if not in HDF5 file format. Be aware.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.n_residues">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_residues</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.n_residues" title="Link to this definition">#</a></dt>
<dd><p>Number of residues in traj.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.save" title="Link to this definition">#</a></dt>
<dd><p>Save the trajectory as HDF5 file format to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)  The filename.</p></li>
<li><p><strong>CVs</strong> (<em>Union</em><em>[</em><em>List</em><em>, </em><em>'all'</em><em>]</em><em>, </em><em>optional</em>)  Either provide a list of strings
of the CVs you would like to save to disk, or set to all to save
all CVs. Defaults to [].</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether force overwrite an existing file.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a>  When the file already exists and overwrite is False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.save_CV_as_numpy">
<span class="sig-name descname"><span class="pre">save_CV_as_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.save_CV_as_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.save_CV_as_numpy" title="Link to this definition">#</a></dt>
<dd><p>Saves a specified collective variable of this traj as a <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file.</p>
<p>This got its own method for parallelization purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)  Name of the CV to save.</p></li>
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>)  Can be either</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>opt</em>)  Whether to overwrite the file. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.13)"><strong>IOError</strong></a>  When the file already exists and overwrite is set to False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sel_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.select" title="Link to this definition">#</a></dt>
<dd><p>Execute a selection against the topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sel_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>)  What to select. Defaults to all.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://mdtraj.org/1.9.4/atom_selection.html">https://mdtraj.org/1.9.4/atom_selection.html</a></p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">select</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;name CA and resSeq 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">select</span>
<span class="go">array([1])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/view/1GHC.pdb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">select</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;name CA and resSeq 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="n">select</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">MET1-CA</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.show_traj">
<span class="sig-name descname"><span class="pre">show_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.show_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.show_traj" title="Link to this definition">#</a></dt>
<dd><p>Returns an nglview view object.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://nglviewer.org/nglview/latest/">https://nglviewer.org/nglview/latest/</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The nglview widget object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>view (nglview.widget)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gui</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.sidechain_info">
<span class="sig-name descname"><span class="pre">sidechain_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.sidechain_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.sidechain_info" title="Link to this definition">#</a></dt>
<dd><p>Indices used for the AngleDihedralCartesianEncoderMap class to
allow training with multiple different sidechains.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The indices. The key -1 is used for
the hypothetical convex hull of all feature spaces (the output of
the tensorflow model). The other keys match the common_str of the
trajs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Sequence[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><strong>Exception</strong></a>  When the common_strings and topologies are not
    aligned. An exception is raised. Aligned means that all trajs
    with the same common_str should possess the same topology.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.stack" title="Link to this definition">#</a></dt>
<dd><p>Stack two trajectories along the atom axis</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns a m``dtraj.Trajectory`` and thus loses CVs, filenames, etc.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.superpose">
<span class="sig-name descname"><span class="pre">superpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inherit_CVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.superpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.superpose" title="Link to this definition">#</a></dt>
<dd><p>Superpose each conformation in this trajectory upon a reference</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>Union</em><em>[</em><em>mdtraj.Trajectory</em><em>, </em><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em>]</em>)  The reference
frame to align to. If the reference has multiple frames and
you want to use a specific frame as reference, use the
<code class="docutils literal notranslate"><span class="pre">frame</span></code> argument also.</p></li>
<li><p><strong>frame</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>)  Align to this frame in reference.
Default is 0.</p></li>
<li><p><strong>atom_indices</strong> (<em>Union</em><em>[</em><em>np.array</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>)  Indices in
self, used to calculate RMS values. Defaults to None which
means all atoms will be used.</p></li>
<li><p><strong>ref_atom_indices</strong> (<em>Union</em><em>[</em><em>np.array</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>)  Indices
in reference, used to calculate RMS values. Defaults to None
which means all atoms will be used.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)  Use OpenMP to run the superposition
in parallel over multiple cores.</p></li>
<li><p><strong>inherit_CVs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to also inherit the CVs.
This feature is currently not implemented. It would require
additional code in all Feature classes discerning intrinsic
(distance, angle, cluster_membership, etc.) or an extrinsic
feature (absolute coordinate, COG position, etc.). Then this
extrinsic/intrinsic boolean flag also needs to accompany the
xarray Datasets, so that the intrinsic CVs can be inherited,
and the extrinsic can be dropped with a corresponding message.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new trajectory with atoms aligned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj">SingleTraj</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.top">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Topology</span></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.top" title="Link to this definition">#</a></dt>
<dd><p>The structure of a Topology object is similar to that of a PDB file.</p>
<p>It consists. of a set of Chains (often but not always corresponding to
polymer chains).  Each Chain contains a set of Residues, and each Residue
contains a set of Atoms.  In addition, the Topology stores a list of which
atom pairs are bonded to each other.
Atom and residue names should follow the PDB 3.0 nomenclature for all
molecules for which one exists</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.chains">
<span class="sig-name descname"><span class="pre">chains</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.chains" title="Link to this definition">#</a></dt>
<dd><p>Iterate over chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.residues">
<span class="sig-name descname"><span class="pre">residues</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.residues" title="Link to this definition">#</a></dt>
<dd><p>Iterate over residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.atoms" title="Link to this definition">#</a></dt>
<dd><p>Iterate over atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.bonds">
<span class="sig-name descname"><span class="pre">bonds</span></span><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.bonds" title="Link to this definition">#</a></dt>
<dd><p>Iterate over bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mdtraj.Topology</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id14">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id14" title="Link to this definition">#</a></dt>
<dd><p>The topology file as a string (rather than a <cite>pathlib.Path</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.traj">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traj</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Trajectory</span></em><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.traj" title="Link to this definition">#</a></dt>
<dd><p>This attribute always returns an mdtraj.Trajectory.
if <cite>backend</cite> is no_load, the trajectory will be loaded into memory and returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mdtraj.Trajectory</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id15">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traj_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id15" title="Link to this definition">#</a></dt>
<dd><p>The traj file as a string (rather than a <cite>pathlib.Path</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.info_single.SingleTraj.unload">
<span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/info_single.html#SingleTraj.unload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.info_single.SingleTraj.unload" title="Link to this definition">#</a></dt>
<dd><p>Clears up RAM by deleting the trajectory info and the CV data.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">CVs</span></code> is set to True the loaded CVs will also be deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>CVs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to also delete CVs, defaults to False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-encodermap.trajinfo.load_traj">
<span id="encodermap-trajinfo-load-traj-module"></span><h2>encodermap.trajinfo.load_traj module<a class="headerlink" href="#module-encodermap.trajinfo.load_traj" title="Link to this heading">#</a></h2>
<p>Util functions for the <cite>TrajEnsemble</cite> and <cite>SingleTraj</cite> classes.</p>
</section>
<section id="module-encodermap.trajinfo.trajinfo_utils">
<span id="encodermap-trajinfo-trajinfo-utils-module"></span><h2>encodermap.trajinfo.trajinfo_utils module<a class="headerlink" href="#module-encodermap.trajinfo.trajinfo_utils" title="Link to this heading">#</a></h2>
<p>Util functions for the <cite>TrajEnsemble</cite> and <cite>SingleTraj</cite> classes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CustomTopology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">new_residues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Adds custom topology elements to a topology parsed by MDTraj.</p>
<p>Postpones parsing the custom AAs until requested.</p>
<dl>
<dt>The custom_aminoacids dictionary follows these styleguides:</dt><dd><ul>
<li><p>The keys can be str or tuple[str, str]</p></li>
<li><p>If a key is str, it needs to be a 3-letter code (MET, ALA, GLY, )</p></li>
<li><dl>
<dt>If a key is a tuple[str, str], the first str of the tuple is a common_str</dt><dd><p>(see the docstring for <cite>encodermap.TrajEnsemble</cite> to learn about common_str.
This common_str can be used to apply custom topologies to an ensemble
based on their common_str. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{(</span><span class="s2">&quot;CSR_mutant&quot;</span><span class="p">,</span> <span class="s2">&quot;CSR&quot;</span><span class="p">):</span> <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>A key can also affect only a single residue (not all resides called CSR).</dt><dd><p>For that, the 3-letter code of the residue needs to be postponed with
a dash and the 1-based indexed resSeq of the residue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;CSR-2&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The value to a key can be None, which means this residue will not be</dt><dd><p>used for building a topology. Because EncoderMap raises Exceptions,
when it encounters unknown residues (to make sure, you dont forget to
featurize some important residues), it will also raise Exceptions when
the topology contains unknown solvents/solutes. If you run a simulation
in water/methanol mixtures with the residue names SOL and MOH, EncoderMap
will raise an Exception upon encountering MOH, so your custom topology
should contain 1{MOH: None}` to include MOH.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The value of a key can also be a tuple[str, Union[dict, None]]. In this</dt><dd><p>case, the first string should be the one-letter code of the residue or
the residue most closely representing this residue. If you use
phosphotyrosine (PTR) in your simulations and want to use it as a
standard tyrosine residue, the custom topology should contain
<cite>{PTR: (Y, None)}</cite></p>
</dd>
</dl>
</li>
<li><dl>
<dt>If your residue is completely novel you need to define all possible</dt><dd><p>bonds, backbone and sidechain dihedrals yourself. For that, you want
to provide a tuple[str, dict[str, Union[listr[str], list[int]]] type.
This second level dict allows for the following keys:
* bonds: For bonds between atoms. This key can contain a list[tuple[str, str]],</p>
<blockquote>
<div><p>which defines bonds in this residue. This dict defines a bond
between N and CA in phosphothreonine.
{PTR: (Y, {</p>
<blockquote>
<div><dl class="simple">
<dt>bonds: [</dt><dd><p>(N, CA),</p>
</dd>
</dl>
<p>],</p>
</div></blockquote>
<p>}}
These strings can cotain + and - signs to denote bonds to
previous or following residues. To connect the residues MET1 to
TPO2 to ALA3, you want to have this dict:
{TPO: (T, {</p>
<blockquote>
<div><dl class="simple">
<dt>bonds: [</dt><dd><p>(-C, N),  # bond to MET1-C
(N, CA),

(C, +N),  # bond to ALA2-N</p>
</dd>
</dl>
<p>],</p>
</div></blockquote>
<p>}}
For exotic bonds, one of the strings can also be int to
connect to any 0-based indexed atom in your topology. You can connect
the residues CYS2 and CYS20 wit a sulfide bride like so:
{CYS-2: (C, {</p>
<blockquote>
<div><dl class="simple">
<dt>bonds: [</dt><dd><p>(S, 321),  # connect to CYS20, the 321 is a placeholder</p>
</dd>
</dl>
<p>],
},</p>
</div></blockquote>
<dl>
<dt>CYS-20: (C, {</dt><dd><dl class="simple">
<dt>bonds: [</dt><dd><p>(20, S),  # connect to CYS2</p>
</dd>
</dl>
<p>],
},</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<ul>
<li><dl>
<dt>optional_bonds: This key accepts the same list[tuple] as bonds.</dt><dd><p>However, bonds will raise an Exception if a bond already exists.
The above example with a disulfide bridge between CYS2 and CYS20
will thus raise an exception. A better example is:
{CYS-2: (C, {</p>
<blockquote>
<div><dl class="simple">
<dt>optional_bonds: [</dt><dd><p>(S, 321),  # connect to CYS20, the 321 is a placeholder</p>
</dd>
</dl>
<p>],
},</p>
</div></blockquote>
<dl>
<dt>CYS-20: (C, {</dt><dd><dl class="simple">
<dt>optional_bonds: [</dt><dd><p>(20, S),  # connect to CYS2</p>
</dd>
</dl>
<p>],
},</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>delete_bonds: This key accepts the same list[tuple] as bonds,</dt><dd><p>but will remove bonds. If a bond was marked for deletion, but
does not exist in your topology, an Exception will be raised.
To delete bonds, without raising an Exception, use:</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>optional_delete_bonds: This will delete bonds, if they are present</dt><dd><p>and wont raise an Exception if no bond is present.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>PHI, PSI, OMEGA: These keys define the backbone torsions of this</dt><dd><p>residue. You can just provide a list[str] for these keys. But
the str can contain + and - to use atoms in previous or following
residues. Example:
{</p>
<blockquote>
<div><dl>
<dt>CYS-2: (</dt><dd><p>C,
{</p>
<blockquote>
<div><p>PHI: [-C, N, CA, C],
PSI: [N, CA, C, +N],
OMEGA: [CA, C, +N, +CA],</p>
</div></blockquote>
<p>},</p>
</dd>
</dl>
<p>),</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</li>
<li><dl>
<dt>not-PSI, not_OMEGA, not_PHI: Same as PHI, PSI, OMEGA, but</dt><dd><p>will remove these dihedrals from consideration. The vales of
these keys do not matter. Example:
{</p>
<blockquote>
<div><dl>
<dt>CYS-2: (</dt><dd><p>C,
{</p>
<blockquote>
<div><p>PHI: [-C, N, CA, C],
not_PSI: [],  # value for not_* keys does not matter
not_OMEGA: [],  # it just makes EncoderMap skip these dihedrals.</p>
</div></blockquote>
<p>},</p>
</dd>
</dl>
<p>),</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</li>
<li><dl>
<dt>CHI1, , CHI5: Finally, these keys define the atoms considered for</dt><dd><p>the sidechain angles. If you want to add extra sidechain dihedrals
for phosphothreonine, you can do:
{</p>
<blockquote>
<div><dl>
<dt>TPO: (</dt><dd><p>T,
{</p>
<blockquote>
<div><p>CHI2: [CA, CB, OG1, P],  # include phosphorus in sidechain angles
CHI3: [CB, OG1, P, OXT],  # include the terminal axygen in sidechain angles</p>
</div></blockquote>
<p>},</p>
</dd>
</dl>
<p>)</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Aminoacids taken from https://www.swisssidechain.ch/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The provided .pdb file has only strange and unnatural aminoacids.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Its sequence is:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TPO - PTR - ORN - OAS - 2AG - CSR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># TPO: phosphothreonine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># PTR: phosphotyrosine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ORN: ornithine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># OAS: o-acetylserine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2AG: 2-allyl-glycine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># CSR: selenocysteine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># However, someone mis-named the 2AG residue to ALL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s fix that with EncoderMap&#39;s CustomTopology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">em</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;tests/data/unnatural_aminoacids.pdb&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_aas</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;ALL&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>  <span class="c1"># makes EncoderMap treat 2-allyl-glycine as alanine</span>
<span class="gp">... </span>    <span class="s2">&quot;OAS&quot;</span><span class="p">:</span> <span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;S&quot;</span><span class="p">,</span>  <span class="c1"># OAS is 2-acetylserine</span>
<span class="gp">... </span>        <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;CHI2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;OG&quot;</span><span class="p">,</span> <span class="s2">&quot;CD&quot;</span><span class="p">],</span>  <span class="c1"># this is a non-standard chi2 angle</span>
<span class="gp">... </span>            <span class="s2">&quot;CHI3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;OG&quot;</span><span class="p">,</span> <span class="s2">&quot;CD&quot;</span><span class="p">,</span> <span class="s2">&quot;CE&quot;</span><span class="p">],</span>  <span class="c1"># this is a non-standard chi3 angle</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;CSR&quot;</span><span class="p">:</span> <span class="p">(</span>  <span class="c1"># CSR is selenocysteine</span>
<span class="gp">... </span>        <span class="s2">&quot;S&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;bonds&quot;</span><span class="p">:</span> <span class="p">[</span>   <span class="c1"># we can manually define bonds for selenocysteine like so:</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;-C&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">),</span>      <span class="c1"># bond between previous carbon and nitrogen CSR</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;CA&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;H1&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;HA&quot;</span><span class="p">),</span>     <span class="c1"># this topology includes hydrogens</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;OXT&quot;</span><span class="p">),</span>     <span class="c1"># As the C-terminal residue, we don&#39;t need to put (&quot;C&quot;, &quot;+N&quot;) here</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;HB1&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;HB2&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;SE&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="p">(</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span> <span class="s2">&quot;HE&quot;</span><span class="p">),</span>
<span class="gp">... </span>            <span class="p">],</span>
<span class="gp">... </span>            <span class="s2">&quot;CHI1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;SE&quot;</span><span class="p">],</span>  <span class="c1"># this is a non-standard chi1 angle</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;TPO&quot;</span><span class="p">:</span> <span class="p">(</span>  <span class="c1"># TPO is phosphothreonine</span>
<span class="gp">... </span>        <span class="s2">&quot;T&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;CHI2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;OG1&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">],</span>  <span class="c1"># a non-standard chi2 angle</span>
<span class="gp">... </span>            <span class="s2">&quot;CHI3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;OG1&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;OXT&quot;</span><span class="p">],</span>  <span class="c1"># a non-standard chi3 angle</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># loading this will raise an Exception, because the bonds in CSR already exist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load_custom_topology</span><span class="p">(</span><span class="n">custom_aas</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">Exception</span>: <span class="n">Bond between ALL5-C and CSR6-N already exists. Consider using the key &#39;optional_bonds&#39; to not raise an Exception on already existing bonds.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If we rename the &quot;bonds&quot; section in &quot;CSR&quot; to &quot;optional_bonds&quot; it will work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_aas</span><span class="p">[</span><span class="s2">&quot;CSR&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;optional_bonds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">custom_aas</span><span class="p">[</span><span class="s2">&quot;CSR&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bonds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load_custom_topology</span><span class="p">(</span><span class="n">custom_aas</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sidechains</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">SideChainDihedrals</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;SIDECHDIH CHI2  RESID  OAS:   4 CHAIN 0&quot;</span> <span class="ow">in</span> <span class="n">sidechains</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;SIDECHDIH CHI3  RESID  OAS:   4 CHAIN 0&quot;</span> <span class="ow">in</span> <span class="n">sidechains</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;SIDECHDIH CHI1  RESID  CSR:   6 CHAIN 0&quot;</span> <span class="ow">in</span> <span class="n">sidechains</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;SIDECHDIH CHI2  RESID  TPO:   1 CHAIN 0&quot;</span> <span class="ow">in</span> <span class="n">sidechains</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;SIDECHDIH CHI3  RESID  TPO:   1 CHAIN 0&quot;</span> <span class="ow">in</span> <span class="n">sidechains</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_residues</strong> (<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.NewResidue" title="encodermap.trajinfo.trajinfo_utils.NewResidue"><em>NewResidue</em></a>)</p></li>
<li><p><strong>traj</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.add_amino_acid_codes">
<span class="sig-name descname"><span class="pre">add_amino_acid_codes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.add_amino_acid_codes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_amino_acid_codes" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.add_bonds">
<span class="sig-name descname"><span class="pre">add_bonds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.add_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_bonds" title="Link to this definition">#</a></dt>
<dd><p>Adds and deletes bonds specified in the custom topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new topology.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>md.Topology</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.add_new_residue">
<span class="sig-name descname"><span class="pre">add_new_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_residue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.add_new_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_new_residue" title="Link to this definition">#</a></dt>
<dd><p>Adds an instance of <cite>NewResidue</cite> to the reisdues of this <cite>CustomTopology</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_residue</strong> (<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.NewResidue" title="encodermap.trajinfo.trajinfo_utils.NewResidue"><em>NewResidue</em></a>)  An instance of <cite>NewResidue</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.atom_sequence">
<span class="sig-name descname"><span class="pre">atom_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.atom_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.atom_sequence" title="Link to this definition">#</a></dt>
<dd><p>Returns either backbone or sidechain indices in a useful order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> (<em>Literal</em><em>[</em><em>&quot;OMEGA&quot;</em><em>, </em><em>&quot;PHI&quot;</em><em>, </em><em>&quot;PSI&quot;</em><em>, </em><em>&quot;CHI1&quot;</em><em>, </em><em>&quot;CHI2&quot;</em><em>, </em><em>&quot;CHI3&quot;</em><em>, </em><em>&quot;CHI4&quot;</em><em>, </em><em>&quot;CHI5&quot;</em><em>]</em>)  The angle, that is looked for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing two numpy arrays:</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.backbone_sequence">
<span class="sig-name descname"><span class="pre">backbone_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.backbone_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.backbone_sequence" title="Link to this definition">#</a></dt>
<dd><p>Searches for a sequence along the backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The names of the atoms. Can use +/- to
mark atoms in previous or following residue.</p></li>
<li><p><strong>type</strong> (<em>Literal</em><em>[</em><em>&quot;PHI&quot;</em><em>, </em><em>&quot;PSI&quot;</em><em>, </em><em>&quot;OMEGA&quot;</em><em>]</em>)  The type of the dihedral
sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The integer indices of the requested atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.combine_chains">
<span class="sig-name descname"><span class="pre">combine_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_id1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_id2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.combine_chains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.combine_chains" title="Link to this definition">#</a></dt>
<dd><p>Function to combine two chains into one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_id1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  The 0-based index of chain 1.</p></li>
<li><p><strong>chain_id2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)  The 0-based index of chain 2.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_aas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_dict" title="Link to this definition">#</a></dt>
<dd><p>Instantiate the class from a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>custom_aas</strong> (<em>CustomAAsDict</em>)  <p>Custom AAs defined by a dict with the following properties:
The keys are the residue names encountered in this traj. The
values to the keys can be one of three types:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt>None: if a key: None pair is supplied, this just adds the</dt><dd><p>residue to the recognized residues. Nothing will be done
with it.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>str: If a key: str pair is supplied, it is expected that the</dt><dd><p>string matches one of the one-letter amino-acid codes.
If your new residue is based on Lysine and you named it
LYQ, you need to supply: {LYQ: K}</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tuple[str, dict]: If your residue has nonstandard side-chain</dt><dd><p>angles (i.e. due to phosphorylation), you can supply a tuple
of the one-letter amino-acid code and a dict which defines
the sidechain angles like so:
{THR: (T, {CHI2: [CA, CB, CG, P]})}
In this example, the standard amino acid threonine was
phosphorylated. The chi2 angle was added.
If you want to add custom bonds you can add the bond key
to the dict and give it either atom names or atom indices of
other atoms like so:
{LYQ: (K, {bonds: [(N, CA), (N, H), ], CHI1: [N, CA, CB, CG]}).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tuple[str, str, dict]: In this case, the first string should</dt><dd><p>be the name of the amino-acid, the second string should
be a common_str, that is in <cite>self.common_str</cite>. That way,
the different topologies in this <cite>TrajEnsemble</cite> can dynamically
use different custom_aas.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.from_hdf5_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_hdf5_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.from_hdf5_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_hdf5_file" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_json" title="Link to this definition">#</a></dt>
<dd><p>The same as <cite>from_dict</cite>, but using a json str.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>json_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.from_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.from_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_yaml" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.get_single_residue_atom_ids">
<span class="sig-name descname"><span class="pre">get_single_residue_atom_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_error_ok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.get_single_residue_atom_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.get_single_residue_atom_ids" title="Link to this definition">#</a></dt>
<dd><p>Gives the 0-based atom ids of a single residue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The names of the atoms. ie. [N ,CA, C, +N]</p></li>
<li><p><strong>r</strong> (<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.NewResidue" title="encodermap.trajinfo.trajinfo_utils.NewResidue"><em>NewResidue</em></a>)  An instance of <cite>NewResidue</cite>.</p></li>
<li><p><strong>key_error_ok</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether a key error when querying <cite>self._atom_dict</cite>
raises an error or returns an empty np.ndarray.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An integer array with the ids of the requested atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi1">
<span class="sig-name descname"><span class="pre">indices_chi1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_chi1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi1" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi2">
<span class="sig-name descname"><span class="pre">indices_chi2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi2" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi3">
<span class="sig-name descname"><span class="pre">indices_chi3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_chi3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi3" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi4">
<span class="sig-name descname"><span class="pre">indices_chi4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_chi4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi4" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi5">
<span class="sig-name descname"><span class="pre">indices_chi5</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_chi5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi5" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_omega">
<span class="sig-name descname"><span class="pre">indices_omega</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_omega"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_omega" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_phi">
<span class="sig-name descname"><span class="pre">indices_phi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_phi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_phi" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_psi">
<span class="sig-name descname"><span class="pre">indices_psi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.indices_psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_psi" title="Link to this definition">#</a></dt>
<dd><p>Returns the requested indices as a (n_dihedrals, 4)-shaped numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.new_residues">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">new_residues</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.NewResidue" title="encodermap.trajinfo.trajinfo_utils.NewResidue"><span class="pre">NewResidue</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.new_residues" title="Link to this definition">#</a></dt>
<dd><p>A list of all new residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="trajinfo.html#encodermap.trajinfo.trajinfo_utils.NewResidue" title="encodermap.trajinfo.trajinfo_utils.NewResidue">NewResidue</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_indices_by_residue">
<span class="sig-name descname"><span class="pre">sidechain_indices_by_residue</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.sidechain_indices_by_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_indices_by_residue" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.13)"><em>Generator</em></a>[<em>Residue</em>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_sequence">
<span class="sig-name descname"><span class="pre">sidechain_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.sidechain_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_sequence" title="Link to this definition">#</a></dt>
<dd><p>Searches for a sequence along the sidechains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The names of the atoms. Can use +/- to
mark atoms in previous or following residue.</p></li>
<li><p><strong>(</strong><strong>Literal</strong><strong>[</strong><strong>&quot;CHI1&quot;</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a>)  The type of the dihedral
sequence.</p></li>
<li><p><strong>&quot;CHI2&quot;</strong>  The type of the dihedral
sequence.</p></li>
<li><p><strong>&quot;CHI3&quot;</strong>  The type of the dihedral
sequence.</p></li>
<li><p><strong>&quot;CHI4&quot;</strong>  The type of the dihedral
sequence.</p></li>
<li><p><strong>&quot;CHI5&quot;</strong><strong>]</strong>  The type of the dihedral
sequence.</p></li>
<li><p><strong>top</strong> (<em>Optional</em><em>[</em><em>md.Topology</em><em>]</em>)  Can be used to overwrite the toplogy in
self.traj.</p></li>
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'CHI1'</em><em>, </em><em>'CHI2'</em><em>, </em><em>'CHI3'</em><em>, </em><em>'CHI4'</em><em>, </em><em>'CHI5'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The integer indices of the requested atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_dict" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>], None | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, None] | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a>[bonds, optional_bonds, delete_bonds, optional_delete_bonds, PHI, PSI, OMEGA, not_PHI, not_PSI, not_OMEGA, CHI1, CHI2, CHI3, CHI4, CHI5], list[str] | list[tuple[str | int, str | int]]]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.to_hdf_file">
<span class="sig-name descname"><span class="pre">to_hdf_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.to_hdf_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_hdf_file" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_json" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.to_yaml">
<span class="sig-name descname"><span class="pre">to_yaml</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#CustomTopology.to_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_yaml" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.CustomTopology.top">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Topology</span></em><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.top" title="Link to this definition">#</a></dt>
<dd><p>The fixed topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>md.Topology</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.load_CVs_ensembletraj">
<span class="sig-name descname"><span class="pre">load_CVs_ensembletraj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#load_CVs_ensembletraj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.load_CVs_ensembletraj" title="Link to this definition">#</a></dt>
<dd><p>Loads CVs for a trajectory ensemble.</p>
<dl class="simple">
<dt>CVs can be loaded from a multitude of sources. The argument <cite>data</cite> can be:</dt><dd><ul class="simple">
<li><p>np.ndarray: Use a numpy array as a feature.</p></li>
<li><dl class="simple">
<dt>str | Path: You can point to .txt or .npy files and load the features</dt><dd><p>from these files. In this case, the <cite>cols</cite> argument can be
used to only use a subset of columns in these files.
You can also point to a single directory in which case the basename
of the trajectories will be used to look for .npy and .txt files.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>str: Some strings like central_dihedrals are recognized out-of-the-box.</dt><dd><p>You can also provide all to load all dihedrals used in an
<cite>encodermap.AngleDihedralCartesianEncoderMap</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Feature: You can provide an <cite>encodermap.loading.features</cite> Feature. The</dt><dd><p>CVs will be loaded by creating a featurizer, adding this feature, and
obtaining the output.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Featurizer: You can also directly provide a featurizer with multiple</dt><dd><p>features.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>xr.DataArray: You can also provide a xarray.DataArray, which will be</dt><dd><p>appended to the existing CVs.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>xr.Dataset: If you provide a xarray.Dataset, you will overwrite all</dt><dd><p>currently loaded CVs.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<a class="reference internal" href="../user_guide/trajensemble.html#encodermap.trajinfo.info_all.TrajEnsemble" title="encodermap.trajinfo.info_all.TrajEnsemble"><em>TrajEnsemble</em></a>)  The trajectory ensemble to load the data for.</p></li>
<li><p><strong>data</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>np.ndarray</em><em>, </em><em>'all'</em><em>, </em><em>xr.Dataset</em><em>]</em>)  The CV to
load. When a numpy array is provided, it needs to have a shape
matching <cite>n_frames</cite>. The data is distributed to the trajs.
When a list of files is provided, <cite>len(data)</cite> needs to match
<cite>n_trajs</cite>. The first file will be loaded by the first traj
(based on the trajs <cite>traj_num</cite>) and so on. If a list of
<cite>np.ndarray</cite> is provided, the first array will be assigned to
the first traj (based on the trajs <cite>traj_num</cite>). If None is provided,
the argument <cite>directory</cite> will be used to construct a str like:
fname = directory + traj.basename + _ + attr_name. If there are
.txt or .npy files matching that string in the <cite>directory</cite>,
the CVs will be loaded from these files to the corresponding
trajs. Defaults to None.</p></li>
<li><p><strong>attr_name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  The name under which the CV should
be found in the class. Choose whatever you like. <cite>highd</cite>, <cite>lowd</cite>,
<cite>dists</cite>, etc. The CV can then be accessed via dot-notation:
<cite>trajs.attr_name</cite>. Defaults to None, in which case, the argument
<cite>data</cite> should point to existing files and the <cite>attr_name</cite> will
be extracted from these files.</p></li>
<li><p><strong>cols</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)  <p>A list of integers indexing the columns
of the data to be loaded. This is useful if a file contains
columns which are not features (i.e. an indexer or the error of
the features. eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span>   <span class="n">f1</span>    <span class="n">f2</span>    <span class="n">f1_err</span>    <span class="n">f2_err</span>
<span class="mi">0</span>    <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">0.1</span>       <span class="mf">0.1</span>
<span class="mi">1</span>    <span class="mf">2.5</span>   <span class="mf">1.2</span>   <span class="mf">0.11</span>      <span class="mf">0.52</span>
</pre></div>
</div>
<p>In that case, you would want to supply <cite>cols=[1, 2]</cite> to the <cite>cols</cite>
argument. If None all columns are loaded. Defaults to None.</p>
</p></li>
<li><p><strong>deg</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)  Whether to return angular CVs using degrees.
If None or False, CVs will be in radian. Defaults to None.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>)  A list containing the labels for the dimensions of
the data. If you provide a <cite>np.ndarray</cite> with shape (n_trajs,
n_frames, n_feat), this list needs to be of len(n_feat)
Defaults to None.</p></li>
<li><p><strong>directory</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)  If this argument is provided, the
directory will be searched for <code class="docutils literal notranslate"><span class="pre">.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">.npy</span></code> files which
have the same names as the trajectories have basenames. The
CVs will then be loaded from these files.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether the trajs in this class belong to an ensemble.
This implies that they contain either the same topology or are
very similar (think wt, and mutant). Setting this option True will
try to match the CVs of the trajs onto the same dataset.
If a VAL residue has been replaced by LYS in the mutant,
the number of sidechain dihedrals will increase. The CVs of the
trajs with VAL will thus contain some NaN values. Defaults to False.</p></li>
<li><p><strong>override</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)  Whether to override CVs with the same name as <cite>attr_name</cite>.</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.trajinfo.trajinfo_utils.load_CVs_singletraj">
<span class="sig-name descname"><span class="pre">load_CVs_singletraj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/encodermap/trajinfo/trajinfo_utils.html#load_CVs_singletraj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.trajinfo.trajinfo_utils.load_CVs_singletraj" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em> | </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em> | </em><a class="reference internal" href="../user_guide/featurization.html#encodermap.loading.features.Feature" title="encodermap.loading.features.Feature"><em>Feature</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.4.1.dev0)"><em>DataArray</em></a><em> | </em><em>SingleTrajFeaturizer</em><em> | </em><a class="reference internal" href="encodermap.loading.html#encodermap.loading.featurizer.DaskFeaturizer" title="encodermap.loading.featurizer.DaskFeaturizer"><em>DaskFeaturizer</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'all'</em><em>] </em><em>| </em><em>~typing.Literal</em><em>[</em><em>'full'</em><em>] </em><em>| </em><em>~encodermap.loading.features.AllCartesians</em><em> | </em><em>~encodermap.loading.features.AllBondDistances</em><em> | </em><em>~encodermap.loading.features.CentralCartesians</em><em> | </em><em>~encodermap.loading.features.CentralBondDistances</em><em> | </em><em>~encodermap.loading.features.CentralAngles</em><em> | </em><em>~encodermap.loading.features.CentralDihedrals</em><em> | </em><em>~encodermap.loading.features.SideChainCartesians</em><em> | </em><em>~encodermap.loading.features.SideChainBondDistances</em><em> | </em><em>~encodermap.loading.features.SideChainAngles</em><em> | </em><em>~encodermap.loading.features.SideChainDihedrals</em><em> | </em><em>~encodermap.loading.features.CustomFeature</em><em> | </em><em>~encodermap.loading.features.SelectionFeature</em><em> | </em><em>~encodermap.loading.features.AngleFeature</em><em> | </em><em>~encodermap.loading.features.DihedralFeature</em><em> | </em><em>~encodermap.loading.features.DistanceFeature</em><em> | </em><em>~encodermap.loading.features.AlignFeature</em><em> | </em><em>~encodermap.loading.features.InverseDistanceFeature</em><em> | </em><em>~encodermap.loading.features.ContactFeature</em><em> | </em><em>~encodermap.loading.features.BackboneTorsionFeature</em><em> | </em><em>~encodermap.loading.features.ResidueMinDistanceFeature</em><em> | </em><em>~encodermap.loading.features.GroupCOMFeature</em><em> | </em><em>~encodermap.loading.features.ResidueCOMFeature</em><em> | </em><em>~encodermap.loading.features.SideChainTorsions</em><em> | </em><em>~encodermap.loading.features.MinRmsdFeature</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="../user_guide/singletraj.html#encodermap.trajinfo.info_single.SingleTraj" title="encodermap.trajinfo.info_single.SingleTraj"><em>SingleTraj</em></a>)</p></li>
<li><p><strong>attr_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.4.1.dev0)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-encodermap.trajinfo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-encodermap.trajinfo" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="encodermap.plot.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">encodermap.plot package</p>
      </div>
    </a>
    <a class="right-next"
       href="../contributing/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contributing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-encodermap.trajinfo.info_all">encodermap.trajinfo.info_all module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble"><code class="docutils literal notranslate"><span class="pre">TrajEnsemble</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.CVs"><code class="docutils literal notranslate"><span class="pre">CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble._CVs"><code class="docutils literal notranslate"><span class="pre">_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_trajs"><code class="docutils literal notranslate"><span class="pre">n_trajs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_frames"><code class="docutils literal notranslate"><span class="pre">n_frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.locations"><code class="docutils literal notranslate"><span class="pre">locations</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.top"><code class="docutils literal notranslate"><span class="pre">top</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.basenames"><code class="docutils literal notranslate"><span class="pre">basenames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.name_arr"><code class="docutils literal notranslate"><span class="pre">name_arr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.CVs_in_file"><code class="docutils literal notranslate"><span class="pre">CVs_in_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">basenames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.batch_iterator"><code class="docutils literal notranslate"><span class="pre">batch_iterator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.cluster"><code class="docutils literal notranslate"><span class="pre">cluster</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.copy"><code class="docutils literal notranslate"><span class="pre">copy</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.dash_summary"><code class="docutils literal notranslate"><span class="pre">dash_summary</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.del_CVs"><code class="docutils literal notranslate"><span class="pre">del_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.del_featurizer"><code class="docutils literal notranslate"><span class="pre">del_featurizer</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.featurizer"><code class="docutils literal notranslate"><span class="pre">featurizer</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.frames"><code class="docutils literal notranslate"><span class="pre">frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.from_dataset"><code class="docutils literal notranslate"><span class="pre">from_dataset</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.from_textfile"><code class="docutils literal notranslate"><span class="pre">from_textfile</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.get_single_frame"><code class="docutils literal notranslate"><span class="pre">get_single_frame</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.id"><code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.index_arr"><code class="docutils literal notranslate"><span class="pre">index_arr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.iterframes"><code class="docutils literal notranslate"><span class="pre">iterframes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.itertrajs"><code class="docutils literal notranslate"><span class="pre">itertrajs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.join"><code class="docutils literal notranslate"><span class="pre">join</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_CVs"><code class="docutils literal notranslate"><span class="pre">load_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_custom_topology"><code class="docutils literal notranslate"><span class="pre">load_custom_topology</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.load_trajs"><code class="docutils literal notranslate"><span class="pre">load_trajs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">locations</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">n_frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.n_residues"><code class="docutils literal notranslate"><span class="pre">n_residues</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">n_trajs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">name_arr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.parse_clustal_w_alignment"><code class="docutils literal notranslate"><span class="pre">parse_clustal_w_alignment</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.save"><code class="docutils literal notranslate"><span class="pre">save</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.save_CVs"><code class="docutils literal notranslate"><span class="pre">save_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.sidechain_info"><code class="docutils literal notranslate"><span class="pre">sidechain_info</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.split_into_frames"><code class="docutils literal notranslate"><span class="pre">split_into_frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.stack"><code class="docutils literal notranslate"><span class="pre">stack</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.subsample"><code class="docutils literal notranslate"><span class="pre">subsample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.tf_dataset"><code class="docutils literal notranslate"><span class="pre">tf_dataset</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.to_alignment_query"><code class="docutils literal notranslate"><span class="pre">to_alignment_query</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.to_dataframe"><code class="docutils literal notranslate"><span class="pre">to_dataframe</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">top</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.top_files"><code class="docutils literal notranslate"><span class="pre">top_files</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_files"><code class="docutils literal notranslate"><span class="pre">traj_files</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_joined"><code class="docutils literal notranslate"><span class="pre">traj_joined</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.traj_nums"><code class="docutils literal notranslate"><span class="pre">traj_nums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_common_str"><code class="docutils literal notranslate"><span class="pre">trajs_by_common_str</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_top"><code class="docutils literal notranslate"><span class="pre">trajs_by_top</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.trajs_by_traj_num"><code class="docutils literal notranslate"><span class="pre">trajs_by_traj_num</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.tsel"><code class="docutils literal notranslate"><span class="pre">tsel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.unload"><code class="docutils literal notranslate"><span class="pre">unload</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.with_overwrite_trajnums"><code class="docutils literal notranslate"><span class="pre">with_overwrite_trajnums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_all.TrajEnsemble.xyz"><code class="docutils literal notranslate"><span class="pre">xyz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-encodermap.trajinfo.info_single">encodermap.trajinfo.info_single module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj"><code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.backend"><code class="docutils literal notranslate"><span class="pre">backend</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.common_str"><code class="docutils literal notranslate"><span class="pre">common_str</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.index"><code class="docutils literal notranslate"><span class="pre">index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.traj_num"><code class="docutils literal notranslate"><span class="pre">traj_num</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.traj_file"><code class="docutils literal notranslate"><span class="pre">traj_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.top_file"><code class="docutils literal notranslate"><span class="pre">top_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.CVs"><code class="docutils literal notranslate"><span class="pre">CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.CVs_in_file"><code class="docutils literal notranslate"><span class="pre">CVs_in_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj._frames"><code class="docutils literal notranslate"><span class="pre">_frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj._mdtraj_attr"><code class="docutils literal notranslate"><span class="pre">_mdtraj_attr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj._n_frames_base_h5_file"><code class="docutils literal notranslate"><span class="pre">_n_frames_base_h5_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj._original_frame_indices"><code class="docutils literal notranslate"><span class="pre">_original_frame_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj._traj"><code class="docutils literal notranslate"><span class="pre">_traj</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.atom_slice"><code class="docutils literal notranslate"><span class="pre">atom_slice</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.basename"><code class="docutils literal notranslate"><span class="pre">basename</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.copy"><code class="docutils literal notranslate"><span class="pre">copy</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.dash_summary"><code class="docutils literal notranslate"><span class="pre">dash_summary</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.del_CVs"><code class="docutils literal notranslate"><span class="pre">del_CVs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.extension"><code class="docutils literal notranslate"><span class="pre">extension</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.featurizer"><code class="docutils literal notranslate"><span class="pre">featurizer</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.from_pdb_id"><code class="docutils literal notranslate"><span class="pre">from_pdb_id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.fsel"><code class="docutils literal notranslate"><span class="pre">fsel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.get_single_frame"><code class="docutils literal notranslate"><span class="pre">get_single_frame</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.id"><code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi1"><code class="docutils literal notranslate"><span class="pre">indices_chi1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi2"><code class="docutils literal notranslate"><span class="pre">indices_chi2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi3"><code class="docutils literal notranslate"><span class="pre">indices_chi3</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi4"><code class="docutils literal notranslate"><span class="pre">indices_chi4</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_chi5"><code class="docutils literal notranslate"><span class="pre">indices_chi5</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_omega"><code class="docutils literal notranslate"><span class="pre">indices_omega</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_phi"><code class="docutils literal notranslate"><span class="pre">indices_phi</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.indices_psi"><code class="docutils literal notranslate"><span class="pre">indices_psi</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.iterframes"><code class="docutils literal notranslate"><span class="pre">iterframes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.join"><code class="docutils literal notranslate"><span class="pre">join</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.load_CV"><code class="docutils literal notranslate"><span class="pre">load_CV</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.load_custom_topology"><code class="docutils literal notranslate"><span class="pre">load_custom_topology</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.load_traj"><code class="docutils literal notranslate"><span class="pre">load_traj</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.n_atoms"><code class="docutils literal notranslate"><span class="pre">n_atoms</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.n_chains"><code class="docutils literal notranslate"><span class="pre">n_chains</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.n_frames"><code class="docutils literal notranslate"><span class="pre">n_frames</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.n_residues"><code class="docutils literal notranslate"><span class="pre">n_residues</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.save"><code class="docutils literal notranslate"><span class="pre">save</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.save_CV_as_numpy"><code class="docutils literal notranslate"><span class="pre">save_CV_as_numpy</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.select"><code class="docutils literal notranslate"><span class="pre">select</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.show_traj"><code class="docutils literal notranslate"><span class="pre">show_traj</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.sidechain_info"><code class="docutils literal notranslate"><span class="pre">sidechain_info</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.stack"><code class="docutils literal notranslate"><span class="pre">stack</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.superpose"><code class="docutils literal notranslate"><span class="pre">superpose</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.top"><code class="docutils literal notranslate"><span class="pre">top</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.chains"><code class="docutils literal notranslate"><span class="pre">chains</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.residues"><code class="docutils literal notranslate"><span class="pre">residues</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.atoms"><code class="docutils literal notranslate"><span class="pre">atoms</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.bonds"><code class="docutils literal notranslate"><span class="pre">bonds</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><code class="docutils literal notranslate"><span class="pre">top_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.traj"><code class="docutils literal notranslate"><span class="pre">traj</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">traj_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.info_single.SingleTraj.unload"><code class="docutils literal notranslate"><span class="pre">unload</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-encodermap.trajinfo.load_traj">encodermap.trajinfo.load_traj module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-encodermap.trajinfo.trajinfo_utils">encodermap.trajinfo.trajinfo_utils module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology"><code class="docutils literal notranslate"><span class="pre">CustomTopology</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_amino_acid_codes"><code class="docutils literal notranslate"><span class="pre">add_amino_acid_codes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_bonds"><code class="docutils literal notranslate"><span class="pre">add_bonds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.add_new_residue"><code class="docutils literal notranslate"><span class="pre">add_new_residue</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.atom_sequence"><code class="docutils literal notranslate"><span class="pre">atom_sequence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.backbone_sequence"><code class="docutils literal notranslate"><span class="pre">backbone_sequence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.combine_chains"><code class="docutils literal notranslate"><span class="pre">combine_chains</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_dict"><code class="docutils literal notranslate"><span class="pre">from_dict</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_hdf5_file"><code class="docutils literal notranslate"><span class="pre">from_hdf5_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_json"><code class="docutils literal notranslate"><span class="pre">from_json</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.from_yaml"><code class="docutils literal notranslate"><span class="pre">from_yaml</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.get_single_residue_atom_ids"><code class="docutils literal notranslate"><span class="pre">get_single_residue_atom_ids</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi1"><code class="docutils literal notranslate"><span class="pre">indices_chi1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi2"><code class="docutils literal notranslate"><span class="pre">indices_chi2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi3"><code class="docutils literal notranslate"><span class="pre">indices_chi3</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi4"><code class="docutils literal notranslate"><span class="pre">indices_chi4</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_chi5"><code class="docutils literal notranslate"><span class="pre">indices_chi5</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_omega"><code class="docutils literal notranslate"><span class="pre">indices_omega</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_phi"><code class="docutils literal notranslate"><span class="pre">indices_phi</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.indices_psi"><code class="docutils literal notranslate"><span class="pre">indices_psi</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.new_residues"><code class="docutils literal notranslate"><span class="pre">new_residues</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_indices_by_residue"><code class="docutils literal notranslate"><span class="pre">sidechain_indices_by_residue</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.sidechain_sequence"><code class="docutils literal notranslate"><span class="pre">sidechain_sequence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_dict"><code class="docutils literal notranslate"><span class="pre">to_dict</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_hdf_file"><code class="docutils literal notranslate"><span class="pre">to_hdf_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_json"><code class="docutils literal notranslate"><span class="pre">to_json</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.to_yaml"><code class="docutils literal notranslate"><span class="pre">to_yaml</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.CustomTopology.top"><code class="docutils literal notranslate"><span class="pre">top</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.load_CVs_ensembletraj"><code class="docutils literal notranslate"><span class="pre">load_CVs_ensembletraj</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encodermap.trajinfo.trajinfo_utils.load_CVs_singletraj"><code class="docutils literal notranslate"><span class="pre">load_CVs_singletraj</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-encodermap.trajinfo">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/encodermap.trajinfo.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2024, Kevin Sawade, Tobias Lemke, University of Konstanz.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on 2025-05-15T22:43:00.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">Docs for EncoderMap 3.0.1+10.g67ae638.dirty</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>