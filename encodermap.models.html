
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>encodermap.models package &#8212; encodermap 3.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'encodermap.models';</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
    <img src="_static/logo_cube_300.png" class="logo__image only-light" alt="Logo image">
    <img src="_static/logo_cube_300.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started/index.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide_and_examples/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="whatsnew/index.html">
                        Changelog
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started/index.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide_and_examples/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="whatsnew/index.html">
                        Changelog
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="encodermap.autoencoder.html">encodermap.autoencoder package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.callbacks.html">encodermap.callbacks package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.data.html">encodermap.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.encodermap_tf1.html">encodermap.encodermap_tf1 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.loading.html">encodermap.loading package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.loss_functions.html">encodermap.loss_functions package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.misc.html">encodermap.misc package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">encodermap.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.moldata.html">encodermap.moldata package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.parameters.html">encodermap.parameters package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.plot.html">encodermap.plot package</a></li>
<li class="toctree-l1"><a class="reference internal" href="encodermap.trajinfo.html">encodermap.trajinfo package</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="encodermap-models-package">
<h1>encodermap.models package<a class="headerlink" href="#encodermap-models-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-encodermap.models.layers">
<span id="encodermap-models-layers-module"></span><h2>encodermap.models.layers module<a class="headerlink" href="#module-encodermap.models.layers" title="Permalink to this heading">#</a></h2>
<p>Module that implements custom layers. Mainly needed for handling periodicity,
backmapping or sparsity.</p>
<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.layers.BackMapLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encodermap.models.layers.</span></span><span class="sig-name descname"><span class="pre">BackMapLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#BackMapLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.BackMapLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Layer that implements backmapping from torsions-angles-distances to euclidean coordinates.</p>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.BackMapLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#BackMapLayer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.BackMapLayer.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate the layer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.BackMapLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#BackMapLayer.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.BackMapLayer.call" title="Permalink to this definition">#</a></dt>
<dd><p>Call the layers, inputs should be a tuple shaped, so that it can be split into
distances, angles, dihedrals = inputs</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.layers.MeanAngles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encodermap.models.layers.</span></span><span class="sig-name descname"><span class="pre">MeanAngles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#MeanAngles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.MeanAngles" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Layer that implements the mean of periodic angles.</p>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.MeanAngles.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiples_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#MeanAngles.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.MeanAngles.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate the layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.MeanAngles.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#MeanAngles.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.MeanAngles.call" title="Permalink to this definition">#</a></dt>
<dd><p>Call the layer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encodermap.models.layers.</span></span><span class="sig-name descname"><span class="pre">PeriodicInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicInput"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicInput" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Layer that handles periodic input. Needed, if angles are treated. Input angles
will be split into sin and cos components and a tensor with shape[0] = 2 * inp_shape[0]
will be returned</p>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicInput.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicInput.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicInput.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate the layer. Need parameters to get the info about the
periodicity. Although angles are most often used, who knows what hyper-toroidal
manifold your data lies in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicInput.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicInput.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicInput.call" title="Permalink to this definition">#</a></dt>
<dd><p>Call the layer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicOutput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encodermap.models.layers.</span></span><span class="sig-name descname"><span class="pre">PeriodicOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicOutput"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicOutput" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Layer that reverses the PeriodicInputLayer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicOutput.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicOutput.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicOutput.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate the layer, We also need to know here, what periodicity is needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.PeriodicOutput.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#PeriodicOutput.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.PeriodicOutput.call" title="Permalink to this definition">#</a></dt>
<dd><p>Calls the layer, Inputs shold be a tuple of (sin, cos) of the same angles</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encodermap.models.layers.Sparse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encodermap.models.layers.</span></span><span class="sig-name descname"><span class="pre">Sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#Sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.Sparse" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dense</span></code></p>
<p>Simple subclass of tf.keras.layers.Dense, which implements sparse_dense_matmul</p>
<dl class="py method">
<dt class="sig sig-object py" id="encodermap.models.layers.Sparse.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/layers.html#Sparse.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.layers.Sparse.call" title="Permalink to this definition">#</a></dt>
<dd><p>Call the layer.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-encodermap.models.models">
<span id="encodermap-models-models-module"></span><h2>encodermap.models.models module<a class="headerlink" href="#module-encodermap.models.models" title="Permalink to this heading">#</a></h2>
<p>ToDo:
* Add some nice images to the plot_model of the functional model.</p>
<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models.gen_functional_model">
<span class="sig-prename descclassname"><span class="pre">encodermap.models.models.</span></span><span class="sig-name descname"><span class="pre">gen_functional_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/models.html#gen_functional_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.gen_functional_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds a model to specification of parameters using the functional API.</p>
<p>The functional API is much more flexible than the sequential API, in that models with multiple inputs and outputs
can be defined. Custom-layers and sub-models can be intermixed. In EncoderMap’s case the functional API is used to
build the AngleDihedralCartesianAutoencoder, which takes input data in form of a tf.data.Dataset with:</p>
<blockquote>
<div><ul class="simple">
<li><p>backbone_angles (angles between C, CA, N - atoms in the backbone).</p></li>
<li><p>backbone_torsions (dihedral angles in the backbone, commonly known as omega, phi, psi).</p></li>
<li><p>cartesian_coordinates (coordinates of the C, CA, N backbone atoms. This data has ndim 3, the other have ndim 2).</p></li>
<li><p>backbone_distances (distances between the C, CA, N backbone atoms).</p></li>
<li><p>sidechain_torsions (dihedral angles in the sidechain, commonly known as chi1, chi2, chi3, chi4, chi5).</p></li>
</ul>
</div></blockquote>
<p>Packing and unpacking that data in the correct manner is important. Make sure to double check whether you are using
angles or dihedrals. A simple print of the shape can be enough.</p>
<p>In the functional model all operations are tf.keras.layers, meaning that the projection onto a unit_circle that
the <cite>SequentialModel</cite> does in its <cite>call()</cite> method needs to be a layer. The FunctionalModel consist of 5 main parts:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>Angle Inputs: The provided dataset is unpacked and the periodic data of the angles is projected onto</dt><dd><p>a unit-circle. If the angles are in gradians, they will also be normalized into a [-pi, pi) interval.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Autoencoder: The trainable part of the network consists of the Autoencoder part build to the specifications</dt><dd><p>in the provided parameters. Here, Dense layers are stacked. Only the angles and torsions are fed into the
Autoencoder. The Distances and Cartesians are used later.</p>
</dd>
</dl>
</li>
<li><p>Angle Outputs: The angles are recalculated from their unit-circle inputs.</p></li>
<li><dl class="simple">
<dt>Back-Mapping. The backmapping layer takes backbone_angles and backbone_dihedrals, backbone_distances to</dt><dd><p>calculate new cartesian coordinates.</p>
</dd>
</dl>
</li>
<li><p>Pairwise Distances: The pairwise distances of the input cartesians and the back-mapped cartesians are calculated.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dataset</strong> (<em>tf.data.Dataset</em>) – The dataset with the data in the order given in the explanation.</p></li>
<li><p><strong>parameters</strong> (<em>Union</em><em>[</em><em>em.ADCParameters</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – The parameters to be used to build the network.
If None is provided the default parameters in encodermap.ADCParameters.defaults
is used. You can look at the defaults with print(em.ADCParameters.defaults_description()). Defaults to None.</p></li>
<li><p><strong>reload_layers</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>list</em><em>]</em><em>, </em><em>optional</em>) – List of layers that will be reloaded when reloading the model from
disk. Defaults to None, when a new model should be built.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – AssertionErrors will be raised when the input data is not formatted correctly.
    This means, if len(cartesians) != len(distances) - 1, or len(cartesians) != len(angles) - 2.
    This can also mean, the input dataset is not packed correctly. Please keep the order specified above.
    This can also mean, that the provided protein is not linear (branched, circular, …).</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A subclass of tf.keras.Model build with specified parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>em.FunctionalModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encodermap.models.models.gen_sequential_model">
<span class="sig-prename descclassname"><span class="pre">encodermap.models.models.</span></span><span class="sig-name descname"><span class="pre">gen_sequential_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/encodermap/models/models.html#gen_sequential_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#encodermap.models.models.gen_sequential_model" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a tf.keras Model build with the specified input shape and the parameters in the Parameters class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>int</em>) – The input shape of the returned model. In most cases that is data.shape[1] of your data.</p></li>
<li><p><strong>parameters</strong> (<em>Union</em><em>[</em><a class="reference internal" href="encodermap.html#encodermap.Parameters" title="encodermap.Parameters"><em>encodermap.Parameters</em></a><em>, </em><a class="reference internal" href="encodermap.html#encodermap.ADCParameters" title="encodermap.ADCParameters"><em>encodermap.ADCParameters</em></a><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – The parameters to
use on the returned model. If None is provided the default parameters in encodermap.Parameters.defaults
is used. You can look at the defaults with print(em.Parameters.defaults_description()). Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A subclass of tf.keras.Model build with specified parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>em.SequentialModel</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-encodermap.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-encodermap.models" title="Permalink to this heading">#</a></h2>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-encodermap.models.layers">
   encodermap.models.layers module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.layers.BackMapLayer">
     <code class="docutils literal notranslate">
      <span class="pre">
       BackMapLayer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.BackMapLayer.__init__">
       <code class="docutils literal notranslate">
        <span class="pre">
         BackMapLayer.__init__()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.BackMapLayer.call">
       <code class="docutils literal notranslate">
        <span class="pre">
         BackMapLayer.call()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.layers.MeanAngles">
     <code class="docutils literal notranslate">
      <span class="pre">
       MeanAngles
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.MeanAngles.__init__">
       <code class="docutils literal notranslate">
        <span class="pre">
         MeanAngles.__init__()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.MeanAngles.call">
       <code class="docutils literal notranslate">
        <span class="pre">
         MeanAngles.call()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicInput">
     <code class="docutils literal notranslate">
      <span class="pre">
       PeriodicInput
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicInput.__init__">
       <code class="docutils literal notranslate">
        <span class="pre">
         PeriodicInput.__init__()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicInput.call">
       <code class="docutils literal notranslate">
        <span class="pre">
         PeriodicInput.call()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicOutput">
     <code class="docutils literal notranslate">
      <span class="pre">
       PeriodicOutput
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicOutput.__init__">
       <code class="docutils literal notranslate">
        <span class="pre">
         PeriodicOutput.__init__()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.PeriodicOutput.call">
       <code class="docutils literal notranslate">
        <span class="pre">
         PeriodicOutput.call()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.layers.Sparse">
     <code class="docutils literal notranslate">
      <span class="pre">
       Sparse
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#encodermap.models.layers.Sparse.call">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sparse.call()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-encodermap.models.models">
   encodermap.models.models module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.models.gen_functional_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       gen_functional_model()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encodermap.models.models.gen_sequential_model">
     <code class="docutils literal notranslate">
      <span class="pre">
       gen_sequential_model()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-encodermap.models">
   Module contents
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/encodermap.models.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2023, Kevin Sawade, Tobias Lemke.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>