
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Working with trajectory ensembles &#8212; encodermap 3.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide_and_examples/01_working_with_trajectory_ensembles';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo_cube_300.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo_cube_300.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whatsnew/index.html">
                        Changelog
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whatsnew/index.html">
                        Changelog
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/Ag-Peter/encodermap" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Working-with-trajectory-ensembles">
<h1>Working with trajectory ensembles<a class="headerlink" href="#Working-with-trajectory-ensembles" title="Permalink to this heading">#</a></h1>
<p>Run this notebook on Google Colab:</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AG-Peter/encodermap/blob/main/tutorials/notebooks_MD/01_Working_with_trajectory_ensembles.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>Find the documentation of EncoderMap:</p>
<p><a class="reference external" href="https://ag-peter.github.io/encodermap">https://ag-peter.github.io/encodermap</a></p>
<section id="For-Google-colab-only:">
<h2>For Google colab only:<a class="headerlink" href="#For-Google-colab-only:" title="Permalink to this heading">#</a></h2>
<p>If you’re on Google colab, please uncomment these lines and install EncoderMap.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !wget https://raw.githubusercontent.com/AG-Peter/encodermap/main/tutorials/install_encodermap_google_colab.sh</span>
<span class="c1"># !sudo bash install_encodermap_google_colab.sh</span>
</pre></div>
</div>
</div>
<section id="Primer">
<h3>Primer<a class="headerlink" href="#Primer" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="Collective-Variables">
<h2>Collective Variables<a class="headerlink" href="#Collective-Variables" title="Permalink to this heading">#</a></h2>
<p>Collective Variables (CVs) are often used to simplify and filter the xyz-Data of MD simulations. They are often employed to make sense of a complex protein (or more general molecular) system with via just a few well-defined descriptors. They are similar to reaction coordinates, which are 1-dimensional variables along a reaction pathway but can be higher dimensional. When we think about a receptor-ligand system, the distance between the two species is often used as a reaction coordinate. A set of
this distance CV and the relative rotation between receptor and ligand can add much more information and help understand the system. It becomes apparent that clever selection of CVs is an important task that many scientists in different fields face day to day.</p>
<p>With the tools presented in this notebook we want to give you the ability to work in a fluent and natural way with MD trajectories and their associated CV data. In the scope of this work we define CVs as <strong>a collection of data that is in one of its dimensions aligned with the frames/timesteps of the underlying simulation data.</strong></p>
</section>
<section id="Example-CVs">
<h2>Example CVs<a class="headerlink" href="#Example-CVs" title="Permalink to this heading">#</a></h2>
<p>Here’s a list from the top of my head of CVs that are widely used.</p>
<ul class="simple">
<li><p>Distances: This category of CVs can contain a 1-diemsnional scalar value describing the distance between two species in a receptor-ligand system. A 1-dimensional CV of the end-to-end distance of a protein can describe the proteins folding state in an approximate and generalizing manner. Distance CVs can also be higher-dimensional. The pairwise distances between <span class="math notranslate nohighlight">\(\mathrm{C_\alpha}\)</span> atoms of a protein with <span class="math notranslate nohighlight">\(n\)</span> residues can be captured as a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix. A so-called
hollow matrix, where all diagonal-elements are zero which is also symmetric. Most often a vector of length <span class="math notranslate nohighlight">\(\binom{n}{2}\)</span> is used to describe the pairwise distances in a protein. The distance between a protein and a membrane/interface would also fall into this category.</p></li>
<li><p>Angles: Angular CVs lie in a periodic space of <span class="math notranslate nohighlight">\([-\pi, \pi]\)</span> or <span class="math notranslate nohighlight">\([0, 2\pi]\)</span>, or <span class="math notranslate nohighlight">\([0, 360]\)</span>. The well-known Ramachandran plot uses a protein’s <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> angles to find energetically favored conformations in a protein’s backbone. Besides the backbone angles other angles can become important in understanding a protein’s conformations. Lysine is often modified via acetylation, phosphorylation, methylation, ubiquitylation and it’s sidechain angles
(<span class="math notranslate nohighlight">\(\chi_1\)</span> to <span class="math notranslate nohighlight">\(\chi_5\)</span>) can be important descriptors in such a system. Pseudo-Dihedral angles lie also in this category.</p></li>
<li><p>Integer/binary values. If a protein has well-defined states (folded and unfolder) a binary value describing these states could also be a useful CV.</p></li>
<li><p>Values from other calculations and hyperparameters. An example for this category could be the temperature at which the simulation was carried out, when simulations were conducted at multiple temperatures. If phase space sub states were obtained by either using Markov-Chain models, or by using some sort of clustering algorithm (GROMOS), the membership to such cluster could also present CVs.</p></li>
<li><p>Positional values: Maybe even the full position of an atom or a group of atoms could be an important descriptor for a system.</p></li>
<li><p>etc.</p></li>
</ul>
</section>
<section id="Sharing-Trajectory-files">
<h2>Sharing Trajectory files<a class="headerlink" href="#Sharing-Trajectory-files" title="Permalink to this heading">#</a></h2>
<p>Thanks to Christoph Wehmeyer: <a class="github reference external" href="https://github.com/markovmodel/mdshare">markovmodel/mdshare</a> and his <code class="docutils literal notranslate"><span class="pre">mdshare</span></code> python package we will use a convenient way of obtaining MD data without bundling the codebase of <code class="docutils literal notranslate"><span class="pre">encodermap</span></code> with gigabytes upon gigabytes of MD trajectories.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdshare</span>
<span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>

<span class="c1"># use autoreload</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-02-06 17:10:21.950438: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-06 17:10:22.093830: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.16/x64/lib
2023-02-06 17:10:22.093850: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-02-06 17:10:22.804507: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer.so.7&#39;; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.16/x64/lib
2023-02-06 17:10:22.804581: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer_plugin.so.7&#39;; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.16/x64/lib
2023-02-06 17:10:22.804589: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "2a4b280a1e0b4d868f77760902d306fa"}</script></div>
</div>
<p>You can initialize the encodermap Repository like so:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Repository</span><span class="p">(</span><span class="n">ignore_checksums</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[3], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> repo <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Repository</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ignore_checksums</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/repository.py:231</span>, in <span class="ansi-cyan-fg">Repository.__init__</span><span class="ansi-blue-fg">(self, repo_source, checksum_file, ignore_checksums, debug)</span>
<span class="ansi-green-intense-fg ansi-bold">    226</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">RuntimeError</span>(
<span class="ansi-green-intense-fg ansi-bold">    227</span>                 <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Checksums do not match, check your catalogue files!</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    228</span>             )
<span class="ansi-green-intense-fg ansi-bold">    230</span> <span style="color: rgb(95,135,135)"># read the repo.yml file</span>
<span class="ansi-green-fg">--&gt; 231</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">repo_source</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">r</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> f:
<span class="ansi-green-intense-fg ansi-bold">    232</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>data <span style="color: rgb(98,98,98)">=</span> yaml_load(f, Loader<span style="color: rgb(98,98,98)">=</span>Loader)
<span class="ansi-green-intense-fg ansi-bold">    234</span> <span style="color: rgb(95,135,135)"># define variables based on that</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/data/repository.yaml&#39;
</pre></div></div>
</div>
<p>Print all available files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span><span class="o">.</span><span class="n">files</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[4], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>files[:<span style="color: rgb(98,98,98)">5</span>]

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<p>Print a nicely formatted catalogue.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span><span class="o">.</span><span class="n">print_catalogue</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[5], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>print_catalogue()

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<p>You can search for files with unix-like filename patterns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;*PF*&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&lt;25</span><span class="si">}{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[6], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> search <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>search(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">*PF*</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> k, v <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> search<span style="color: rgb(98,98,98)">.</span>items():
<span class="ansi-green-intense-fg ansi-bold">      3</span>     <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>k<span class="ansi-bold" style="color: rgb(175,95,135)">:</span><span style="color: rgb(175,0,0)">&lt;25</span><span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>v<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mdshare</span></code> is an easy way to download MD data directly via python. You can choose the directory to download files to, or you can let encodermap download the files into its own directory structure, which allows you to use files that have already been downloaded anytime from anywhere. You can download files by doing this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span><span class="p">,</span> <span class="n">directory</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;PFFP_single*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> files, directory <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>fetch(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">PFFP_single*</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<p>Once downloaded you can use the files however you like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdtraj</span> <span class="k">as</span> <span class="nn">md</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">top</span><span class="o">=</span><span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[:</span><span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[8], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">mdtraj</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">md</span>
<span class="ansi-green-fg">----&gt; 2</span> traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load(<span class="ansi-yellow-bg">files</span>[<span style="color: rgb(98,98,98)">0</span>], top<span style="color: rgb(98,98,98)">=</span>files[<span style="color: rgb(98,98,98)">1</span>])
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>()

<span class="ansi-red-fg">NameError</span>: name &#39;files&#39; is not defined
</pre></div></div>
</div>
<p>Normally files will be put into the directory of encodermap (This should also work if you installed encodermap via pip), but you can specify the trajectory via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Repository</span><span class="p">()</span>
<span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1am7*&#39;</span><span class="p">,</span> <span class="n">working_directory</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> repo <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Repository</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> repo<span style="color: rgb(98,98,98)">.</span>fetch(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7*</span><span style="color: rgb(175,0,0)">&#39;</span>, working_directory<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#39;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/repository.py:224</span>, in <span class="ansi-cyan-fg">Repository.__init__</span><span class="ansi-blue-fg">(self, repo_source, checksum_file, ignore_checksums, debug)</span>
<span class="ansi-green-intense-fg ansi-bold">    222</span> <span style="color: rgb(95,135,135)"># check the hash sum of the repo.yml file</span>
<span class="ansi-green-intense-fg ansi-bold">    223</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> checksum_file <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> ignore_checksums:
<span class="ansi-green-fg">--&gt; 224</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">checksum_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">r</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> fh:
<span class="ansi-green-intense-fg ansi-bold">    225</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> hash_files(repo_source)[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">repository.yaml</span><span style="color: rgb(175,0,0)">&#34;</span>][<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">md5</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">!=</span> fh<span style="color: rgb(98,98,98)">.</span>read():
<span class="ansi-green-intense-fg ansi-bold">    226</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">RuntimeError</span>(
<span class="ansi-green-intense-fg ansi-bold">    227</span>                 <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Checksums do not match, check your catalogue files!</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    228</span>             )

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/data/repository.md5&#39;
</pre></div></div>
</div>
<p>You can also fetch complete projects. These projects will return one of two new classes. After downloading the necessary files, you will be introduced to these new classes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">load_project</span><span class="p">(</span><span class="s1">&#39;C23&#39;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">show_traj</span><span class="p">()</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[10], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>load_project(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">C23</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> view <span style="color: rgb(98,98,98)">=</span> traj<span style="color: rgb(98,98,98)">.</span>show_traj()
<span class="ansi-green-intense-fg ansi-bold">      3</span> view

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<section id="Classes-for-Trajectory-Ensembles">
<h3>Classes for Trajectory Ensembles<a class="headerlink" href="#Classes-for-Trajectory-Ensembles" title="Permalink to this heading">#</a></h3>
<p>After we have obtained some files let us work with Encodermap’s <code class="docutils literal notranslate"><span class="pre">Info</span></code>-classes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mdtraj</span> <span class="k">as</span> <span class="nn">md</span>
<span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># if you have nglview set up you can also import it</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">ngl</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</section>
<section id="The-new-SingleTraj-class">
<h3>The new SingleTraj class<a class="headerlink" href="#The-new-SingleTraj-class" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class is meant as a single container to hold a trajectory’s xyz coordinates, its topology, and its CVs. This class builds the backbone of a fast and coprehensive representation of <em>trajectory ensembles</em>.</p>
</section>
</section>
<section id="Initialize.">
<h2>Initialize.<a class="headerlink" href="#Initialize." title="Permalink to this heading">#</a></h2>
<p>In the background of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class <code class="docutils literal notranslate"><span class="pre">mdtraj</span></code> works its magic, howver this class offers more benefits:</p>
<ul class="simple">
<li><p>Loading CVs in a multitude of ways and directly accessing them via indexing.</p></li>
<li><p>Keeping the actual data unloaded on disk until it is actually needed.</p></li>
<li><p>Keeping track of the original trajectory file and the original topology file.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class can be initialized in many ways:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from traj and top file on disk</span>
<span class="n">traj_xtc</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>

<span class="c1"># from a url of the pdb database</span>
<span class="n">traj_pdb</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;https://files.rcsb.org/view/1YUF.pdb&#39;</span><span class="p">)</span>

<span class="c1"># with an alternate constructor providing a pdb-id</span>
<span class="n">traj_pdb</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="o">.</span><span class="n">from_pdb_id</span><span class="p">(</span><span class="s1">&#39;1YUG&#39;</span><span class="p">)</span>

<span class="c1"># with the encpdermap repository by using the load_project() method</span>
<span class="n">traj_proj</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">load_project</span><span class="p">(</span><span class="s1">&#39;C23&#39;</span><span class="p">,</span> <span class="n">working_directory</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

<span class="c1"># from an existing mdtraj trajectory</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="n">traj_mdtraj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 11</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> traj_pdb <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj<span style="color: rgb(98,98,98)">.</span>from_pdb_id(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1YUG</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">     10</span> <span style="color: rgb(95,135,135)"># with the encpdermap repository by using the load_project() method</span>
<span class="ansi-green-fg">---&gt; 11</span> traj_proj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">repo</span><span style="color: rgb(98,98,98)">.</span>load_project(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">C23</span><span style="color: rgb(175,0,0)">&#39;</span>, working_directory<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span style="color: rgb(95,135,135)"># from an existing mdtraj trajectory</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, top<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;repo&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">traj_pdb</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">traj_proj</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">traj_mdtraj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[13], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc, <span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span style="color: rgb(175,0,0)">&#39;</span>, traj_pdb, <span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span style="color: rgb(175,0,0)">&#39;</span>, <span class="ansi-yellow-bg">traj_proj</span>, <span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span style="color: rgb(175,0,0)">&#39;</span>, traj_mdtraj)

<span class="ansi-red-fg">NameError</span>: name &#39;traj_proj&#39; is not defined
</pre></div></div>
</div>
<p><strong>If you initialized the traj from files you get some extra options like the basename</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">basename</span><span class="p">,</span> <span class="n">traj_xtc</span><span class="o">.</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">traj_xtc</span><span class="o">.</span><span class="n">top_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_pdb</span><span class="o">.</span><span class="n">basename</span><span class="p">,</span> <span class="n">traj_pdb</span><span class="o">.</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">traj_pdb</span><span class="o">.</span><span class="n">top_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1am7_corrected 1am7_corrected.xtc 1am7_protein.pdb
1YUG https://files.rcsb.org/view/1YUG.pdb https://files.rcsb.org/view/1YUG.pdb
</pre></div></div>
</div>
</section>
<section id="On-demand-loading">
<h2>On demand loading<a class="headerlink" href="#On-demand-loading" title="Permalink to this heading">#</a></h2>
<p><strong>Difference between ``traj``, ``trajectory`` and ``top``, ``topology``</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">traj</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> always give <code class="docutils literal notranslate"><span class="pre">mdtraj.Trajectory</span></code> and <code class="docutils literal notranslate"><span class="pre">mdtraj.Topology</span></code>, respectively. They are loaded “on demand” and return the corresponding <code class="docutils literal notranslate"><span class="pre">mdtraj</span></code> object. After they are loaded, they are deleted again and the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class is garbage collected.</p>
<p><code class="docutils literal notranslate"><span class="pre">trajectory</span></code> and <code class="docutils literal notranslate"><span class="pre">topology</span></code> can be <code class="docutils literal notranslate"><span class="pre">False</span></code> and represent the current <em>backend</em> of the TrajEnsemble object.</p>
<p>This method saves RAM.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">topology</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">topology</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[15], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>topology)
<span class="ansi-green-fg">----&gt; 2</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>topology)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">traj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>trajectory)
<span class="ansi-green-fg">----&gt; 2</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj</span>)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>trajectory)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:463</span>, in <span class="ansi-cyan-fg">SingleTraj.traj</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;mdtraj.Trajectory: This attribute always returns an mdtraj.Trajectory.</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span> <span style="color: rgb(175,0,0)">if `backend` is &#39;no_load&#39;, the trajectory will be loaded into memory and returned.</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span>
<span class="ansi-green-intense-fg ansi-bold">    461</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    462</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 463</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    464</span>     out <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory
<span class="ansi-green-intense-fg ansi-bold">    465</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>unload()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
<p>Directly accessing attributes of the mdtraj.Trajectory will load it from disk and return the attributes. This means if we would execute these lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">))</span>
<span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
<p>we would always get the xyz coordinate of the trajectory (because the trajectory is loaded to RAM). Even this method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>would cause the trajectory to get loaded. Only <code class="docutils literal notranslate"><span class="pre">traj.__dict__</span></code> gives use the information, that the xyz coordinates are currenlty not there.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">hasattr</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;xyz&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">traj_xtc</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No xyz data here&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No xyz data here
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[18], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">xyz</span><span style="color: rgb(175,0,0)">&#39;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> traj_xtc<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__dict__</span>:
<span class="ansi-green-intense-fg ansi-bold">      2</span>     <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">No xyz data here</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">----&gt; 3</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">xyz</span>[<span style="color: rgb(98,98,98)">0</span>,<span style="color: rgb(98,98,98)">0</span>])

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1286</span>, in <span class="ansi-cyan-fg">SingleTraj.__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1278</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;What to do when attributes can not be obtained in a normal way?.</span>
<span class="ansi-green-intense-fg ansi-bold">   1279</span>
<span class="ansi-green-intense-fg ansi-bold">   1280</span> <span style="color: rgb(175,0,0)">This method allows access of the self.CVs dictionary&#39;s values as</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1283</span>
<span class="ansi-green-intense-fg ansi-bold">   1284</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1285</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> attr <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_mdtraj_attr:
<span class="ansi-green-fg">-&gt; 1286</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1287</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">getattr</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj, attr)
<span class="ansi-green-intense-fg ansi-bold">   1288</span>     <span style="color: rgb(95,135,135)"># if self.index == (None, ):</span>
<span class="ansi-green-intense-fg ansi-bold">   1289</span>     <span style="color: rgb(95,135,135)">#     return getattr(self.traj, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1290</span>     <span style="color: rgb(95,135,135)"># else:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1293</span>     <span style="color: rgb(95,135,135)">#     else:</span>
<span class="ansi-green-intense-fg ansi-bold">   1294</span>     <span style="color: rgb(95,135,135)">#         return getattr(self.traj[self.index], attr)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
<p><strong>Loading can be forced</strong></p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">load()</span></code> method, the trajectory will be loaded. From that point forwards, the xyz data is kept in RAM and can be accessed. The <code class="docutils literal notranslate"><span class="pre">unload()</span></code> function does the reverse and frees up the RAM, but the xyz data can be loaded again. If your RAM is large enough you would not need the <code class="docutils literal notranslate"><span class="pre">unload()</span></code> function, but it is there nonetheless.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">load_traj</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">topology</span><span class="p">)</span>
<span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">topology</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[19], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>topology)
<span class="ansi-green-intense-fg ansi-bold">      3</span> traj_xtc<span style="color: rgb(98,98,98)">.</span>unload()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
</section>
<section id="Take-a-look-with-nglview">
<h2>Take a look with nglview<a class="headerlink" href="#Take-a-look-with-nglview" title="Permalink to this heading">#</a></h2>
<p>If nglview is set up, you can take a look at the trajectory with this code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="o">.</span><span class="n">show_traj</span><span class="p">()</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> view <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">show_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> view

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:850</span>, in <span class="ansi-cyan-fg">SingleTraj.show_traj</span><span class="ansi-blue-fg">(self, gui)</span>
<span class="ansi-green-intense-fg ansi-bold">    842</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Returns an nglview view object.</span>
<span class="ansi-green-intense-fg ansi-bold">    843</span>
<span class="ansi-green-intense-fg ansi-bold">    844</span> <span style="color: rgb(175,0,0)">Returns:</span>
<span class="ansi-green-intense-fg ansi-bold">    845</span> <span style="color: rgb(175,0,0)">    view (nglview.widget): The nglview widget object.</span>
<span class="ansi-green-intense-fg ansi-bold">    846</span>
<span class="ansi-green-intense-fg ansi-bold">    847</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    848</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">nglview</span>
<span class="ansi-green-fg">--&gt; 850</span> view <span style="color: rgb(98,98,98)">=</span> nglview<span style="color: rgb(98,98,98)">.</span>show_mdtraj(<span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj</span>, gui<span style="color: rgb(98,98,98)">=</span>gui)
<span class="ansi-green-intense-fg ansi-bold">    851</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> view

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:463</span>, in <span class="ansi-cyan-fg">SingleTraj.traj</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;mdtraj.Trajectory: This attribute always returns an mdtraj.Trajectory.</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span> <span style="color: rgb(175,0,0)">if `backend` is &#39;no_load&#39;, the trajectory will be loaded into memory and returned.</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span>
<span class="ansi-green-intense-fg ansi-bold">    461</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    462</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 463</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    464</span>     out <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory
<span class="ansi-green-intense-fg ansi-bold">    465</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>unload()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
</section>
<section id="Class-attributes">
<h2>Class attributes<a class="headerlink" href="#Class-attributes" title="Permalink to this heading">#</a></h2>
<p>These attributes might be useful when you work with <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> classes</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">load_traj</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">traj_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">top_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">basename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[21], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj_xtc<span style="color: rgb(98,98,98)">.</span>n_atoms)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
</section>
<section id="Duplication-of-mdtraj">
<h2>Duplication of mdtraj<a class="headerlink" href="#Duplication-of-mdtraj" title="Permalink to this heading">#</a></h2>
<p>Some methods and attributes are duplicated from <code class="docutils literal notranslate"><span class="pre">mdtraj</span></code>. This allows us to call some <code class="docutils literal notranslate"><span class="pre">mdtraj</span></code> functions on the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> object directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selection</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">dssp</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_dssp</span><span class="p">(</span><span class="n">traj_xtc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dssp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[22], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> selection <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">select</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">name CA</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(selection[:<span style="color: rgb(98,98,98)">5</span>])
<span class="ansi-green-intense-fg ansi-bold">      3</span> dssp <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>compute_dssp(traj_xtc)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:752</span>, in <span class="ansi-cyan-fg">SingleTraj.select</span><span class="ansi-blue-fg">(self, sel_str)</span>
<span class="ansi-green-intense-fg ansi-bold">    727</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">select</span>(
<span class="ansi-green-intense-fg ansi-bold">    728</span>     <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-intense-fg ansi-bold">    729</span>     sel_str: <span style="color: rgb(0,135,0)">str</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>,
<span class="ansi-green-intense-fg ansi-bold">    730</span> ) <span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">&gt;</span> np<span style="color: rgb(98,98,98)">.</span>ndarray:
<span class="ansi-green-intense-fg ansi-bold">    731</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Execute a selection against the topology</span>
<span class="ansi-green-intense-fg ansi-bold">    732</span>
<span class="ansi-green-intense-fg ansi-bold">    733</span> <span style="color: rgb(175,0,0)">    Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    750</span>
<span class="ansi-green-intense-fg ansi-bold">    751</span> <span style="color: rgb(175,0,0)">    &#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 752</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span><span style="color: rgb(98,98,98)">.</span>select(sel_str)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">compute_center_of_mass</span><span class="p">(</span><span class="n">traj_xtc</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[23], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">md</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">compute_center_of_mass</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg">)</span>[<span style="color: rgb(98,98,98)">0</span>]

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/mdtraj/geometry/distance.py:213</span>, in <span class="ansi-cyan-fg">compute_center_of_mass</span><span class="ansi-blue-fg">(traj, select)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">compute_center_of_mass</span>(traj, select<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>):
<span class="ansi-green-intense-fg ansi-bold">    197</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Compute the center of mass for each frame.</span>
<span class="ansi-green-intense-fg ansi-bold">    198</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span> <span style="color: rgb(175,0,0)">    Parameters</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    211</span> <span style="color: rgb(175,0,0)">         Coordinates of the center of mass for each frame</span>
<span class="ansi-green-intense-fg ansi-bold">    212</span> <span style="color: rgb(175,0,0)">    &#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 213</span>     com <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>empty((<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>, <span style="color: rgb(98,98,98)">3</span>))
<span class="ansi-green-intense-fg ansi-bold">    215</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> select <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    216</span>         masses <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>array([a<span style="color: rgb(98,98,98)">.</span>element<span style="color: rgb(98,98,98)">.</span>mass <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> a <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> traj<span style="color: rgb(98,98,98)">.</span>top<span style="color: rgb(98,98,98)">.</span>atoms])

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
</section>
<section id="Indexing">
<h2>Indexing<a class="headerlink" href="#Indexing" title="Permalink to this heading">#</a></h2>
<p>By indexing the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class you get another instance of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class containing only one frame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> frame <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">0</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(frame)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1215</span>, in <span class="ansi-cyan-fg">SingleTraj.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1212</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj index out of range for traj with 1 frame.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">   1214</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):
<span class="ansi-green-fg">-&gt; 1215</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span style="color: rgb(98,98,98)">&gt;</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>:
<span class="ansi-green-intense-fg ansi-bold">   1216</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1217</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Index </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for traj with </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1218</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1219</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1220</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">list</span>, np<span style="color: rgb(98,98,98)">.</span>ndarray)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
<p>If the traj has currently not been loaded (backend = ‘no_load’) the frame number will be stored, until the traj is loaded.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[25], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj_xtc<span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-fg">----&gt; 2</span> frame <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(frame)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1215</span>, in <span class="ansi-cyan-fg">SingleTraj.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1212</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj index out of range for traj with 1 frame.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">   1214</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):
<span class="ansi-green-fg">-&gt; 1215</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span style="color: rgb(98,98,98)">&gt;</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>:
<span class="ansi-green-intense-fg ansi-bold">   1216</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1217</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Index </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for traj with </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1218</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1219</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1220</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">list</span>, np<span style="color: rgb(98,98,98)">.</span>ndarray)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">load_traj</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[26], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">frame</span><span style="color: rgb(98,98,98)">.</span>load_traj()
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(frame)

<span class="ansi-red-fg">NameError</span>: name &#39;frame&#39; is not defined
</pre></div></div>
</div>
<p>If the index is larger than the number of frames, the loading will throw and exception.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[27], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj_xtc<span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-fg">----&gt; 2</span> frame <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1000</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(frame)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1215</span>, in <span class="ansi-cyan-fg">SingleTraj.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1212</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj index out of range for traj with 1 frame.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">   1214</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):
<span class="ansi-green-fg">-&gt; 1215</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span style="color: rgb(98,98,98)">&gt;</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>:
<span class="ansi-green-intense-fg ansi-bold">   1216</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1217</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Index </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for traj with </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1218</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1219</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1220</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">list</span>, np<span style="color: rgb(98,98,98)">.</span>ndarray)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">load_traj</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[28], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">frame</span><span style="color: rgb(98,98,98)">.</span>load_traj()
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(frame)

<span class="ansi-red-fg">NameError</span>: name &#39;frame&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Advanced-slicing">
<h2>Advanced slicing<a class="headerlink" href="#Advanced-slicing" title="Permalink to this heading">#</a></h2>
<p>You can also give a numpy array, a list or even a slice into the indexing.</p>
<p>Indexing with without a stop (<code class="docutils literal notranslate"><span class="pre">[::5]</span></code>) will put the trajectory into memory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[29], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj_xtc<span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-intense-fg ansi-bold">      2</span> subsample <span style="color: rgb(98,98,98)">=</span> traj_xtc[::<span style="color: rgb(98,98,98)">2</span>]
<span class="ansi-green-fg">----&gt; 3</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj</span><span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(subsample)
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span style="color: rgb(0,135,0)">print</span>(subsample<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:463</span>, in <span class="ansi-cyan-fg">SingleTraj.traj</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;mdtraj.Trajectory: This attribute always returns an mdtraj.Trajectory.</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span> <span style="color: rgb(175,0,0)">if `backend` is &#39;no_load&#39;, the trajectory will be loaded into memory and returned.</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span>
<span class="ansi-green-intense-fg ansi-bold">    461</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    462</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 463</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    464</span>     out <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory
<span class="ansi-green-intense-fg ansi-bold">    465</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>unload()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[30], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj_xtc<span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-fg">----&gt; 2</span> subsample <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">5</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">6</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(subsample)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(subsample<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1221</span>, in <span class="ansi-cyan-fg">SingleTraj.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1216</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1217</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Index </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for traj with </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1218</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1219</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1220</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">list</span>, np<span style="color: rgb(98,98,98)">.</span>ndarray)):
<span class="ansi-green-fg">-&gt; 1221</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">any</span>([k <span style="color: rgb(98,98,98)">&gt;</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> k <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> key]):
<span class="ansi-green-intense-fg ansi-bold">   1222</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1223</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">At least one index in </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1224</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj with </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1225</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1227</span> <span style="color: rgb(95,135,135)"># append the index to the list of &#34;transformations&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1221</span>, in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">   1216</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1217</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Index </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for traj with </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1218</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1219</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1220</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(key, (<span style="color: rgb(0,135,0)">list</span>, np<span style="color: rgb(98,98,98)">.</span>ndarray)):
<span class="ansi-green-fg">-&gt; 1221</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">any</span>([k <span style="color: rgb(98,98,98)">&gt;</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> k <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> key]):
<span class="ansi-green-intense-fg ansi-bold">   1222</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IndexError</span>(
<span class="ansi-green-intense-fg ansi-bold">   1223</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">At least one index in </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> out of range for</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1224</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj with </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_frames<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> frames.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1225</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1227</span> <span style="color: rgb(95,135,135)"># append the index to the list of &#34;transformations&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
<p>Dancy slices (<code class="docutils literal notranslate"><span class="pre">[start:stop:step]</span></code>) won’t put the traj into memory, but can raise errors down the line, when stop is greater than the number of frames.</p>
<p><strong>Note:</strong> Andvanced slicing can result in trajectories with 0 frames in them, or possibly reverse the time axis. Use this feature only if you are sure about what you are doing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_xtc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
encodermap.SingleTraj object. Current backend is no_load. Basename is 1am7_corrected. At indices (None, slice(5, 46, 3)). Not containing any CVs.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[31], line 4</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> subsample <span style="color: rgb(98,98,98)">=</span> traj_xtc[<span style="color: rgb(98,98,98)">5</span>:<span style="color: rgb(98,98,98)">46</span>:<span style="color: rgb(98,98,98)">3</span>]
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(subsample)
<span class="ansi-green-fg">----&gt; 4</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">subsample</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
</section>
<section id="Advanced-slicing-with-HDF5">
<h2>Advanced slicing with HDF5<a class="headerlink" href="#Advanced-slicing-with-HDF5" title="Permalink to this heading">#</a></h2>
<p>The HDF5 file format (ending wiht .h5) allows us to directly extract frames and accelerate loading. We can save a .h5 formatted file from an <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class by calling:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_xtc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.h5&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[32], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_xtc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">save</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">1am7_corrected.h5</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">overwrite</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1110</span>, in <span class="ansi-cyan-fg">SingleTraj.save</span><span class="ansi-blue-fg">(self, fname, CVs, overwrite)</span>
<span class="ansi-green-intense-fg ansi-bold">   1108</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">IOError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>fname<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> already exists. Set overwrite=True to overwrite.</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">   1109</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1110</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj</span><span style="color: rgb(98,98,98)">.</span>save_hdf5(fname, force_overwrite<span style="color: rgb(98,98,98)">=</span>overwrite)
<span class="ansi-green-intense-fg ansi-bold">   1111</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> CVs <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">   1112</span>     save_netcdf_alongside_mdtraj(fname, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_CVs)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:463</span>, in <span class="ansi-cyan-fg">SingleTraj.traj</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;mdtraj.Trajectory: This attribute always returns an mdtraj.Trajectory.</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span> <span style="color: rgb(175,0,0)">if `backend` is &#39;no_load&#39;, the trajectory will be loaded into memory and returned.</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span>
<span class="ansi-green-intense-fg ansi-bold">    461</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    462</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 463</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_traj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    464</span>     out <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory
<span class="ansi-green-intense-fg ansi-bold">    465</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>unload()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:721</span>, in <span class="ansi-cyan-fg">SingleTraj.load_traj</span><span class="ansi-blue-fg">(self, new_backend)</span>
<span class="ansi-green-intense-fg ansi-bold">    719</span> <span style="color: rgb(95,135,135)"># call the setter again</span>
<span class="ansi-green-intense-fg ansi-bold">    720</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 721</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_traj</span> <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file
<span class="ansi-green-intense-fg ansi-bold">    722</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    723</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:480</span>, in <span class="ansi-cyan-fg">SingleTraj._traj</span><span class="ansi-blue-fg">(self, traj_file)</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span style="color: rgb(175,0,255)">@_traj</span><span style="color: rgb(98,98,98)">.</span>setter
<span class="ansi-green-intense-fg ansi-bold">    477</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_traj</span>(<span style="color: rgb(0,135,0)">self</span>, traj_file):
<span class="ansi-green-intense-fg ansi-bold">    478</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;Sets the traj and trajectory attributes. Can be provided str or</span>
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(175,0,0)">    mdtraj.Trajectory and sets the attributes based on the chosen backend.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 480</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>trajectory, _ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    481</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_top_file</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once:
<span class="ansi-green-intense-fg ansi-bold">    484</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_loaded_once <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:179</span>, in <span class="ansi-cyan-fg">_load_traj</span><span class="ansi-blue-fg">(traj_file, top_file, *index)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         traj <span style="color: rgb(98,98,98)">=</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">str</span>(traj_file))
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 179</span>         traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_load_traj_and_top</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">top_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     _original_frame_indices <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(traj<span style="color: rgb(98,98,98)">.</span>n_frames)
<span class="ansi-green-intense-fg ansi-bold">    181</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(ind, (<span style="color: rgb(0,135,0)">int</span>, np<span style="color: rgb(98,98,98)">.</span>integer)):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/load_traj.py:117</span>, in <span class="ansi-cyan-fg">_load_traj_and_top</span><span class="ansi-blue-fg">(traj_file, top_file, index)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads a traj and top file and raises FileNotFoundError, if they do not exist.</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> traj_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-fg">--&gt; 117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), traj_file)
<span class="ansi-green-intense-fg ansi-bold">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> top_file<span style="color: rgb(98,98,98)">.</span>is_file():
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: PosixPath(&#39;1am7_corrected.xtc&#39;)
</pre></div></div>
</div>
<p>Loading of .h5 files is similar to all files:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_h5</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[33], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> traj_h5 <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">SingleTraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">1am7_corrected.h5</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:379</span>, in <span class="ansi-cyan-fg">SingleTraj.__init__</span><span class="ansi-blue-fg">(self, traj, top, common_str, backend, index, traj_num, basename_fn)</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    378</span>     CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-fg">--&gt; 379</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg">h5</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">File</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">r</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> file:
<span class="ansi-green-intense-fg ansi-bold">    380</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">CVs</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> file<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-intense-fg ansi-bold">    381</span>             CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:567</span>, in <span class="ansi-cyan-fg">File.__init__</span><span class="ansi-blue-fg">(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, alignment_threshold, alignment_interval, meta_block_size, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    558</span>     fapl <span style="color: rgb(98,98,98)">=</span> make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
<span class="ansi-green-intense-fg ansi-bold">    559</span>                      locking, page_buf_size, min_meta_keep, min_raw_keep,
<span class="ansi-green-intense-fg ansi-bold">    560</span>                      alignment_threshold<span style="color: rgb(98,98,98)">=</span>alignment_threshold,
<span class="ansi-green-intense-fg ansi-bold">    561</span>                      alignment_interval<span style="color: rgb(98,98,98)">=</span>alignment_interval,
<span class="ansi-green-intense-fg ansi-bold">    562</span>                      meta_block_size<span style="color: rgb(98,98,98)">=</span>meta_block_size,
<span class="ansi-green-intense-fg ansi-bold">    563</span>                      <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwds)
<span class="ansi-green-intense-fg ansi-bold">    564</span>     fcpl <span style="color: rgb(98,98,98)">=</span> make_fcpl(track_order<span style="color: rgb(98,98,98)">=</span>track_order, fs_strategy<span style="color: rgb(98,98,98)">=</span>fs_strategy,
<span class="ansi-green-intense-fg ansi-bold">    565</span>                      fs_persist<span style="color: rgb(98,98,98)">=</span>fs_persist, fs_threshold<span style="color: rgb(98,98,98)">=</span>fs_threshold,
<span class="ansi-green-intense-fg ansi-bold">    566</span>                      fs_page_size<span style="color: rgb(98,98,98)">=</span>fs_page_size)
<span class="ansi-green-fg">--&gt; 567</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">make_fid</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">mode</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">userblock_size</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fcpl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(libver, <span style="color: rgb(0,135,0)">tuple</span>):
<span class="ansi-green-intense-fg ansi-bold">    570</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_libver <span style="color: rgb(98,98,98)">=</span> libver

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:231</span>, in <span class="ansi-cyan-fg">make_fid</span><span class="ansi-blue-fg">(name, mode, userblock_size, fapl, fcpl, swmr)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> swmr <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> swmr_support:
<span class="ansi-green-intense-fg ansi-bold">    230</span>         flags <span style="color: rgb(98,98,98)">|</span><span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>ACC_SWMR_READ
<span class="ansi-green-fg">--&gt; 231</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">h5f</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">flags</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> mode <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r+</span><span style="color: rgb(175,0,0)">&#39;</span>:
<span class="ansi-green-intense-fg ansi-bold">    233</span>     fid <span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>open(name, h5f<span style="color: rgb(98,98,98)">.</span>ACC_RDWR, fapl<span style="color: rgb(98,98,98)">=</span>fapl)

File <span class="ansi-green-fg">h5py/_objects.pyx:54</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/_objects.pyx:55</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/h5f.pyx:106</span>, in <span class="ansi-cyan-fg">h5py.h5f.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] Unable to open file (unable to open file: name = &#39;1am7_corrected.h5&#39;, errno = 2, error message = &#39;No such file or directory&#39;, flags = 0, o_flags = 0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">em</span><span class="o">.</span><span class="n">trajinfo</span><span class="o">.</span><span class="n">info_single</span><span class="o">.</span><span class="n">PRINTED_HDF_ANNOTATION</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[34], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajinfo</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">info_single</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">PRINTED_HDF_ANNOTATION</span>)

<span class="ansi-red-fg">AttributeError</span>: module &#39;encodermap.trajinfo.info_single&#39; has no attribute &#39;PRINTED_HDF_ANNOTATION&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_h5</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_h5</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[35], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_h5</span><span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-intense-fg ansi-bold">      2</span> subsample <span style="color: rgb(98,98,98)">=</span> traj_h5[<span style="color: rgb(98,98,98)">5</span>:<span style="color: rgb(98,98,98)">46</span>:<span style="color: rgb(98,98,98)">3</span>]
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(subsample)

<span class="ansi-red-fg">NameError</span>: name &#39;traj_h5&#39; is not defined
</pre></div></div>
</div>
<p>Similar to the xtc trajectory providing a slice with only steps (<code class="docutils literal notranslate"><span class="pre">[::3]</span></code>) will load the traj into memory. You will be greeted by a nice message thanking you for using HDF5-formatted trajectories. This message is only printed once. To see it again you have to restart the kernel.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_h5</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_h5</span><span class="p">[::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">traj</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[36], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_h5</span><span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-intense-fg ansi-bold">      2</span> subsample <span style="color: rgb(98,98,98)">=</span> traj_h5[::<span style="color: rgb(98,98,98)">3</span>]<span style="color: rgb(98,98,98)">.</span>traj
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(subsample)

<span class="ansi-red-fg">NameError</span>: name &#39;traj_h5&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_h5</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">traj_h5</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">traj</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subsample</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[37], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj_h5</span><span style="color: rgb(98,98,98)">.</span>unload()
<span class="ansi-green-intense-fg ansi-bold">      2</span> subsample <span style="color: rgb(98,98,98)">=</span> traj_h5[[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">1</span>, <span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">6</span>]]<span style="color: rgb(98,98,98)">.</span>traj
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(subsample)

<span class="ansi-red-fg">NameError</span>: name &#39;traj_h5&#39; is not defined
</pre></div></div>
</div>
<section id="Loading-CVs">
<h3>Loading CVs<a class="headerlink" href="#Loading-CVs" title="Permalink to this heading">#</a></h3>
<p>After learning about the basics of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class we will come back to collective variables. There are many ways of adding CVs to you trajectories. The easiest would be to provide an already existing numpy array. However, you will be asked to also provide the attribute name (<code class="docutils literal notranslate"><span class="pre">attr_name</span></code>) of the array. With this you could load multiple CV datasets, that differ in ther attribute names. Here’s an example:</p>
</section>
</section>
<section id="From-numpy">
<h2>From numpy<a class="headerlink" href="#From-numpy" title="Permalink to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj_xtc</span>

<span class="c1"># random phi/psi angles in a [0, 2pi] interval</span>
<span class="n">random_raman_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">traj</span><span class="o">.</span><span class="n">n_residues</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># define labels:</span>
<span class="n">phi_angles</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;phi </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">n_residues</span><span class="p">)]</span>
<span class="n">psi_angles</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;psi </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">n_residues</span><span class="p">)]</span>
<span class="n">raman_labels</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">phi_angles</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">psi_angles</span><span class="p">))</span>
<span class="n">raman_labels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi_angles</span>
<span class="n">raman_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_angles</span>

<span class="c1"># load the CV</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">random_raman_angles</span><span class="p">,</span> <span class="s1">&#39;raman&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">raman_labels</span><span class="p">)</span>

<span class="c1"># define some integer values (can be cluster memberships)</span>
<span class="n">random_integers_per_frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">random_integers_per_frame</span><span class="p">,</span> <span class="s1">&#39;cluster_membership&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[38], line 4</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> traj_xtc
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(95,135,135)"># random phi/psi angles in a [0, 2pi] interval</span>
<span class="ansi-green-fg">----&gt; 4</span> random_raman_angles <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>random<span style="color: rgb(98,98,98)">.</span>random((<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_frames</span>, <span style="color: rgb(98,98,98)">2</span> <span style="color: rgb(98,98,98)">*</span> traj<span style="color: rgb(98,98,98)">.</span>n_residues)) <span style="color: rgb(98,98,98)">*</span> <span style="color: rgb(98,98,98)">2</span> <span style="color: rgb(98,98,98)">*</span> np<span style="color: rgb(98,98,98)">.</span>pi
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># define labels:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> phi_angles <span style="color: rgb(98,98,98)">=</span> [<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">phi </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>i<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> i <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">range</span>(traj<span style="color: rgb(98,98,98)">.</span>n_residues)]

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:574</span>, in <span class="ansi-cyan-fg">SingleTraj.n_frames</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">len</span>(n_frames)
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.xtc</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 574</span>     reader <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mda</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coordinates</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTC</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">XTCReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>index <span style="color: rgb(98,98,98)">==</span> (<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,):
<span class="ansi-green-intense-fg ansi-bold">    576</span>         n_frames <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>arange(reader<span style="color: rgb(98,98,98)">.</span>n_frames)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/util.py:2522</span>, in <span class="ansi-cyan-fg">store_init_arguments.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2520</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2521</span>                 <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_kwargs[key] <span style="color: rgb(98,98,98)">=</span> arg
<span class="ansi-green-fg">-&gt; 2522</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py:149</span>, in <span class="ansi-cyan-fg">XDRBaseReader.__init__</span><span class="ansi-blue-fg">(self, filename, convert_units, sub, refresh_offsets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> <span style="color: rgb(175,0,0)">Parameters</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span style="color: rgb(175,0,0)">----------</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> <span style="color: rgb(0,135,0)">super</span>(XDRBaseReader, <span style="color: rgb(0,135,0)">self</span>)<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>(filename,
<span class="ansi-green-intense-fg ansi-bold">    147</span>                                     convert_units<span style="color: rgb(98,98,98)">=</span>convert_units,
<span class="ansi-green-intense-fg ansi-bold">    148</span>                                     <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-fg">--&gt; 149</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_xdr <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_file</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span style="color: rgb(98,98,98)">=</span> sub
<span class="ansi-green-intense-fg ansi-bold">    152</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_sub <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:135</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/lib/formats/libmdaxdr.pyx:194</span>, in <span class="ansi-cyan-fg">MDAnalysis.lib.formats.libmdaxdr._XDRFile.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">OSError</span>: File does not exist: b&#39;1am7_corrected.xtc&#39;
</pre></div></div>
</div>
<p>These values can be accessed via directly calling their attribute names (so make sure to use valid identifiers).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">cluster_membership</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[39], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">cluster_membership</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1310</span>, in <span class="ansi-cyan-fg">SingleTraj.__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1308</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__getattribute__</span>(attr)
<span class="ansi-green-intense-fg ansi-bold">   1309</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1310</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">AttributeError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)"> object has no attribute </span><span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>attr<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">AttributeError</span>: &#39;SingleTraj&#39; object has no attribute &#39;cluster_membership&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">raman</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Exception ignored in: &lt;function ReaderBase.__del__ at 0x7efcd7d7d670&gt;
Traceback (most recent call last):
  File &#34;/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/base.py&#34;, line 1512, in __del__
    self.close()
  File &#34;/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/MDAnalysis/coordinates/XDR.py&#34;, line 187, in close
    self._xdr.close()
AttributeError: &#39;XTCReader&#39; object has no attribute &#39;_xdr&#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[40], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raman</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1310</span>, in <span class="ansi-cyan-fg">SingleTraj.__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1308</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__getattribute__</span>(attr)
<span class="ansi-green-intense-fg ansi-bold">   1309</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1310</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">AttributeError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)"> object has no attribute </span><span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>attr<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">AttributeError</span>: &#39;SingleTraj&#39; object has no attribute &#39;raman&#39;
</pre></div></div>
</div>
<p>There’s also the attribute <code class="docutils literal notranslate"><span class="pre">CVs</span></code> that is a dict of these collective variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{}
</pre></div></div>
</div>
<p>However, this is not the end. CVs in a <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class are stored as <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>s. The dataset can be accessed via <code class="docutils literal notranslate"><span class="pre">_CVs</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  ()
Data variables:
    *empty*</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-bd16131c-acec-487e-aef7-a29cd139168c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bd16131c-acec-487e-aef7-a29cd139168c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-94b97b54-ca70-40f2-9307-6ae6e2644dcc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-94b97b54-ca70-40f2-9307-6ae6e2644dcc' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-5619144b-7083-413d-a2f7-3efeebcc3eca' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5619144b-7083-413d-a2f7-3efeebcc3eca' class='xr-section-summary'  title='Expand/collapse section'>Data variables: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-6a761a70-14ae-4e2e-a80c-90ef2907ba37' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6a761a70-14ae-4e2e-a80c-90ef2907ba37' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-e46344df-f939-41c1-aaa6-fc354e96695a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e46344df-f939-41c1-aaa6-fc354e96695a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p><strong>Why xarray?</strong></p>
<p>The underlying <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> is intended to make sure “everything is correct”. Every value can be accessed via an unambigous identifier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="p">[</span><span class="s1">&#39;raman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s1">&#39;frame_no&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;RAMAN&#39;</span><span class="p">:</span> <span class="s1">&#39;psi 50&#39;</span><span class="p">}]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;raman&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[43], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">raman</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>loc[{<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">frame_no</span><span style="color: rgb(175,0,0)">&#39;</span>: <span style="color: rgb(98,98,98)">20</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">RAMAN</span><span style="color: rgb(175,0,0)">&#39;</span>: <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">psi 50</span><span style="color: rgb(175,0,0)">&#39;</span>}]<span style="color: rgb(98,98,98)">.</span>values

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;raman&#39;
</pre></div></div>
</div>
</section>
<section id="Slicing-with-CVs.">
<h2>Slicing with CVs.<a class="headerlink" href="#Slicing-with-CVs." title="Permalink to this heading">#</a></h2>
<p>Slicing keeps your values where they should be.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">raman_labels</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;psi 50&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">raman</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span><span class="o">.</span><span class="n">raman</span><span class="p">[:,</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[44], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> index <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>where(np<span style="color: rgb(98,98,98)">.</span>array(<span class="ansi-yellow-bg">raman_labels</span>) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">psi 50</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj[<span style="color: rgb(98,98,98)">20</span>]<span style="color: rgb(98,98,98)">.</span>raman[index])
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj[[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">10</span>, <span style="color: rgb(98,98,98)">20</span>]]<span style="color: rgb(98,98,98)">.</span>raman[:,index])

<span class="ansi-red-fg">NameError</span>: name &#39;raman_labels&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Loading-from-files">
<h2>Loading from files<a class="headerlink" href="#Loading-from-files" title="Permalink to this heading">#</a></h2>
<p>CVs can be loaded by providing a string to files. First, let us save some files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save numpy</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;raman_file.npy&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">raman</span><span class="p">)</span>

<span class="c1"># save text</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;cluster_membership_file.txt&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">cluster_membership</span><span class="p">)</span>

<span class="c1"># save full CV dataset as NetCDF</span>
<span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;full_CV_dataset.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[45], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># save numpy</span>
<span class="ansi-green-fg">----&gt; 2</span> np<span style="color: rgb(98,98,98)">.</span>save(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">raman_file.npy</span><span style="color: rgb(175,0,0)">&#39;</span>, <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raman</span>)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># save text</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> np<span style="color: rgb(98,98,98)">.</span>savetxt(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">cluster_membership_file.txt</span><span style="color: rgb(175,0,0)">&#39;</span>, traj<span style="color: rgb(98,98,98)">.</span>cluster_membership)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1310</span>, in <span class="ansi-cyan-fg">SingleTraj.__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1308</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__getattribute__</span>(attr)
<span class="ansi-green-intense-fg ansi-bold">   1309</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1310</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">AttributeError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)"> object has no attribute </span><span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>attr<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">AttributeError</span>: &#39;SingleTraj&#39; object has no attribute &#39;raman&#39;
</pre></div></div>
</div>
<p>If not providing an <code class="docutils literal notranslate"><span class="pre">attr_name</span></code>, while loading files, the filename will be used:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;raman_file.npy&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;cluster_membership_file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[46], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">raman_file.npy</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> traj<span style="color: rgb(98,98,98)">.</span>load_CV(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">cluster_membership_file.txt</span><span style="color: rgb(175,0,0)">&#39;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:216</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    211</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Currently only .txt, .npy, .nc, and .h5 files can </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    212</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">be loaded. Your file </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>f<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> does not have the </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">correct extension.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    214</span>         )
<span class="ansi-green-intense-fg ansi-bold">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    217</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">If features are loaded via a string, the string needs </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    218</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">to be </span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">, a features name (</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">central_dihedrals</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">) or </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">an existing file. Your string </span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>file_or_feature<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">is none of those</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span>     )
<span class="ansi-green-intense-fg ansi-bold">    223</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np_to_xr(data, traj, attr_name, labels, file_or_feature)

<span class="ansi-red-fg">Exception</span>: If features are loaded via a string, the string needs to be &#39;all&#39;, a features name (&#39;central_dihedrals&#39;) or an existing file. Your string &#34;raman_file.npy&#34;is none of those
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([])
</pre></div></div>
</div>
<p>Multiple CVs can be reconstructed from xarray NetCDF files (most end with .nc). If there are conflicts the new data from disk will overwrite the old.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;full_CV_dataset.nc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[48], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj<span style="color: rgb(98,98,98)">.</span>CVs<span style="color: rgb(98,98,98)">.</span>keys())
<span class="ansi-green-fg">----&gt; 3</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">full_CV_dataset.nc</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(traj<span style="color: rgb(98,98,98)">.</span>CVs<span style="color: rgb(98,98,98)">.</span>keys())

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:216</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    211</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Currently only .txt, .npy, .nc, and .h5 files can </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    212</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">be loaded. Your file </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>f<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> does not have the </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">correct extension.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    214</span>         )
<span class="ansi-green-intense-fg ansi-bold">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    217</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">If features are loaded via a string, the string needs </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    218</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">to be </span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">, a features name (</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">central_dihedrals</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">) or </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">an existing file. Your string </span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>file_or_feature<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">is none of those</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span>     )
<span class="ansi-green-intense-fg ansi-bold">    223</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np_to_xr(data, traj, attr_name, labels, file_or_feature)

<span class="ansi-red-fg">Exception</span>: If features are loaded via a string, the string needs to be &#39;all&#39;, a features name (&#39;central_dihedrals&#39;) or an existing file. Your string &#34;full_CV_dataset.nc&#34;is none of those
</pre></div></div>
</div>
</section>
<section id="Loading-with-PyEMMA-featurizer">
<h2>Loading with PyEMMA featurizer<a class="headerlink" href="#Loading-with-PyEMMA-featurizer" title="Permalink to this heading">#</a></h2>
<p>We will now use PyEMMA’s featurization pipeline (<a class="reference external" href="http://emma-project.org/latest/">http://emma-project.org/latest/</a>) to load CV data into our trajectory. For this encodermap has its own Version of PyEMMA’s featurizer accessible with <code class="docutils literal notranslate"><span class="pre">em.Featurizer</span></code> which can simply be provided to the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>

<span class="c1"># instantiate featurizer</span>
<span class="n">feat</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Featurizer</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

<span class="c1"># add features</span>
<span class="n">feat</span><span class="o">.</span><span class="n">add_backbone_torsions</span><span class="p">()</span>

<span class="c1"># load</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;backbone_torsion&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[49], line 7</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># instantiate featurizer</span>
<span class="ansi-green-fg">----&gt; 7</span> feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span style="color: rgb(95,135,135)"># add features</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> feat<span style="color: rgb(98,98,98)">.</span>add_backbone_torsions()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:125</span>, in <span class="ansi-cyan-fg">Featurizer.__new__</span><span class="ansi-blue-fg">(cls, trajs, in_memory)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">dask_featurizer</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> DaskFeaturizer
<span class="ansi-green-intense-fg ansi-bold">    124</span>     <span style="color: rgb(0,135,0)">cls</span> <span style="color: rgb(98,98,98)">=</span> DaskFeaturizer
<span class="ansi-green-fg">--&gt; 125</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">cls</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<p>Possible <code class="docutils literal notranslate"><span class="pre">add_*</span></code> features can be found via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">feat</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;add_&#39;</span><span class="p">):</span>
        <span class="n">help</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[50], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> i <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> attr <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">dir</span>(<span class="ansi-yellow-bg">feat</span>):
<span class="ansi-green-intense-fg ansi-bold">      3</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> attr<span style="color: rgb(98,98,98)">.</span>startswith(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">add_</span><span style="color: rgb(175,0,0)">&#39;</span>):
<span class="ansi-green-intense-fg ansi-bold">      4</span>         help(<span style="color: rgb(0,135,0)">getattr</span>(feat, attr))

<span class="ansi-red-fg">NameError</span>: name &#39;feat&#39; is not defined
</pre></div></div>
</div>
<p>The advantages of this method are:</p>
<ul class="simple">
<li><p>The same can be done with the <code class="docutils literal notranslate"><span class="pre">TrajEnsemble</span></code> class (more on that later), which is also parallelized.</p></li>
<li><p>Most of the features contain comprehensive labels themselves.</p></li>
</ul>
<p>The labels can be accessed via the <code class="docutils literal notranslate"><span class="pre">.coordinates</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code>’s <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. They are similar to the <code class="docutils literal notranslate"><span class="pre">attr_names</span></code> but without underscores and all caps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coordinates:
    *empty*
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;BACKBONETORSIONFEATURE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;BACKBONETORSIONFEATURE&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[52], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">BACKBONETORSIONFEATURE</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values[:<span style="color: rgb(98,98,98)">10</span>])

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;BACKBONETORSIONFEATURE&#39;
</pre></div></div>
</div>
<p>Here, it can be seen, that there are some errors on PyEMMA’s backbone_torsion feature. The sequence of backbone angles is scrambled.</p>
</section>
<section id="Loading-with-Encodermap-Features">
<h2>Loading with Encodermap Features<a class="headerlink" href="#Loading-with-Encodermap-Features" title="Permalink to this heading">#</a></h2>
<p>Encodermap features inherit from pyemma, but they are better formatted, regarding the labels. They can be loaded via <code class="docutils literal notranslate"><span class="pre">traj.load_CV('all')</span></code> to load all, or via a single string of list of these strings:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">encodermap.misc.misc</span> <span class="kn">import</span> <span class="n">FEATURE_NAMES</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FEATURE_NAMES</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_values([&#39;all_cartesians&#39;, &#39;all_distances&#39;, &#39;central_cartesians&#39;, &#39;central_distances&#39;, &#39;central_angles&#39;, &#39;central_dihedrals&#39;, &#39;side_cartesians&#39;, &#39;side_distances&#39;, &#39;side_angles&#39;, &#39;side_dihedrals&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">([</span><span class="s1">&#39;central_angles&#39;</span><span class="p">,</span> <span class="s1">&#39;central_dihedrals&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[54], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">central_angles</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">central_dihedrals</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:245</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):
<span class="ansi-green-fg">--&gt; 245</span>     feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>     feat<span style="color: rgb(98,98,98)">.</span>add_list_of_feats(data)
<span class="ansi-green-intense-fg ansi-bold">    247</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> feat<span style="color: rgb(98,98,98)">.</span>get_output()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRAL_DIHEDRALS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_DIHEDRALS&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[55], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">CENTRAL_DIHEDRALS</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_DIHEDRALS&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRAL_ANGLES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_ANGLES&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[56], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">CENTRAL_ANGLES</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_ANGLES&#39;
</pre></div></div>
</div>
</section>
<section id="Wrtiting-custom-features-No-1">
<h2>Wrtiting custom features No 1<a class="headerlink" href="#Wrtiting-custom-features-No-1" title="Permalink to this heading">#</a></h2>
<p>Writing your custom features can be done by subclassing pyemma’s features. Required methods and attributes to make your feature work are:</p>
<ul class="simple">
<li><p>The class-level attributes <code class="docutils literal notranslate"><span class="pre">__serialize_version</span></code> and <code class="docutils literal notranslate"><span class="pre">__serialize_fields</span></code></p></li>
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">describe</span></code>, and <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p></li>
<li><p>The instance attribute <code class="docutils literal notranslate"><span class="pre">dimension</span></code>, which defines the shape of the returned array.</p></li>
</ul>
<p>If you want to change the name of the feature, as it appears in the <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> you can set the attribute <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>In the next cell we will define a Feature that provides a random integer to an atom, based on its hash.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="kn">from</span> <span class="nn">encodermap.loading.features</span> <span class="kn">import</span> <span class="n">Feature</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="k">class</span> <span class="nc">RandomIntForAtomFeature</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
    <span class="c1"># class inherits from encodermap CustomFeature</span>
    <span class="c1"># set required class-level variables</span>
    <span class="n">__serialize_version</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">__serialize_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;indexes&#39;</span><span class="p">,</span> <span class="s1">&#39;selstr&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="c1"># write an __init__</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">selstr</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Init of RandomIntoForAtomFeature.</span>

<span class="sd">        Args:</span>
<span class="sd">            top (mdtraj.Topology): The topology to select atoms from.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            selstr (str, optional): The string to provide to top.select().</span>
<span class="sd">            Defaults to &#39;all&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Copy top to save it from hypothetical changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="c1"># define indexes (this is one of the serializable fields,</span>
        <span class="c1"># which could be used by pyemma to save a feature to disk.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">selstr</span><span class="p">)</span>

        <span class="c1"># set dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">)</span>

        <span class="c1"># inherit missing methods from base</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is not allowed to take any arguments.</span>

<span class="sd">        This method provides labels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A lsit of str, each str describing one feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In this method we will build a list of str</span>
        <span class="c1"># Each str should describe one of our features</span>
        <span class="c1"># We assign ints to atoms, so the labels should tell something about the atoms</span>
        <span class="n">getlbl</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">at</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;atom </span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">index</span><span class="si">:</span><span class="s2">5</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">resSeq</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Random int for </span><span class="si">{</span><span class="n">getlbl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">traj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method provides values.</span>

<span class="sd">        Args:</span>
<span class="sd">            traj (mdtraj.Trajectory): An mdtraj.Trajectory.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The values of the features defined in describe.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure that the returned array has correct shape</span>
        <span class="c1"># In general it is a good idea, that this array has the same length as</span>
        <span class="c1"># the trajectory has frames</span>
        <span class="c1"># In general means, like, ..., always</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="n">i</span><span class="p">))))[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># define the name of the feature to appear in `SingleTraj._CVs`</span>
        <span class="k">return</span> <span class="s1">&#39;MyAwesomeFeature&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ImportError</span>                               Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[57], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">encodermap</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">em</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">encodermap</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">loading</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">features</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> Feature
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">copy</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-bold" style="color: rgb(0,135,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">RandomIntForAtomFeature</span>(Feature):
<span class="ansi-green-intense-fg ansi-bold">      6</span>     <span style="color: rgb(95,135,135)"># class inherits from encodermap CustomFeature</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     <span style="color: rgb(95,135,135)"># set required class-level variables</span>

<span class="ansi-red-fg">ImportError</span>: cannot import name &#39;Feature&#39; from &#39;encodermap.loading.features&#39; (/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/features.py)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="n">featurizer</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Featurizer</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="n">feat</span> <span class="o">=</span> <span class="n">RandomIntForAtomFeature</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">describe</span><span class="p">()[:</span><span class="mi">200</span><span class="p">:</span><span class="mi">25</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
encodermap.SingleTraj object. Current backend is no_load. Basename is 1am7_corrected. At indices (None,). Not containing any CVs.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[58], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj)
<span class="ansi-green-fg">----&gt; 3</span> featurizer <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> feat <span style="color: rgb(98,98,98)">=</span> RandomIntForAtomFeature(traj<span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> i <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> feat<span style="color: rgb(98,98,98)">.</span>describe()[:<span style="color: rgb(98,98,98)">200</span>:<span style="color: rgb(98,98,98)">25</span>]:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:125</span>, in <span class="ansi-cyan-fg">Featurizer.__new__</span><span class="ansi-blue-fg">(cls, trajs, in_memory)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">dask_featurizer</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> DaskFeaturizer
<span class="ansi-green-intense-fg ansi-bold">    124</span>     <span style="color: rgb(0,135,0)">cls</span> <span style="color: rgb(98,98,98)">=</span> DaskFeaturizer
<span class="ansi-green-fg">--&gt; 125</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">cls</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">featurizer</span><span class="o">.</span><span class="n">add_custom_feature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[59], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">featurizer</span><span style="color: rgb(98,98,98)">.</span>add_custom_feature(feat)

<span class="ansi-red-fg">NameError</span>: name &#39;featurizer&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">featurizer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[60], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> traj<span style="color: rgb(98,98,98)">.</span>load_CV(<span class="ansi-yellow-bg">featurizer</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;featurizer&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;MYAWESOMEFEATURE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;MYAWESOMEFEATURE&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[61], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">MYAWESOMEFEATURE</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;MYAWESOMEFEATURE&#39;
</pre></div></div>
</div>
</section>
<section id="Writing-custom-features-No-2">
<h2>Writing custom features No 2<a class="headerlink" href="#Writing-custom-features-No-2" title="Permalink to this heading">#</a></h2>
<p>In this example we will implement a method of calculating a nematic order parameter. This example will be quite different (working with coarse-grained carbon-hydrate chains (so-called telechelics), and not with proteins), but we will work our way through. Here are some references you might consider:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@article{mukherjee2012derivation,
  title={Derivation of coarse grained models for multiscale simulation of liquid crystalline phase transitions},
  author={Mukherjee, Biswaroop and Delle Site, Luigi and Kremer, Kurt and Peter, Christine},
  journal={The Journal of Physical Chemistry B},
  volume={116},
  number={29},
  pages={8474--8484},
  year={2012},
  publisher={ACS Publications}
}

@article{flachmuller2021coarse,
  title={Coarse grained simulation of the aggregation and structure control of polyethylene nanocrystals},
  author={Flachm{\&quot;u}ller, Alexander and Mecking, Stefan and Peter, Christine},
  journal={Journal of Physics: Condensed Matter},
  volume={33},
  number={26},
  pages={264001},
  year={2021},
  publisher={IOP Publishing}
}
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<section id="Saving-trajectory-and-CVs-into-one-file">
<h3>Saving trajectory and CVs into one file<a class="headerlink" href="#Saving-trajectory-and-CVs-into-one-file" title="Permalink to this heading">#</a></h3>
<p>A trajectory can (with its CVs) saved as one comprehensive file with the <code class="docutils literal notranslate"><span class="pre">save()</span></code> method. What’s more: Loading such a file again makes it possible to access any frames and their corresponding CVs almost instantaneously.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;1am7_all_CVs.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[62], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">all</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> traj<span style="color: rgb(98,98,98)">.</span>save(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_all_CVs.h5</span><span style="color: rgb(175,0,0)">&#39;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:169</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads CV data from a string. That string can either identify a features,</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span> <span style="color: rgb(175,0,0)">or point to a file.</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    166</span>
<span class="ansi-green-intense-fg ansi-bold">    167</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    168</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">str</span>(file_or_feature) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">str</span>(file_or_feature) <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> CAN_BE_FEATURE_NAME:
<span class="ansi-green-fg">--&gt; 169</span>     feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> file_or_feature <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    171</span>         feat<span style="color: rgb(98,98,98)">.</span>add_list_of_feats(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_all_CVs.h5&#39;</span><span class="p">)</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">new_traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">35</span><span class="p">]]</span>
<span class="n">frames</span><span class="o">.</span><span class="n">CentralCartesians</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[63], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> new_traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">SingleTraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">1am7_all_CVs.h5</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> frames <span style="color: rgb(98,98,98)">=</span> new_traj[[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">20</span>, <span style="color: rgb(98,98,98)">35</span>]]
<span class="ansi-green-intense-fg ansi-bold">      3</span> frames<span style="color: rgb(98,98,98)">.</span>CentralCartesians<span style="color: rgb(98,98,98)">.</span>shape

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:379</span>, in <span class="ansi-cyan-fg">SingleTraj.__init__</span><span class="ansi-blue-fg">(self, traj, top, common_str, backend, index, traj_num, basename_fn)</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    378</span>     CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-fg">--&gt; 379</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg">h5</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">File</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">r</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> file:
<span class="ansi-green-intense-fg ansi-bold">    380</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">CVs</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> file<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-intense-fg ansi-bold">    381</span>             CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:567</span>, in <span class="ansi-cyan-fg">File.__init__</span><span class="ansi-blue-fg">(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, alignment_threshold, alignment_interval, meta_block_size, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    558</span>     fapl <span style="color: rgb(98,98,98)">=</span> make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
<span class="ansi-green-intense-fg ansi-bold">    559</span>                      locking, page_buf_size, min_meta_keep, min_raw_keep,
<span class="ansi-green-intense-fg ansi-bold">    560</span>                      alignment_threshold<span style="color: rgb(98,98,98)">=</span>alignment_threshold,
<span class="ansi-green-intense-fg ansi-bold">    561</span>                      alignment_interval<span style="color: rgb(98,98,98)">=</span>alignment_interval,
<span class="ansi-green-intense-fg ansi-bold">    562</span>                      meta_block_size<span style="color: rgb(98,98,98)">=</span>meta_block_size,
<span class="ansi-green-intense-fg ansi-bold">    563</span>                      <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwds)
<span class="ansi-green-intense-fg ansi-bold">    564</span>     fcpl <span style="color: rgb(98,98,98)">=</span> make_fcpl(track_order<span style="color: rgb(98,98,98)">=</span>track_order, fs_strategy<span style="color: rgb(98,98,98)">=</span>fs_strategy,
<span class="ansi-green-intense-fg ansi-bold">    565</span>                      fs_persist<span style="color: rgb(98,98,98)">=</span>fs_persist, fs_threshold<span style="color: rgb(98,98,98)">=</span>fs_threshold,
<span class="ansi-green-intense-fg ansi-bold">    566</span>                      fs_page_size<span style="color: rgb(98,98,98)">=</span>fs_page_size)
<span class="ansi-green-fg">--&gt; 567</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">make_fid</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">mode</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">userblock_size</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fcpl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(libver, <span style="color: rgb(0,135,0)">tuple</span>):
<span class="ansi-green-intense-fg ansi-bold">    570</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_libver <span style="color: rgb(98,98,98)">=</span> libver

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:231</span>, in <span class="ansi-cyan-fg">make_fid</span><span class="ansi-blue-fg">(name, mode, userblock_size, fapl, fcpl, swmr)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> swmr <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> swmr_support:
<span class="ansi-green-intense-fg ansi-bold">    230</span>         flags <span style="color: rgb(98,98,98)">|</span><span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>ACC_SWMR_READ
<span class="ansi-green-fg">--&gt; 231</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">h5f</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">flags</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> mode <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r+</span><span style="color: rgb(175,0,0)">&#39;</span>:
<span class="ansi-green-intense-fg ansi-bold">    233</span>     fid <span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>open(name, h5f<span style="color: rgb(98,98,98)">.</span>ACC_RDWR, fapl<span style="color: rgb(98,98,98)">=</span>fapl)

File <span class="ansi-green-fg">h5py/_objects.pyx:54</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/_objects.pyx:55</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/h5f.pyx:106</span>, in <span class="ansi-cyan-fg">h5py.h5f.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] Unable to open file (unable to open file: name = &#39;1am7_all_CVs.h5&#39;, errno = 2, error message = &#39;No such file or directory&#39;, flags = 0, o_flags = 0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="n">new_traj</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">CentralBondDistances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRALBONDDISTANCES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[64], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> frames <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">new_traj</span>[::<span style="color: rgb(98,98,98)">5</span>]
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(frames<span style="color: rgb(98,98,98)">.</span>CentralBondDistances<span style="color: rgb(98,98,98)">.</span>shape)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(frames<span style="color: rgb(98,98,98)">.</span>_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">CENTRALBONDDISTANCES</span><span style="color: rgb(175,0,0)">&#39;</span>]<span style="color: rgb(98,98,98)">.</span>values)

<span class="ansi-red-fg">NameError</span>: name &#39;new_traj&#39; is not defined
</pre></div></div>
</div>
<p>However, CVs are deleted, when the number of atoms is altered.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">atom_slice</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[65], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> subset <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">frames</span><span style="color: rgb(98,98,98)">.</span>atom_slice(frames<span style="color: rgb(98,98,98)">.</span>select(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">name CA</span><span style="color: rgb(175,0,0)">&#39;</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;frames&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">CVs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[66], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">subset</span><span style="color: rgb(98,98,98)">.</span>CVs

<span class="ansi-red-fg">NameError</span>: name &#39;subset&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">raman_labels</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;psi 50&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">raman</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span><span class="o">.</span><span class="n">raman</span><span class="p">[:,</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[67], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> index <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>where(np<span style="color: rgb(98,98,98)">.</span>array(<span class="ansi-yellow-bg">raman_labels</span>) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">psi 50</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj[<span style="color: rgb(98,98,98)">20</span>]<span style="color: rgb(98,98,98)">.</span>raman[index])
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(traj[[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">10</span>, <span style="color: rgb(98,98,98)">20</span>]]<span style="color: rgb(98,98,98)">.</span>raman[:,index])

<span class="ansi-red-fg">NameError</span>: name &#39;raman_labels&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<section id="id1">
<h2>Loading from files<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>CVs can be loaded by providing a string to files. First, let us save some files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save numpy</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;raman_file.npy&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">raman</span><span class="p">)</span>

<span class="c1"># save text</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;cluster_membership_file.txt&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">cluster_membership</span><span class="p">)</span>

<span class="c1"># save full CV dataset as NetCDF</span>
<span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;full_CV_dataset.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[68], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># save numpy</span>
<span class="ansi-green-fg">----&gt; 2</span> np<span style="color: rgb(98,98,98)">.</span>save(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">raman_file.npy</span><span style="color: rgb(175,0,0)">&#39;</span>, <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">raman</span>)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># save text</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> np<span style="color: rgb(98,98,98)">.</span>savetxt(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">cluster_membership_file.txt</span><span style="color: rgb(175,0,0)">&#39;</span>, traj<span style="color: rgb(98,98,98)">.</span>cluster_membership)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:1310</span>, in <span class="ansi-cyan-fg">SingleTraj.__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">   1308</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__getattribute__</span>(attr)
<span class="ansi-green-intense-fg ansi-bold">   1309</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1310</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">AttributeError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)"> object has no attribute </span><span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>attr<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">AttributeError</span>: &#39;SingleTraj&#39; object has no attribute &#39;raman&#39;
</pre></div></div>
</div>
<p>If not providing an <code class="docutils literal notranslate"><span class="pre">attr_name</span></code>, while loading files, the filename will be used:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;raman_file.npy&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;cluster_membership_file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[69], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">raman_file.npy</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> traj<span style="color: rgb(98,98,98)">.</span>load_CV(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">cluster_membership_file.txt</span><span style="color: rgb(175,0,0)">&#39;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:216</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    211</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Currently only .txt, .npy, .nc, and .h5 files can </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    212</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">be loaded. Your file </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>f<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> does not have the </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">correct extension.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    214</span>         )
<span class="ansi-green-intense-fg ansi-bold">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    217</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">If features are loaded via a string, the string needs </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    218</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">to be </span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">, a features name (</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">central_dihedrals</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">) or </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">an existing file. Your string </span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>file_or_feature<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">is none of those</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span>     )
<span class="ansi-green-intense-fg ansi-bold">    223</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np_to_xr(data, traj, attr_name, labels, file_or_feature)

<span class="ansi-red-fg">Exception</span>: If features are loaded via a string, the string needs to be &#39;all&#39;, a features name (&#39;central_dihedrals&#39;) or an existing file. Your string &#34;raman_file.npy&#34;is none of those
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([])
</pre></div></div>
</div>
<p>Multiple CVs can be reconstructed from xarray NetCDF files (most end with .nc). If there are conflicts the new data from disk will overwrite the old.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;full_CV_dataset.nc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">CVs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[71], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj<span style="color: rgb(98,98,98)">.</span>CVs<span style="color: rgb(98,98,98)">.</span>keys())
<span class="ansi-green-fg">----&gt; 3</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">full_CV_dataset.nc</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(traj<span style="color: rgb(98,98,98)">.</span>CVs<span style="color: rgb(98,98,98)">.</span>keys())

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:216</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    211</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Currently only .txt, .npy, .nc, and .h5 files can </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    212</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">be loaded. Your file </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>f<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)"> does not have the </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span>             <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">correct extension.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    214</span>         )
<span class="ansi-green-intense-fg ansi-bold">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>(
<span class="ansi-green-intense-fg ansi-bold">    217</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">If features are loaded via a string, the string needs </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    218</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">to be </span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">, a features name (</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">central_dihedrals</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">) or </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">an existing file. Your string </span><span style="color: rgb(175,0,0)">&#34;</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>file_or_feature<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">is none of those</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span>     )
<span class="ansi-green-intense-fg ansi-bold">    223</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np_to_xr(data, traj, attr_name, labels, file_or_feature)

<span class="ansi-red-fg">Exception</span>: If features are loaded via a string, the string needs to be &#39;all&#39;, a features name (&#39;central_dihedrals&#39;) or an existing file. Your string &#34;full_CV_dataset.nc&#34;is none of those
</pre></div></div>
</div>
</section>
<section id="id2">
<h2>Loading with PyEMMA featurizer<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>We will now use PyEMMA’s featurization pipeline (<a class="reference external" href="http://emma-project.org/latest/">http://emma-project.org/latest/</a>) to load CV data into our trajectory. For this encodermap has its own Version of PyEMMA’s featurizer accessible with <code class="docutils literal notranslate"><span class="pre">em.Featurizer</span></code> which can simply be provided to the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>

<span class="c1"># instantiate featurizer</span>
<span class="n">feat</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Featurizer</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

<span class="c1"># add features</span>
<span class="n">feat</span><span class="o">.</span><span class="n">add_backbone_torsions</span><span class="p">()</span>

<span class="c1"># load</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;backbone_torsion&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[72], line 7</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># instantiate featurizer</span>
<span class="ansi-green-fg">----&gt; 7</span> feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span style="color: rgb(95,135,135)"># add features</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> feat<span style="color: rgb(98,98,98)">.</span>add_backbone_torsions()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:125</span>, in <span class="ansi-cyan-fg">Featurizer.__new__</span><span class="ansi-blue-fg">(cls, trajs, in_memory)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">dask_featurizer</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> DaskFeaturizer
<span class="ansi-green-intense-fg ansi-bold">    124</span>     <span style="color: rgb(0,135,0)">cls</span> <span style="color: rgb(98,98,98)">=</span> DaskFeaturizer
<span class="ansi-green-fg">--&gt; 125</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">cls</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<p>Possible <code class="docutils literal notranslate"><span class="pre">add_*</span></code> features can be found via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">feat</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;add_&#39;</span><span class="p">):</span>
        <span class="n">help</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[73], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> i <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> attr <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">dir</span>(<span class="ansi-yellow-bg">feat</span>):
<span class="ansi-green-intense-fg ansi-bold">      3</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> attr<span style="color: rgb(98,98,98)">.</span>startswith(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">add_</span><span style="color: rgb(175,0,0)">&#39;</span>):
<span class="ansi-green-intense-fg ansi-bold">      4</span>         help(<span style="color: rgb(0,135,0)">getattr</span>(feat, attr))

<span class="ansi-red-fg">NameError</span>: name &#39;feat&#39; is not defined
</pre></div></div>
</div>
<p>The advantages of this method are:</p>
<ul class="simple">
<li><p>The same can be done with the <code class="docutils literal notranslate"><span class="pre">TrajEnsemble</span></code> class (more on that later), which is also parallelized.</p></li>
<li><p>Most of the features contain comprehensive labels themselves.</p></li>
</ul>
<p>The labels can be accessed via the <code class="docutils literal notranslate"><span class="pre">.coordinates</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">SingleTraj</span></code>’s <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. They are similar to the <code class="docutils literal notranslate"><span class="pre">attr_names</span></code> but without underscores and all caps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coordinates:
    *empty*
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;BACKBONETORSIONFEATURE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;BACKBONETORSIONFEATURE&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[75], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">BACKBONETORSIONFEATURE</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values[:<span style="color: rgb(98,98,98)">10</span>])

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;BACKBONETORSIONFEATURE&#39;
</pre></div></div>
</div>
<p>Here, it can be seen, that there are some errors on PyEMMA’s backbone_torsion feature. The sequence of backbone angles is scrambled.</p>
</section>
<section id="id3">
<h2>Loading with Encodermap Features<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>Encodermap features inherit from pyemma, but they are better formatted, regarding the labels. They can be loaded via <code class="docutils literal notranslate"><span class="pre">traj.load_CV('all')</span></code> to load all, or via a single string of list of these strings:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">encodermap.misc.misc</span> <span class="kn">import</span> <span class="n">FEATURE_NAMES</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FEATURE_NAMES</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_values([&#39;all_cartesians&#39;, &#39;all_distances&#39;, &#39;central_cartesians&#39;, &#39;central_distances&#39;, &#39;central_angles&#39;, &#39;central_dihedrals&#39;, &#39;side_cartesians&#39;, &#39;side_distances&#39;, &#39;side_angles&#39;, &#39;side_dihedrals&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">([</span><span class="s1">&#39;central_angles&#39;</span><span class="p">,</span> <span class="s1">&#39;central_dihedrals&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[77], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">central_angles</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">central_dihedrals</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:245</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):
<span class="ansi-green-fg">--&gt; 245</span>     feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>     feat<span style="color: rgb(98,98,98)">.</span>add_list_of_feats(data)
<span class="ansi-green-intense-fg ansi-bold">    247</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> feat<span style="color: rgb(98,98,98)">.</span>get_output()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRAL_DIHEDRALS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_DIHEDRALS&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[78], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">CENTRAL_DIHEDRALS</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_DIHEDRALS&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRAL_ANGLES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_ANGLES&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[79], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">CENTRAL_ANGLES</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;CENTRAL_ANGLES&#39;
</pre></div></div>
</div>
</section>
<section id="id4">
<h2>Wrtiting custom features No 1<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<p>Writing your custom features can be done by subclassing pyemma’s features. Required methods and attributes to make your feature work are:</p>
<ul class="simple">
<li><p>The class-level attributes <code class="docutils literal notranslate"><span class="pre">__serialize_version</span></code> and <code class="docutils literal notranslate"><span class="pre">__serialize_fields</span></code></p></li>
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">describe</span></code>, and <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p></li>
<li><p>The instance attribute <code class="docutils literal notranslate"><span class="pre">dimension</span></code>, which defines the shape of the returned array.</p></li>
</ul>
<p>If you want to change the name of the feature, as it appears in the <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> you can set the attribute <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>In the next cell we will define a Feature that provides a random integer to an atom, based on its hash.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">encodermap</span> <span class="k">as</span> <span class="nn">em</span>
<span class="kn">from</span> <span class="nn">encodermap.loading.features</span> <span class="kn">import</span> <span class="n">Feature</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="k">class</span> <span class="nc">RandomIntForAtomFeature</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
    <span class="c1"># class inherits from encodermap CustomFeature</span>
    <span class="c1"># set required class-level variables</span>
    <span class="n">__serialize_version</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">__serialize_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;indexes&#39;</span><span class="p">,</span> <span class="s1">&#39;selstr&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="c1"># write an __init__</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">selstr</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Init of RandomIntoForAtomFeature.</span>

<span class="sd">        Args:</span>
<span class="sd">            top (mdtraj.Topology): The topology to select atoms from.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            selstr (str, optional): The string to provide to top.select().</span>
<span class="sd">            Defaults to &#39;all&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Copy top to save it from hypothetical changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="c1"># define indexes (this is one of the serializable fields,</span>
        <span class="c1"># which could be used by pyemma to save a feature to disk.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">selstr</span><span class="p">)</span>

        <span class="c1"># set dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">)</span>

        <span class="c1"># inherit missing methods from base</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is not allowed to take any arguments.</span>

<span class="sd">        This method provides labels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A lsit of str, each str describing one feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In this method we will build a list of str</span>
        <span class="c1"># Each str should describe one of our features</span>
        <span class="c1"># We assign ints to atoms, so the labels should tell something about the atoms</span>
        <span class="n">getlbl</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">at</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;atom </span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">index</span><span class="si">:</span><span class="s2">5</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">at</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">resSeq</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Random int for </span><span class="si">{</span><span class="n">getlbl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">traj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method provides values.</span>

<span class="sd">        Args:</span>
<span class="sd">            traj (mdtraj.Trajectory): An mdtraj.Trajectory.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The values of the features defined in describe.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure that the returned array has correct shape</span>
        <span class="c1"># In general it is a good idea, that this array has the same length as</span>
        <span class="c1"># the trajectory has frames</span>
        <span class="c1"># In general means, like, ..., always</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="n">i</span><span class="p">))))[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># define the name of the feature to appear in `SingleTraj._CVs`</span>
        <span class="k">return</span> <span class="s1">&#39;MyAwesomeFeature&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ImportError</span>                               Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[80], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">encodermap</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">em</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">encodermap</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">loading</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">features</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> Feature
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">copy</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-bold" style="color: rgb(0,135,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">RandomIntForAtomFeature</span>(Feature):
<span class="ansi-green-intense-fg ansi-bold">      6</span>     <span style="color: rgb(95,135,135)"># class inherits from encodermap CustomFeature</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     <span style="color: rgb(95,135,135)"># set required class-level variables</span>

<span class="ansi-red-fg">ImportError</span>: cannot import name &#39;Feature&#39; from &#39;encodermap.loading.features&#39; (/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/features.py)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="n">featurizer</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">Featurizer</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="n">feat</span> <span class="o">=</span> <span class="n">RandomIntForAtomFeature</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">describe</span><span class="p">()[:</span><span class="mi">200</span><span class="p">:</span><span class="mi">25</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
encodermap.SingleTraj object. Current backend is no_load. Basename is 1am7_corrected. At indices (None,). Not containing any CVs.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[81], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(traj)
<span class="ansi-green-fg">----&gt; 3</span> featurizer <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> feat <span style="color: rgb(98,98,98)">=</span> RandomIntForAtomFeature(traj<span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> i <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> feat<span style="color: rgb(98,98,98)">.</span>describe()[:<span style="color: rgb(98,98,98)">200</span>:<span style="color: rgb(98,98,98)">25</span>]:

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:125</span>, in <span class="ansi-cyan-fg">Featurizer.__new__</span><span class="ansi-blue-fg">(cls, trajs, in_memory)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">dask_featurizer</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> DaskFeaturizer
<span class="ansi-green-intense-fg ansi-bold">    124</span>     <span style="color: rgb(0,135,0)">cls</span> <span style="color: rgb(98,98,98)">=</span> DaskFeaturizer
<span class="ansi-green-fg">--&gt; 125</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">cls</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">featurizer</span><span class="o">.</span><span class="n">add_custom_feature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[82], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">featurizer</span><span style="color: rgb(98,98,98)">.</span>add_custom_feature(feat)

<span class="ansi-red-fg">NameError</span>: name &#39;featurizer&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="n">featurizer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[83], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> traj<span style="color: rgb(98,98,98)">.</span>load_CV(<span class="ansi-yellow-bg">featurizer</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;featurizer&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;MYAWESOMEFEATURE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1348</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1347</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:

<span class="ansi-red-fg">KeyError</span>: &#39;MYAWESOMEFEATURE&#39;

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[84], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_CVs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">MYAWESOMEFEATURE</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>values

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/coordinates.py:295</span>, in <span class="ansi-cyan-fg">DatasetCoordinates.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_data<span style="color: rgb(98,98,98)">.</span>data_vars:
<span class="ansi-green-intense-fg ansi-bold">    294</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-fg">--&gt; 295</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">]</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1439</span>, in <span class="ansi-cyan-fg">Dataset.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>isel(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>key)
<span class="ansi-green-intense-fg ansi-bold">   1438</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>hashable(key):
<span class="ansi-green-fg">-&gt; 1439</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_construct_dataarray</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> utils<span style="color: rgb(98,98,98)">.</span>iterable_of_hashable(key):
<span class="ansi-green-intense-fg ansi-bold">   1441</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_listed(key)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:1350</span>, in <span class="ansi-cyan-fg">Dataset._construct_dataarray</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   1348</span>     variable <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_variables[name]
<span class="ansi-green-intense-fg ansi-bold">   1349</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>:
<span class="ansi-green-fg">-&gt; 1350</span>     _, name, variable <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_get_virtual_variable</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_variables</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dims</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span> needed_dims <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>(variable<span style="color: rgb(98,98,98)">.</span>dims)
<span class="ansi-green-intense-fg ansi-bold">   1354</span> coords: <span style="color: rgb(0,135,0)">dict</span>[Hashable, Variable] <span style="color: rgb(98,98,98)">=</span> {}

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/xarray/core/dataset.py:186</span>, in <span class="ansi-cyan-fg">_get_virtual_variable</span><span class="ansi-blue-fg">(variables, key, dim_sizes)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> split_key <span style="color: rgb(98,98,98)">=</span> key<span style="color: rgb(98,98,98)">.</span>split(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-intense-fg ansi-bold">    185</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(split_key) <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(98,98,98)">2</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key)
<span class="ansi-green-intense-fg ansi-bold">    188</span> ref_name, var_name <span style="color: rgb(98,98,98)">=</span> split_key
<span class="ansi-green-intense-fg ansi-bold">    189</span> ref_var <span style="color: rgb(98,98,98)">=</span> variables[ref_name]

<span class="ansi-red-fg">KeyError</span>: &#39;MYAWESOMEFEATURE&#39;
</pre></div></div>
</div>
</section>
<section id="id5">
<h2>Writing custom features No 2<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<p>In this example we will implement a method of calculating a nematic order parameter. This example will be quite different (working with coarse-grained carbon-hydrate chains (so-called telechelics), and not with proteins), but we will work our way through. Here are some references you might consider:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@article{mukherjee2012derivation,
  title={Derivation of coarse grained models for multiscale simulation of liquid crystalline phase transitions},
  author={Mukherjee, Biswaroop and Delle Site, Luigi and Kremer, Kurt and Peter, Christine},
  journal={The Journal of Physical Chemistry B},
  volume={116},
  number={29},
  pages={8474--8484},
  year={2012},
  publisher={ACS Publications}
}

@article{flachmuller2021coarse,
  title={Coarse grained simulation of the aggregation and structure control of polyethylene nanocrystals},
  author={Flachm{\&quot;u}ller, Alexander and Mecking, Stefan and Peter, Christine},
  journal={Journal of Physics: Condensed Matter},
  volume={33},
  number={26},
  pages={264001},
  year={2021},
  publisher={IOP Publishing}
}
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<section id="id6">
<h3>Saving trajectory and CVs into one file<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>A trajectory can (with its CVs) saved as one comprehensive file with the <code class="docutils literal notranslate"><span class="pre">save()</span></code> method. What’s more: Loading such a file again makes it possible to access any frames and their corresponding CVs almost instantaneously.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_corrected.xtc&#39;</span><span class="p">,</span> <span class="s1">&#39;1am7_protein.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">load_CV</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;1am7_all_CVs.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[85], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> traj <span style="color: rgb(98,98,98)">=</span> em<span style="color: rgb(98,98,98)">.</span>SingleTraj(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_corrected.xtc</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_protein.pdb</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load_CV</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">all</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> traj<span style="color: rgb(98,98,98)">.</span>save(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">1am7_all_CVs.h5</span><span style="color: rgb(175,0,0)">&#39;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:919</span>, in <span class="ansi-cyan-fg">SingleTraj.load_CV</span><span class="ansi-blue-fg">(self, data, attr_name, cols, labels, override)</span>
<span class="ansi-green-intense-fg ansi-bold">    861</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Load CVs into traj. Many options are possible. Provide xarray,</span>
<span class="ansi-green-intense-fg ansi-bold">    862</span> <span style="color: rgb(175,0,0)">numpy array, em.loading.feature, em.featurizer, and even string!</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    915</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    917</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">trajinfo_utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> load_CVs_singletraj
<span class="ansi-green-fg">--&gt; 919</span> new_CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CVs_singletraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    921</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>array([<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num]), <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    922</span>         data, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_num, new_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">traj_num</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">    923</span>     )

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:241</span>, in <span class="ansi-cyan-fg">load_CVs_singletraj</span><span class="ansi-blue-fg">(data, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> <span style="color: rgb(95,135,135)"># load a string</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, (<span style="color: rgb(0,135,0)">str</span>, Path)):
<span class="ansi-green-fg">--&gt; 241</span>     CVs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">load_CV_from_string_or_path</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attr_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cols</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">labels</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> <span style="color: rgb(95,135,135)"># load a list of strings from standard features</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">isinstance</span>(data, <span style="color: rgb(0,135,0)">list</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">all</span>([<span style="color: rgb(0,135,0)">isinstance</span>(_, <span style="color: rgb(0,135,0)">str</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> _ <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> data]):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/trajinfo_utils.py:169</span>, in <span class="ansi-cyan-fg">load_CV_from_string_or_path</span><span class="ansi-blue-fg">(file_or_feature, traj, attr_name, cols, labels)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Loads CV data from a string. That string can either identify a features,</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span> <span style="color: rgb(175,0,0)">or point to a file.</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    166</span>
<span class="ansi-green-intense-fg ansi-bold">    167</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    168</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">str</span>(file_or_feature) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">str</span>(file_or_feature) <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> CAN_BE_FEATURE_NAME:
<span class="ansi-green-fg">--&gt; 169</span>     feat <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Featurizer</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">traj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> file_or_feature <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    171</span>         feat<span style="color: rgb(98,98,98)">.</span>add_list_of_feats(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span>)

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:263</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.__init__</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, trajs):
<span class="ansi-green-fg">--&gt; 263</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">trajs</span> <span style="color: rgb(98,98,98)">=</span> trajs
<span class="ansi-green-intense-fg ansi-bold">    264</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_copy_docstrings_from_pyemma()

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/loading/featurizer.py:538</span>, in <span class="ansi-cyan-fg">PyEMMAFeaturizer.trajs</span><span class="ansi-blue-fg">(self, trajs)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(trajs, SingleTraj) <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> trajs<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span> <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">SingleTraj</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    537</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_trajs <span style="color: rgb(98,98,98)">=</span> trajs<span style="color: rgb(98,98,98)">.</span>_gen_ensemble()
<span class="ansi-green-fg">--&gt; 538</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">trajs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">top</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>feat <span style="color: rgb(98,98,98)">=</span> featurizer(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top)
<span class="ansi-green-intense-fg ansi-bold">    540</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _validate_uri(trajs<span style="color: rgb(98,98,98)">.</span>traj_file):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:658</span>, in <span class="ansi-cyan-fg">SingleTraj.top</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    656</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_pdb(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)<span style="color: rgb(98,98,98)">.</span>top
<span class="ansi-green-intense-fg ansi-bold">    657</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> os<span style="color: rgb(98,98,98)">.</span>path<span style="color: rgb(98,98,98)">.</span>isfile(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file):
<span class="ansi-green-fg">--&gt; 658</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">FileNotFoundError</span>(
<span class="ansi-green-intense-fg ansi-bold">    659</span>                 errno<span style="color: rgb(98,98,98)">.</span>ENOENT, os<span style="color: rgb(98,98,98)">.</span>strerror(errno<span style="color: rgb(98,98,98)">.</span>ENOENT), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file
<span class="ansi-green-intense-fg ansi-bold">    660</span>             )
<span class="ansi-green-intense-fg ansi-bold">    661</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>backend <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">no_load</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>extension <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>traj_file:
<span class="ansi-green-intense-fg ansi-bold">    662</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> md<span style="color: rgb(98,98,98)">.</span>load_topology(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>top_file)

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;1am7_protein.pdb&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">SingleTraj</span><span class="p">(</span><span class="s1">&#39;1am7_all_CVs.h5&#39;</span><span class="p">)</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">new_traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">35</span><span class="p">]]</span>
<span class="n">frames</span><span class="o">.</span><span class="n">CentralCartesians</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[86], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> new_traj <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">em</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">SingleTraj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">1am7_all_CVs.h5</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> frames <span style="color: rgb(98,98,98)">=</span> new_traj[[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">20</span>, <span style="color: rgb(98,98,98)">35</span>]]
<span class="ansi-green-intense-fg ansi-bold">      3</span> frames<span style="color: rgb(98,98,98)">.</span>CentralCartesians<span style="color: rgb(98,98,98)">.</span>shape

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/encodermap/trajinfo/info_single.py:379</span>, in <span class="ansi-cyan-fg">SingleTraj.__init__</span><span class="ansi-blue-fg">(self, traj, top, common_str, backend, index, traj_num, basename_fn)</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_traj_file<span style="color: rgb(98,98,98)">.</span>suffix <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">.h5</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-intense-fg ansi-bold">    378</span>     CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-fg">--&gt; 379</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span class="ansi-yellow-bg">h5</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">File</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">traj_file</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">r</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> file:
<span class="ansi-green-intense-fg ansi-bold">    380</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">CVs</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> file<span style="color: rgb(98,98,98)">.</span>keys():
<span class="ansi-green-intense-fg ansi-bold">    381</span>             CVs_in_file <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:567</span>, in <span class="ansi-cyan-fg">File.__init__</span><span class="ansi-blue-fg">(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, alignment_threshold, alignment_interval, meta_block_size, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    558</span>     fapl <span style="color: rgb(98,98,98)">=</span> make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
<span class="ansi-green-intense-fg ansi-bold">    559</span>                      locking, page_buf_size, min_meta_keep, min_raw_keep,
<span class="ansi-green-intense-fg ansi-bold">    560</span>                      alignment_threshold<span style="color: rgb(98,98,98)">=</span>alignment_threshold,
<span class="ansi-green-intense-fg ansi-bold">    561</span>                      alignment_interval<span style="color: rgb(98,98,98)">=</span>alignment_interval,
<span class="ansi-green-intense-fg ansi-bold">    562</span>                      meta_block_size<span style="color: rgb(98,98,98)">=</span>meta_block_size,
<span class="ansi-green-intense-fg ansi-bold">    563</span>                      <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwds)
<span class="ansi-green-intense-fg ansi-bold">    564</span>     fcpl <span style="color: rgb(98,98,98)">=</span> make_fcpl(track_order<span style="color: rgb(98,98,98)">=</span>track_order, fs_strategy<span style="color: rgb(98,98,98)">=</span>fs_strategy,
<span class="ansi-green-intense-fg ansi-bold">    565</span>                      fs_persist<span style="color: rgb(98,98,98)">=</span>fs_persist, fs_threshold<span style="color: rgb(98,98,98)">=</span>fs_threshold,
<span class="ansi-green-intense-fg ansi-bold">    566</span>                      fs_page_size<span style="color: rgb(98,98,98)">=</span>fs_page_size)
<span class="ansi-green-fg">--&gt; 567</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">make_fid</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">mode</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">userblock_size</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fcpl</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">swmr</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(libver, <span style="color: rgb(0,135,0)">tuple</span>):
<span class="ansi-green-intense-fg ansi-bold">    570</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_libver <span style="color: rgb(98,98,98)">=</span> libver

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/h5py/_hl/files.py:231</span>, in <span class="ansi-cyan-fg">make_fid</span><span class="ansi-blue-fg">(name, mode, userblock_size, fapl, fcpl, swmr)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> swmr <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> swmr_support:
<span class="ansi-green-intense-fg ansi-bold">    230</span>         flags <span style="color: rgb(98,98,98)">|</span><span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>ACC_SWMR_READ
<span class="ansi-green-fg">--&gt; 231</span>     fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">h5f</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">flags</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">fapl</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> mode <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r+</span><span style="color: rgb(175,0,0)">&#39;</span>:
<span class="ansi-green-intense-fg ansi-bold">    233</span>     fid <span style="color: rgb(98,98,98)">=</span> h5f<span style="color: rgb(98,98,98)">.</span>open(name, h5f<span style="color: rgb(98,98,98)">.</span>ACC_RDWR, fapl<span style="color: rgb(98,98,98)">=</span>fapl)

File <span class="ansi-green-fg">h5py/_objects.pyx:54</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/_objects.pyx:55</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">h5py/h5f.pyx:106</span>, in <span class="ansi-cyan-fg">h5py.h5f.open</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] Unable to open file (unable to open file: name = &#39;1am7_all_CVs.h5&#39;, errno = 2, error message = &#39;No such file or directory&#39;, flags = 0, o_flags = 0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="n">new_traj</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">CentralBondDistances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">_CVs</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;CENTRALBONDDISTANCES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[87], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> frames <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">new_traj</span>[::<span style="color: rgb(98,98,98)">5</span>]
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(frames<span style="color: rgb(98,98,98)">.</span>CentralBondDistances<span style="color: rgb(98,98,98)">.</span>shape)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(frames<span style="color: rgb(98,98,98)">.</span>_CVs<span style="color: rgb(98,98,98)">.</span>coords[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">CENTRALBONDDISTANCES</span><span style="color: rgb(175,0,0)">&#39;</span>]<span style="color: rgb(98,98,98)">.</span>values)

<span class="ansi-red-fg">NameError</span>: name &#39;new_traj&#39; is not defined
</pre></div></div>
</div>
<p>However, CVs are deleted, when the number of atoms is altered.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">atom_slice</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[88], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> subset <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">frames</span><span style="color: rgb(98,98,98)">.</span>atom_slice(frames<span style="color: rgb(98,98,98)">.</span>select(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">name CA</span><span style="color: rgb(175,0,0)">&#39;</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;frames&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">CVs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[89], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">subset</span><span style="color: rgb(98,98,98)">.</span>CVs

<span class="ansi-red-fg">NameError</span>: name &#39;subset&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"7d4b5c686a674940a2518089ac5348db": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2a4b280a1e0b4d868f77760902d306fa": {"model_name": "ColormakerRegistryModel", "model_module": "nglview-js-widgets", "model_module_version": "3.0.1", "state": {"_dom_classes": [], "_model_module": "nglview-js-widgets", "_model_module_version": "3.0.1", "_model_name": "ColormakerRegistryModel", "_msg_ar": [], "_msg_q": [], "_ready": false, "_view_count": null, "_view_module": "nglview-js-widgets", "_view_module_version": "3.0.1", "_view_name": "ColormakerRegistryView", "layout": "IPY_MODEL_7d4b5c686a674940a2518089ac5348db"}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#For-Google-colab-only:">
   For Google colab only:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Primer">
     Primer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Collective-Variables">
   Collective Variables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Example-CVs">
   Example CVs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Sharing-Trajectory-files">
   Sharing Trajectory files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Classes-for-Trajectory-Ensembles">
     Classes for Trajectory Ensembles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#The-new-SingleTraj-class">
     The new SingleTraj class
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Initialize.">
   Initialize.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#On-demand-loading">
   On demand loading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Take-a-look-with-nglview">
   Take a look with nglview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Class-attributes">
   Class attributes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Duplication-of-mdtraj">
   Duplication of mdtraj
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Indexing">
   Indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Advanced-slicing">
   Advanced slicing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Advanced-slicing-with-HDF5">
   Advanced slicing with HDF5
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Loading-CVs">
     Loading CVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#From-numpy">
   From numpy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Slicing-with-CVs.">
   Slicing with CVs.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-from-files">
   Loading from files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-with-PyEMMA-featurizer">
   Loading with PyEMMA featurizer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-with-Encodermap-Features">
   Loading with Encodermap Features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Wrtiting-custom-features-No-1">
   Wrtiting custom features No 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Writing-custom-features-No-2">
   Writing custom features No 2
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Saving-trajectory-and-CVs-into-one-file">
     Saving trajectory and CVs into one file
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Loading from files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Loading with PyEMMA featurizer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   Loading with Encodermap Features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   Wrtiting custom features No 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   Writing custom features No 2
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Saving trajectory and CVs into one file
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/user_guide_and_examples/01_working_with_trajectory_ensembles.nblink.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2023, Kevin Sawade, Tobias Lemke.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>